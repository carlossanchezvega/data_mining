<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>FARS</title>
  <meta name="description" content="FARS">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="FARS" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="FARS" />
  
  
  

<meta name="author" content="Grupo A: Carlos Sánchez Vega, Raúl Salazar de Torres, Jorge Fernández Hernández, Mónica Alexa">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introduccion.html">
<link rel="next" href="estudio-de-valores-faltantes.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i><b>1</b> Introduccion</a><ul>
<li class="chapter" data-level="1.1" data-path="introduccion.html"><a href="introduccion.html#conjunto-de-datos"><i class="fa fa-check"></i><b>1.1</b> Conjunto de datos</a></li>
<li class="chapter" data-level="1.2" data-path="introduccion.html"><a href="introduccion.html#documentacion-consultada"><i class="fa fa-check"></i><b>1.2</b> Documentacion consultada</a></li>
<li class="chapter" data-level="1.3" data-path="introduccion.html"><a href="introduccion.html#objetivos"><i class="fa fa-check"></i><b>1.3</b> Objetivos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html"><i class="fa fa-check"></i><b>2</b> Análisis del dataset</a><ul>
<li class="chapter" data-level="2.1" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#descripcion-y-significado-de-las-variables"><i class="fa fa-check"></i><b>2.1</b> Descripción y significado de las variables:</a></li>
<li class="chapter" data-level="2.2" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#preparacion-de-las-variables"><i class="fa fa-check"></i><b>2.2</b> Preparación de las variables</a></li>
<li class="chapter" data-level="2.3" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-individual-de-variables"><i class="fa fa-check"></i><b>2.3</b> Análisis individual de variables</a><ul>
<li class="chapter" data-level="2.3.1" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-case_state"><i class="fa fa-check"></i><b>2.3.1</b> Análisis <code>CASE_STATE</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-age"><i class="fa fa-check"></i><b>2.3.2</b> Análisis <code>AGE</code></a></li>
<li class="chapter" data-level="2.3.3" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-sex"><i class="fa fa-check"></i><b>2.3.3</b> Análisis <code>SEX</code></a></li>
<li class="chapter" data-level="2.3.4" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-person_type"><i class="fa fa-check"></i><b>2.3.4</b> Análisis <code>PERSON_TYPE</code></a></li>
<li class="chapter" data-level="2.3.5" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-seating_position"><i class="fa fa-check"></i><b>2.3.5</b> Análisis <code>SEATING_POSITION</code></a></li>
<li class="chapter" data-level="2.3.6" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-air_bag_availability.deployment"><i class="fa fa-check"></i><b>2.3.6</b> Análisis <code>AIR_BAG_AVAILABILITY.DEPLOYMENT</code></a></li>
<li class="chapter" data-level="2.3.7" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-restraint_system.use"><i class="fa fa-check"></i><b>2.3.7</b> Análisis <code>RESTRAINT_SYSTEM.USE</code></a></li>
<li class="chapter" data-level="2.3.8" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-ejection"><i class="fa fa-check"></i><b>2.3.8</b> Análisis <code>EJECTION</code></a></li>
<li class="chapter" data-level="2.3.9" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-ejection_path"><i class="fa fa-check"></i><b>2.3.9</b> Análisis <code>EJECTION_PATH</code></a></li>
<li class="chapter" data-level="2.3.10" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-extrication"><i class="fa fa-check"></i><b>2.3.10</b> Análisis <code>EXTRICATION</code></a></li>
<li class="chapter" data-level="2.3.11" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-non_motorist_location"><i class="fa fa-check"></i><b>2.3.11</b> Análisis <code>NON_MOTORIST_LOCATION</code></a></li>
<li class="chapter" data-level="2.3.12" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-police_reported_alcohol_involvement"><i class="fa fa-check"></i><b>2.3.12</b> Análisis <code>POLICE_REPORTED_ALCOHOL_INVOLVEMENT</code></a></li>
<li class="chapter" data-level="2.3.13" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-method_alcohol_determination"><i class="fa fa-check"></i><b>2.3.13</b> Análisis <code>METHOD_ALCOHOL_DETERMINATION</code></a></li>
<li class="chapter" data-level="2.3.14" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-alcohol_test_type"><i class="fa fa-check"></i><b>2.3.14</b> Análisis <code>ALCOHOL_TEST_TYPE</code></a></li>
<li class="chapter" data-level="2.3.15" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-alcohol_test_result"><i class="fa fa-check"></i><b>2.3.15</b> Análisis <code>ALCOHOL_TEST_RESULT</code></a></li>
<li class="chapter" data-level="2.3.16" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-police_reported_drug_involvement"><i class="fa fa-check"></i><b>2.3.16</b> Análisis <code>POLICE_REPORTED_DRUG_INVOLVEMENT</code></a></li>
<li class="chapter" data-level="2.3.17" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-method_of_drug_determination"><i class="fa fa-check"></i><b>2.3.17</b> Análisis <code>METHOD_OF_DRUG_DETERMINATION</code></a></li>
<li class="chapter" data-level="2.3.18" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-drug_test_type"><i class="fa fa-check"></i><b>2.3.18</b> Análisis <code>DRUG_TEST_TYPE</code></a></li>
<li class="chapter" data-level="2.3.19" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-drug_test_results_.1_of_3."><i class="fa fa-check"></i><b>2.3.19</b> Análisis <code>DRUG_TEST_RESULTS_.1_of_3.</code></a></li>
<li class="chapter" data-level="2.3.20" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-drug_test_type_.2_of_3."><i class="fa fa-check"></i><b>2.3.20</b> Análisis <code>DRUG_TEST_TYPE_.2_of_3.</code></a></li>
<li class="chapter" data-level="2.3.21" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-drug_test_results_.2_of_3."><i class="fa fa-check"></i><b>2.3.21</b> Análisis <code>DRUG_TEST_RESULTS_.2_of_3.</code></a></li>
<li class="chapter" data-level="2.3.22" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-drug_test_type_.3_of_3."><i class="fa fa-check"></i><b>2.3.22</b> Análisis <code>DRUG_TEST_TYPE_.3_of_3.</code></a></li>
<li class="chapter" data-level="2.3.23" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-drug_test_results_.3_of_3."><i class="fa fa-check"></i><b>2.3.23</b> Análisis <code>DRUG_TEST_RESULTS_.3_of_3.</code></a></li>
<li class="chapter" data-level="2.3.24" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-hispanic_origin"><i class="fa fa-check"></i><b>2.3.24</b> Análisis <code>HISPANIC_ORIGIN</code></a></li>
<li class="chapter" data-level="2.3.25" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-taken_to_hospital"><i class="fa fa-check"></i><b>2.3.25</b> Análisis <code>TAKEN_TO_HOSPITAL</code></a></li>
<li class="chapter" data-level="2.3.26" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-related_factor_.1."><i class="fa fa-check"></i><b>2.3.26</b> Análisis <code>RELATED_FACTOR_.1.</code></a></li>
<li class="chapter" data-level="2.3.27" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-related_factor_.2."><i class="fa fa-check"></i><b>2.3.27</b> Análisis <code>RELATED_FACTOR_.2.</code></a></li>
<li class="chapter" data-level="2.3.28" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-related_factor_.3."><i class="fa fa-check"></i><b>2.3.28</b> Análisis <code>RELATED_FACTOR_.3.</code></a></li>
<li class="chapter" data-level="2.3.29" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-race"><i class="fa fa-check"></i><b>2.3.29</b> Análisis <code>RACE</code></a></li>
<li class="chapter" data-level="2.3.30" data-path="analisis-del-dataset.html"><a href="analisis-del-dataset.html#analisis-injury_severity-variable-respuesta"><i class="fa fa-check"></i><b>2.3.30</b> Análisis <code>INJURY_SEVERITY</code>: variable respuesta</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="estudio-de-valores-faltantes.html"><a href="estudio-de-valores-faltantes.html"><i class="fa fa-check"></i><b>3</b> Estudio de valores faltantes</a></li>
<li class="chapter" data-level="4" data-path="seleccion-del-dataframe-variables-de-interes.html"><a href="seleccion-del-dataframe-variables-de-interes.html"><i class="fa fa-check"></i><b>4</b> Selección del dataframe - variables de interés</a></li>
<li class="chapter" data-level="5" data-path="train-y-test.html"><a href="train-y-test.html"><i class="fa fa-check"></i><b>5</b> Train y Test</a></li>
<li class="chapter" data-level="6" data-path="modelos.html"><a href="modelos.html"><i class="fa fa-check"></i><b>6</b> Modelos</a><ul>
<li class="chapter" data-level="6.1" data-path="modelos.html"><a href="modelos.html#modelo-de-regresion-logistica-con-las-variables-representativas"><i class="fa fa-check"></i><b>6.1</b> Modelo de regresión logistica (con las variables representativas)</a><ul>
<li class="chapter" data-level="6.1.1" data-path="modelos.html"><a href="modelos.html#curva-roc"><i class="fa fa-check"></i><b>6.1.1</b> Curva ROC</a></li>
<li class="chapter" data-level="6.1.2" data-path="modelos.html"><a href="modelos.html#regresion-logitica-para-cada-uno-de-los-estados"><i class="fa fa-check"></i><b>6.1.2</b> Regresión logítica para cada uno de los estados</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="modelos.html"><a href="modelos.html#arbol-de-decision"><i class="fa fa-check"></i><b>6.2</b> Árbol de decisión</a></li>
<li class="chapter" data-level="6.3" data-path="modelos.html"><a href="modelos.html#random-forest"><i class="fa fa-check"></i><b>6.3</b> Random forest</a><ul>
<li class="chapter" data-level="6.3.1" data-path="modelos.html"><a href="modelos.html#preparacion-de-datos"><i class="fa fa-check"></i><b>6.3.1</b> Preparación de datos</a></li>
<li class="chapter" data-level="6.3.2" data-path="modelos.html"><a href="modelos.html#ajuste-final"><i class="fa fa-check"></i><b>6.3.2</b> Ajuste final</a></li>
<li class="chapter" data-level="6.3.3" data-path="modelos.html"><a href="modelos.html#curva-roc-1"><i class="fa fa-check"></i><b>6.3.3</b> Curva ROC</a></li>
<li class="chapter" data-level="6.3.4" data-path="modelos.html"><a href="modelos.html#comparativa-de-resultados-con-el-conjunto-de-test"><i class="fa fa-check"></i><b>6.3.4</b> Comparativa de resultados con el conjunto de test</a></li>
<li class="chapter" data-level="6.3.5" data-path="modelos.html"><a href="modelos.html#mostramos-la-fraccion-de-vivos-con-respecto-a-los-muertos"><i class="fa fa-check"></i><b>6.3.5</b> Mostramos la fracción de vivos con respecto a los muertos</a></li>
<li class="chapter" data-level="6.3.6" data-path="modelos.html"><a href="modelos.html#libreria-caret"><i class="fa fa-check"></i><b>6.3.6</b> Libreria: caret</a></li>
<li class="chapter" data-level="6.3.7" data-path="modelos.html"><a href="modelos.html#predictores-mas-influyentes"><i class="fa fa-check"></i><b>6.3.7</b> Predictores más influyentes</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="modelos.html"><a href="modelos.html#gradient-boosting-estocastico"><i class="fa fa-check"></i><b>6.4</b> Gradient Boosting estocástico</a><ul>
<li class="chapter" data-level="6.4.1" data-path="modelos.html"><a href="modelos.html#estimacion-del-parametro-learning-rate-shrinkage"><i class="fa fa-check"></i><b>6.4.1</b> Estimación del parametro learning rate (shrinkage)</a></li>
<li class="chapter" data-level="6.4.2" data-path="modelos.html"><a href="modelos.html#estimacion-del-parametro-de-profundidad-del-arbol"><i class="fa fa-check"></i><b>6.4.2</b> Estimación del parametro de profundidad del árbol</a></li>
<li class="chapter" data-level="6.4.3" data-path="modelos.html"><a href="modelos.html#estimacion-del-numero-minimo-de-observaciones-por-nodo"><i class="fa fa-check"></i><b>6.4.3</b> Estimación del número minimo de observaciones por nodo</a></li>
<li class="chapter" data-level="6.4.4" data-path="modelos.html"><a href="modelos.html#estimacion-del-numero-de-arbol-que-debe-tener-el-conjunto"><i class="fa fa-check"></i><b>6.4.4</b> Estimación del número de árbol que debe tener el conjunto</a></li>
<li class="chapter" data-level="6.4.5" data-path="modelos.html"><a href="modelos.html#modelo-final-con-los-hiperparametros-optimos"><i class="fa fa-check"></i><b>6.4.5</b> Módelo final con los hiperparámetros optimos</a></li>
<li class="chapter" data-level="6.4.6" data-path="modelos.html"><a href="modelos.html#comparacion-con-el-conjunto-de-test"><i class="fa fa-check"></i><b>6.4.6</b> Comparación con el conjunto de test</a></li>
<li class="chapter" data-level="6.4.7" data-path="modelos.html"><a href="modelos.html#curva-roc-3"><i class="fa fa-check"></i><b>6.4.7</b> Curva ROC</a></li>
<li class="chapter" data-level="6.4.8" data-path="modelos.html"><a href="modelos.html#busqueda-de-hiperparametros-con-caret"><i class="fa fa-check"></i><b>6.4.8</b> Busqueda de hiperparametros con Caret</a></li>
<li class="chapter" data-level="6.4.9" data-path="modelos.html"><a href="modelos.html#modelo-final-con-los-hiperparametros-optimos-segun-caret"><i class="fa fa-check"></i><b>6.4.9</b> Módelo final con los hiperparámetros optimos según CARET</a></li>
<li class="chapter" data-level="6.4.10" data-path="modelos.html"><a href="modelos.html#comparacion-con-el-conjunto-de-test-segun-caret"><i class="fa fa-check"></i><b>6.4.10</b> Comparación con el conjunto de test según CARET</a></li>
<li class="chapter" data-level="6.4.11" data-path="modelos.html"><a href="modelos.html#curva-roc-4"><i class="fa fa-check"></i><b>6.4.11</b> Curva ROC</a></li>
<li class="chapter" data-level="6.4.12" data-path="modelos.html"><a href="modelos.html#evaluacion-del-modelo"><i class="fa fa-check"></i><b>6.4.12</b> Evaluación del modelo</a></li>
<li class="chapter" data-level="6.4.13" data-path="modelos.html"><a href="modelos.html#obtencion-de-variables-mas-significativas"><i class="fa fa-check"></i><b>6.4.13</b> Obtención de variables más significativas</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="modelos.html"><a href="modelos.html#analisis-cluster"><i class="fa fa-check"></i><b>6.5</b> Análisis cluster</a><ul>
<li class="chapter" data-level="6.5.1" data-path="modelos.html"><a href="modelos.html#analisis-cluster-1"><i class="fa fa-check"></i><b>6.5.1</b> Análisis cluster 1</a></li>
<li class="chapter" data-level="6.5.2" data-path="modelos.html"><a href="modelos.html#analisis-cluster-2"><i class="fa fa-check"></i><b>6.5.2</b> Análisis cluster 2</a></li>
<li class="chapter" data-level="6.5.3" data-path="modelos.html"><a href="modelos.html#analisis-cluster-3"><i class="fa fa-check"></i><b>6.5.3</b> Analisis cluster 3</a></li>
<li class="chapter" data-level="6.5.4" data-path="modelos.html"><a href="modelos.html#analisis-cluster-4"><i class="fa fa-check"></i><b>6.5.4</b> Analisis cluster 4</a></li>
<li class="chapter" data-level="6.5.5" data-path="modelos.html"><a href="modelos.html#transformacion-a-problema-binario-para-calculo-de-kmeans"><i class="fa fa-check"></i><b>6.5.5</b> Transformación a problema binario para calculo de kmeans</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="modelos.html"><a href="modelos.html#naive-bayes"><i class="fa fa-check"></i><b>6.6</b> NAIVE-BAYES</a><ul>
<li class="chapter" data-level="6.6.1" data-path="modelos.html"><a href="modelos.html#ejecucion-del-modelo"><i class="fa fa-check"></i><b>6.6.1</b> Ejecución del modelo</a></li>
<li class="chapter" data-level="6.6.2" data-path="modelos.html"><a href="modelos.html#evaluacion-del-modelo-1"><i class="fa fa-check"></i><b>6.6.2</b> Evaluación del modelo</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="modelos.html"><a href="modelos.html#svm-lineal"><i class="fa fa-check"></i><b>6.7</b> SVM Lineal</a><ul>
<li class="chapter" data-level="6.7.1" data-path="modelos.html"><a href="modelos.html#evaluacion-del-modelo-2"><i class="fa fa-check"></i><b>6.7.1</b> Evaluación del modelo</a></li>
<li class="chapter" data-level="6.7.2" data-path="modelos.html"><a href="modelos.html#modelo-svm-tuneado"><i class="fa fa-check"></i><b>6.7.2</b> Modelo svm tuneado</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="modelos.html"><a href="modelos.html#svm-no-lineal"><i class="fa fa-check"></i><b>6.8</b> SVM NO Lineal</a><ul>
<li class="chapter" data-level="6.8.1" data-path="modelos.html"><a href="modelos.html#libreria-empleada-caret"><i class="fa fa-check"></i><b>6.8.1</b> Libreria empleada: Caret</a></li>
<li class="chapter" data-level="6.8.2" data-path="modelos.html"><a href="modelos.html#libreria-empleada-kernlab"><i class="fa fa-check"></i><b>6.8.2</b> Libreria empleada: kernlab</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="modelos.html"><a href="modelos.html#redes-neuronales"><i class="fa fa-check"></i><b>6.9</b> Redes Neuronales</a><ul>
<li class="chapter" data-level="6.9.1" data-path="modelos.html"><a href="modelos.html#preparacion-del-modelo"><i class="fa fa-check"></i><b>6.9.1</b> Preparación del modelo</a></li>
<li class="chapter" data-level="6.9.2" data-path="modelos.html"><a href="modelos.html#ejecucion-del-modelo-1"><i class="fa fa-check"></i><b>6.9.2</b> Ejecución del modelo</a></li>
<li class="chapter" data-level="6.9.3" data-path="modelos.html"><a href="modelos.html#evaluacion-del-modelo-5"><i class="fa fa-check"></i><b>6.9.3</b> Evaluación del modelo</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="modelos.html"><a href="modelos.html#deep-learning"><i class="fa fa-check"></i><b>6.10</b> Deep Learning</a><ul>
<li class="chapter" data-level="6.10.1" data-path="modelos.html"><a href="modelos.html#preparacion-de-datos-1"><i class="fa fa-check"></i><b>6.10.1</b> Preparación de datos</a></li>
<li class="chapter" data-level="6.10.2" data-path="modelos.html"><a href="modelos.html#preparacion-de-la-red-profunda"><i class="fa fa-check"></i><b>6.10.2</b> Preparación de la red profunda</a></li>
<li class="chapter" data-level="6.10.3" data-path="modelos.html"><a href="modelos.html#escalamos-datos"><i class="fa fa-check"></i><b>6.10.3</b> Escalamos datos</a></li>
<li class="chapter" data-level="6.10.4" data-path="modelos.html"><a href="modelos.html#ajustamos-el-modelo-construidos-a-nuestros-datos"><i class="fa fa-check"></i><b>6.10.4</b> Ajustamos el modelo construidos a nuestros datos</a></li>
<li class="chapter" data-level="6.10.5" data-path="modelos.html"><a href="modelos.html#evaluacion-del-modelo-6"><i class="fa fa-check"></i><b>6.10.5</b> Evaluación del modelo</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="modelos.html"><a href="modelos.html#evaluacion-conjunta-de-todos-los-modelos"><i class="fa fa-check"></i><b>6.11</b> Evaluacion conjunta de todos los modelos</a><ul>
<li class="chapter" data-level="6.11.1" data-path="modelos.html"><a href="modelos.html#curvas-ro"><i class="fa fa-check"></i><b>6.11.1</b> Curvas RO</a></li>
<li class="chapter" data-level="6.11.2" data-path="modelos.html"><a href="modelos.html#resultados-f-score"><i class="fa fa-check"></i><b>6.11.2</b> Resultados F-SCORE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="debates-y-anotaciones.html"><a href="debates-y-anotaciones.html"><i class="fa fa-check"></i><b>7</b> Debates y anotaciones</a></li>
<li class="chapter" data-level="8" data-path="conclusiones.html"><a href="conclusiones.html"><i class="fa fa-check"></i><b>8</b> Conclusiones</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">FARS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analisis-del-dataset" class="section level1">
<h1><span class="header-section-number">2</span> Análisis del dataset</h1>
<p>Importamos librerias necesarias en el análisis</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(knitr)
<span class="kw">library</span>(Hmisc)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span> (MASS)
<span class="kw">library</span>(plyr)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(VIM)
<span class="kw">library</span>(corrgram)
<span class="kw">library</span>(cowplot)
<span class="kw">library</span>(boot)
<span class="kw">library</span>(klaR)
<span class="kw">library</span>(kableExtra)
<span class="kw">library</span>(caret)
<span class="kw">library</span>(ROCR)

<span class="kw">options</span>(<span class="dt">knitr.table.format =</span> <span class="st">&quot;html&quot;</span>)
opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">tidy.opts=</span><span class="kw">list</span>(<span class="dt">width.cutoff=</span><span class="dv">60</span>),<span class="dt">tidy=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>Carga de datos</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fars=<span class="kw">read.table</span>(<span class="dt">file=</span><span class="st">&quot;.//fars.dat&quot;</span>,<span class="dt">header =</span> <span class="ot">FALSE</span>, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>, <span class="dt">dec=</span><span class="st">&quot;.&quot;</span>, <span class="dt">skip =</span> <span class="dv">34</span>, <span class="dt">check.names =</span> <span class="ot">TRUE</span>, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;CASE_STATE&quot;</span>,<span class="st">&quot;AGE&quot;</span>,<span class="st">&quot;SEX&quot;</span>,<span class="st">&quot;PERSON_TYPE&quot;</span>,<span class="st">&quot;SEATING_POSITION&quot;</span>,<span class="st">&quot;RESTRAINT_SYSTEM-USE&quot;</span>,<span class="st">&quot;AIR_BAG_AVAILABILITY/DEPLOYMENT&quot;</span>,<span class="st">&quot;EJECTION&quot;</span>,<span class="st">&quot;EJECTION_PATH&quot;</span>,<span class="st">&quot;EXTRICATION&quot;</span>,<span class="st">&quot;NON_MOTORIST_LOCATION&quot;</span>,<span class="st">&quot;POLICE_REPORTED_ALCOHOL_INVOLVEMENT&quot;</span>,<span class="st">&quot;METHOD_ALCOHOL_DETERMINATION&quot;</span>,<span class="st">&quot;ALCOHOL_TEST_TYPE&quot;</span>,<span class="st">&quot;ALCOHOL_TEST_RESULT&quot;</span>,<span class="st">&quot;POLICE-REPORTED_DRUG_INVOLVEMENT&quot;</span>,<span class="st">&quot;METHOD_OF_DRUG_DETERMINATION&quot;</span>,<span class="st">&quot;DRUG_TEST_TYPE&quot;</span>,<span class="st">&quot;DRUG_TEST_RESULTS_(1_of_3)&quot;</span>,<span class="st">&quot;DRUG_TEST_TYPE_(2_of_3)&quot;</span>,<span class="st">&quot;DRUG_TEST_RESULTS_(2_of_3)&quot;</span>,<span class="st">&quot;DRUG_TEST_TYPE_(3_of_3)&quot;</span>,<span class="st">&quot;DRUG_TEST_RESULTS_(3_of_3)&quot;</span>,<span class="st">&quot;HISPANIC_ORIGIN&quot;</span>,<span class="st">&quot;TAKEN_TO_HOSPITAL&quot;</span>,<span class="st">&quot;RELATED_FACTOR_(1)&quot;</span>,<span class="st">&quot;RELATED_FACTOR_(2)&quot;</span>,<span class="st">&quot;RELATED_FACTOR_(3)&quot;</span>,<span class="st">&quot;RACE&quot;</span>,<span class="st">&quot;INJURY_SEVERITY&quot;</span>),<span class="dt">colClasses =</span> <span class="ot">NA</span>)</code></pre></div>
<div id="descripcion-y-significado-de-las-variables" class="section level2">
<h2><span class="header-section-number">2.1</span> Descripción y significado de las variables:</h2>
<table>
<colgroup>
<col width="46%" />
<col width="53%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Significado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CASE_STATE</td>
<td>Estado americano donde se ha producido el accidente automovilístico. Variable cualitativa nominal.</td>
</tr>
<tr class="even">
<td>AGE</td>
<td>Edad del implicado en el accidente. Variable cuantitativa discreta medida en años.</td>
</tr>
<tr class="odd">
<td>SEX</td>
<td>Sexo del implicado en el accidente. Variable cualitativa nominal.</td>
</tr>
<tr class="even">
<td>PERSON_TYPE</td>
<td>Tipología del implicado en el accidente: conductor, pasajero, peaton, ciclista, etc. Variable cualitativa nominal.</td>
</tr>
<tr class="odd">
<td>SEATING_POSITION</td>
<td>Posición del implicado en el accidente dentro del vehiculo. Variable cualitativa nominal.</td>
</tr>
<tr class="even">
<td>RESTRAINT_SYSTEM_USE</td>
<td>Uso de sistema de protección y/o retención del implicado en el accidente. Variable cualitativa nominal.</td>
</tr>
<tr class="odd">
<td>AIR_BAG_AVAILABILITY.DEPLOYMENT</td>
<td>Variable que describe la presencia y si se ha desplegado o no el airbag del vehículo. Variable cualitativa nominal</td>
</tr>
<tr class="even">
<td>EJECTION</td>
<td>Describe si el implicado en el accidente ha sido expulsado del vehiculo y el grado de la expulsión. Variable cualitativa ordinal.</td>
</tr>
<tr class="odd">
<td>EJECTION_PATH</td>
<td>Variable que describe la trayectoria de la expulsión del vehiculo. Variable cualitativa nominal.</td>
</tr>
<tr class="even">
<td>EXTRICATION</td>
<td>Variable que indica la excarcelación de dentro del vehiculo. Variable cualitativa nominal.</td>
</tr>
<tr class="odd">
<td>NON_MOTORIST_LOCATION</td>
<td>La localización de un viandante en el momento del impacto</td>
</tr>
<tr class="even">
<td>POLICE_REPORTED_ALCOHOL_INVOLV.</td>
<td>Declaración de la policia sobre el consumo de alcohol por parte del implicado en el accidente. Variable cualitativa nominal</td>
</tr>
<tr class="odd">
<td>METHOD_ALCOHOL_DETERMINATION</td>
<td>Método de identificación de consumo previo de alcohol por parte de la policia. Variable cualitativa nominal.</td>
</tr>
<tr class="even">
<td>ALCOHOL_TEST_TYPE</td>
<td>Tipo de test realizado (incluidos forense) para identificar el consumo de alcohol. Variable cualitativa nominal.</td>
</tr>
<tr class="odd">
<td>ALCOHOL_TEST_RESULT</td>
<td>Resutados del test de alcohol en sangre medido en “Milimoles de alcohol por un litro de sangre”. Variable cuantitativa discreta.</td>
</tr>
<tr class="even">
<td>POLICE-REPORTED_DRUG_INVOLVEMENT</td>
<td>Declaración de la policia sobre el consumo de drogas por parte del implicado en el accidente. Variable cualitativa nominal</td>
</tr>
<tr class="odd">
<td>METHOD_OF_DRUG_DETERMINATION</td>
<td>Método de identificación de consumo previo de drogas por parte de la policia. Variable cualitativa nominal.</td>
</tr>
<tr class="even">
<td>DRUG_TEST_TYPE</td>
<td>Tipo de test realizado, mencionado si se conoce. Variable cualitativa nominal.</td>
</tr>
<tr class="odd">
<td>DRUG_TEST_RESULTS_(1_of_3)</td>
<td>Resutados del test de drogas medido en “nanogramos por mililitro”. Variable cuantitativa discreta.</td>
</tr>
<tr class="even">
<td>DRUG_TEST_TYPE_(2_of_3)</td>
<td>2º tipo de test realizado, mencionado si se conoce. Variable cualitativa nominal.</td>
</tr>
<tr class="odd">
<td>DRUG_TEST_RESULTS_(2_of_3)</td>
<td>Resutados del test de drogas medido en “nanogramos por mililitro”. Variable cuantitativa discreta.</td>
</tr>
<tr class="even">
<td>DRUG_TEST_TYPE_(3_of_3)</td>
<td>3º tipo de test realizado, mencionado si se conoce. Variable cualitativa nominal.</td>
</tr>
<tr class="odd">
<td>DRUG_TEST_RESULTS_(3_of_3)</td>
<td>Resutados del test de drogas medido en “nanogramos por mililitro”. Variable cuantitativa discreta.</td>
</tr>
<tr class="even">
<td>HISPANIC_ORIGIN</td>
<td>El origen hispano del implicado en el accidente. Variable cualitativa nominal.</td>
</tr>
<tr class="odd">
<td>TAKEN_TO_HOSPITAL</td>
<td>¿Ha sido llevado o no el implicado en el accidente al hospital?</td>
</tr>
<tr class="even">
<td>RELATED_FACTOR_(1)</td>
<td>Otros diversos factores relacionados con el accidente. Varaiable cualitativa nominal.</td>
</tr>
<tr class="odd">
<td>RELATED_FACTOR_(2)</td>
<td>Segunda descripción de factores relacionados con el accidente.Varaiable cualitativa nominal.</td>
</tr>
<tr class="even">
<td>RELATED_FACTOR_(3)</td>
<td>Tercera descripción de factores relacionados con el accidente.Varaiable cualitativa nominal.</td>
</tr>
<tr class="odd">
<td>RACE</td>
<td>Raza del implicado en el accidente. Variable cualitativa nominal</td>
</tr>
<tr class="even">
<td>INJURY_SEVERITY</td>
<td>Situación medica del implicado en el accidente. Varaiable cualitativa nominal.</td>
</tr>
</tbody>
</table>
<p>Análisis genérico del dataset</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#la dimensión de los datos</span>
<span class="kw">dim</span>(fars)</code></pre></div>
<pre><code>## [1] 100968     30</code></pre>
<p>Realizamos un resumen de la tipología de las variables: factor, integer, etc.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#un resumen de la estructura de los objetos</span>
<span class="kw">str</span>(fars)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    100968 obs. of  30 variables:
##  $ CASE_STATE                         : Factor w/ 51 levels &quot;Alabama&quot;,&quot;Alaska&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ AGE                                : int  34 20 43 38 50 40 50 69 94 47 ...
##  $ SEX                                : Factor w/ 3 levels &quot;Female&quot;,&quot;Male&quot;,..: 2 2 2 1 2 1 2 1 2 2 ...
##  $ PERSON_TYPE                        : Factor w/ 10 levels &quot;Bicyclist&quot;,&quot;Driver&quot;,..: 2 2 2 7 2 2 2 7 8 2 ...
##  $ SEATING_POSITION                   : Factor w/ 26 levels &quot;Fourth_Seat_-_Left_Side&quot;,..: 4 4 4 7 4 4 4 7 9 4 ...
##  $ RESTRAINT_SYSTEM.USE               : Factor w/ 12 levels &quot;Bicycle_Helmet&quot;,..: 8 8 5 5 5 5 8 8 8 5 ...
##  $ AIR_BAG_AVAILABILITY.DEPLOYMENT    : Factor w/ 13 levels &quot;Air_Bad_Available-Deployment_Not_Known_for_this_Seat&quot;,..: 3 8 5 5 8 5 5 5 12 5 ...
##  $ EJECTION                           : Factor w/ 4 levels &quot;Not_Ejected&quot;,..: 3 3 1 1 1 1 1 3 1 1 ...
##  $ EJECTION_PATH                      : Factor w/ 10 levels &quot;Not_Ejected/Not_Applicable&quot;,..: 10 10 1 1 1 1 1 10 1 1 ...
##  $ EXTRICATION                        : Factor w/ 3 levels &quot;Extricated&quot;,&quot;Not_Extricated&quot;,..: 2 2 1 1 2 2 2 2 2 2 ...
##  $ NON_MOTORIST_LOCATION              : Factor w/ 18 levels &quot;Intersection_-_In_Crosswalk&quot;,..: 17 17 17 17 17 17 17 17 12 17 ...
##  $ POLICE_REPORTED_ALCOHOL_INVOLVEMENT: Factor w/ 4 levels &quot;No_(Alcohol_Not_Involved)&quot;,..: 4 1 1 2 4 1 1 2 1 1 ...
##  $ METHOD_ALCOHOL_DETERMINATION       : Factor w/ 7 levels &quot;Behavioral&quot;,&quot;Evidential_Test_(Breath_Blood_Urine)&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ ALCOHOL_TEST_TYPE                  : Factor w/ 10 levels &quot;Blood_Clot&quot;,&quot;Blood_Plasma/Serum&quot;,..: 10 5 5 5 10 5 5 7 10 10 ...
##  $ ALCOHOL_TEST_RESULT                : int  97 96 96 96 97 96 96 99 97 0 ...
##  $ POLICE.REPORTED_DRUG_INVOLVEMENT   : Factor w/ 4 levels &quot;Drugs_Involved&quot;,..: 4 2 2 3 4 2 2 3 4 4 ...
##  $ METHOD_OF_DRUG_DETERMINATION       : Factor w/ 5 levels &quot;Behavioral&quot;,&quot;Drug_Recognition_Technician_(DRT)&quot;,..: 4 4 4 4 4 4 4 4 4 4 ...
##  $ DRUG_TEST_TYPE                     : Factor w/ 7 levels &quot;Blood_Test&quot;,&quot;Both:_Blood_and_Urine_(Since_1993)&quot;,..: 5 3 3 3 5 3 3 5 5 2 ...
##  $ DRUG_TEST_RESULTS_.1_of_3.         : int  999 0 0 0 999 0 0 999 999 1 ...
##  $ DRUG_TEST_TYPE_.2_of_3.            : Factor w/ 7 levels &quot;Blood_Test&quot;,&quot;Both:_Blood_and_Urine_(Since_1993)&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ DRUG_TEST_RESULTS_.2_of_3.         : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ DRUG_TEST_TYPE_.3_of_3.            : Factor w/ 7 levels &quot;Blood_Test&quot;,&quot;Both:_Blood_and_Urine_(Since_1993)&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ DRUG_TEST_RESULTS_.3_of_3.         : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ HISPANIC_ORIGIN                    : Factor w/ 9 levels &quot;Central_or_South_American&quot;,..: 6 6 6 7 6 7 7 6 6 7 ...
##  $ TAKEN_TO_HOSPITAL                  : Factor w/ 3 levels &quot;No&quot;,&quot;Unknown&quot;,..: 1 1 1 3 3 3 1 1 1 1 ...
##  $ RELATED_FACTOR_.1.                 : Factor w/ 45 levels &quot;Blind&quot;,&quot;Construction/Maintenance/Utility_Worker&quot;,..: 28 28 28 28 28 28 28 28 45 28 ...
##  $ RELATED_FACTOR_.2.                 : Factor w/ 48 levels &quot;Animals_in_Road&quot;,..: 30 30 30 30 30 30 30 30 30 30 ...
##  $ RELATED_FACTOR_.3.                 : Factor w/ 33 levels &quot;Blind&quot;,&quot;Building_Billboard_or_Other_Structures&quot;,..: 20 20 20 20 20 20 20 20 20 20 ...
##  $ RACE                               : Factor w/ 18 levels &quot;All_Other_Races&quot;,..: 18 18 5 12 5 12 12 5 18 12 ...
##  $ INJURY_SEVERITY                    : Factor w/ 8 levels &quot;Died_Prior_to_Accident&quot;,..: 2 2 2 3 2 3 5 2 2 5 ...</code></pre>
<p>Una descripción general de las variables</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(fars)</code></pre></div>
<pre><code>## fars 
## 
##  30  Variables      100968  Observations
## ---------------------------------------------------------------------------
## CASE_STATE 
##        n  missing distinct 
##   100968        0       51 
## 
## lowest : Alabama       Alaska        Arizona       Arkansas      California   
## highest: Virginia      Washington    West_Virginia Wisconsin     Wyoming      
## ---------------------------------------------------------------------------
## AGE 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##   100968        0       99        1    37.11    24.34        8       15 
##      .25      .50      .75      .90      .95 
##       20       32       49       70       81 
## 
## lowest :  0  1  2  3  4, highest: 94 95 96 97 99
## ---------------------------------------------------------------------------
## SEX 
##        n  missing distinct 
##   100968        0        3 
##                                   
## Value       Female    Male Unknown
## Frequency    33573   65740    1655
## Proportion   0.333   0.651   0.016
## ---------------------------------------------------------------------------
## PERSON_TYPE 
##        n  missing distinct 
##   100968        0       10 
## 
## lowest : Bicyclist                                             Driver                                                Occupant_of_a_Motor_Vehicle_Not_in_Transport          Occupant_of_a_Non-Motor_Vehicle_Transport_Device      Other_Cyclist                                        
## highest: Other_Pedestrian                                      Passenger_of_a_Motor_Vehicle_in_Transport             Pedestrian                                            Unknown_Occupant_Type_in_a_Motor_Vehicle_in_Transport Unknown_Type_of_Non-Motorist                         
## ---------------------------------------------------------------------------
## SEATING_POSITION 
##        n  missing distinct 
##   100968        0       26 
## 
## lowest : Fourth_Seat_-_Left_Side               Fourth_Seat_-_Middle                  Fourth_Seat_-_Right_Side              Front_Seat_-_Left_Side_(Drivers_Side) Front_Seat_-_Middle                  
## highest: Third_Seat_-_Other                    Third_Seat_-_Right_Side               Third_Seat_-_Unknown                  Trailing_Unit                         Unknown                              
## ---------------------------------------------------------------------------
## RESTRAINT_SYSTEM.USE 
##        n  missing distinct 
##   100968        0       12 
## 
## lowest : Bicycle_Helmet                    Child_Safety_Seat                 Child_Safety_Seat_Used_Improperly Helmets_Used_Improperly           Lap_and_Shoulder_Belt            
## highest: None_Used/Not_Applicable          Restraint_Used_-_Type_Unknown     Safety_Belt_Used_Improperly       Shoulder_Belt                     Unknown                          
## ---------------------------------------------------------------------------
## AIR_BAG_AVAILABILITY.DEPLOYMENT 
##        n  missing distinct 
##   100968        0       13 
## 
## lowest : Air_Bad_Available-Deployment_Not_Known_for_this_Seat Air_Bag_Available_and_Switched_Off                   Air_Bag_Available_but_Not_Deployed_for_this_Seat     Air_Bag_Disabled_or_Removed                          Air_Bag_Not_Available_for_this_Seat                 
## highest: Deployed_Air_Bag_from_Side                           Deployed_Air_Bag_Multiple_Directions                 Deployed_Air_Bag_Other_Direction                     Non-Motorist                                         Unknown_(If_Airbag_Available)                       
## ---------------------------------------------------------------------------
## EJECTION 
##        n  missing distinct 
##   100968        0        4 
##                                                                 
## Value            Not_Ejected Partially_Ejected   Totally_Ejected
## Frequency              87475              2191             10410
## Proportion             0.866             0.022             0.103
##                             
## Value                Unknown
## Frequency                892
## Proportion             0.009
## ---------------------------------------------------------------------------
## EJECTION_PATH 
##        n  missing distinct 
##   100968        0       10 
## 
## lowest : Not_Ejected/Not_Applicable        Other_Path_(e.g._back_of_pickup)  Through_Back_Door/Tailgate        Through_Back_Window               Through_Roof_(convertible_top_up)
## highest: Through_Roof_Opening              Through_Side_Door_Opening         Through_Side_Window               Through_Windshield                Unknown                          
## ---------------------------------------------------------------------------
## EXTRICATION 
##        n  missing distinct 
##   100968        0        3 
##                                                        
## Value          Extricated Not_Extricated        Unknown
## Frequency            9826          89933           1209
## Proportion          0.097          0.891          0.012
## ---------------------------------------------------------------------------
## NON_MOTORIST_LOCATION 
##        n  missing distinct 
##   100968        0       18 
## 
## lowest : Intersection_-_In_Crosswalk                              Intersection_-_Not_on_Roadway                            Intersection_-_On_Roadway_Crosswalk_Availability_Unknown Intersection_-_On_Roadway_Crosswalk_not_Available        Intersection_-_On_Roadway_Not_in_Crosswalk              
## highest: Non-Intersection_-_Other_Not_a_Roadway                   Non-Intersection_-_Outside_Trafficway                    Non-Intersection_-_Unknown                               Not_Applicable_-_Vehicle_Occupant                        Unknown                                                 
## ---------------------------------------------------------------------------
## POLICE_REPORTED_ALCOHOL_INVOLVEMENT 
##        n  missing distinct 
##   100968        0        4 
##                                                               
## Value      No_(Alcohol_Not_Involved)              Not_reported
## Frequency                      34810                     45448
## Proportion                     0.345                     0.450
##                                                               
## Value      Unknown_(Police_Reported)    Yes_(Alcohol_Involved)
## Frequency                      10799                      9911
## Proportion                     0.107                     0.098
## ---------------------------------------------------------------------------
## METHOD_ALCOHOL_DETERMINATION 
##        n  missing distinct 
##   100968        0        7 
## 
## Behavioral (359, 0.004), Evidential_Test_(Breath_Blood_Urine) (7335,
## 0.073), Not_Reported (84208, 0.834), Observed (7082, 0.070),
## Other_(e.g._Saliva_test) (1238, 0.012), Passive_Alcohol_Sensor_(PAS) (25,
## 0.000), Preliminary_Breath_Test_(PBT) (721, 0.007)
## ---------------------------------------------------------------------------
## ALCOHOL_TEST_TYPE 
##        n  missing distinct 
##   100968        0       10 
## 
## Blood_Clot (3, 0.000), Blood_Plasma/Serum (92, 0.001), Breath_BAC (1447,
## 0.014), Liver (18, 0.000), Not_Tested_for_Alcohol (55405, 0.549),
## Other_Test_Type (268, 0.003), Unknown(Not_Reported_Since_2001) (9810,
## 0.097), Urine (231, 0.002), Vitreous (144, 0.001), Whole_Blood (33550,
## 0.332)
## ---------------------------------------------------------------------------
## ALCOHOL_TEST_RESULT 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##   100968        0       69    0.827    68.02    40.23        0        0 
##      .25      .50      .75      .90      .95 
##       15       96       96       97       99 
## 
## lowest :  0  1  2  3  4, highest: 81 95 96 97 99
## ---------------------------------------------------------------------------
## POLICE.REPORTED_DRUG_INVOLVEMENT 
##        n  missing distinct 
##   100968        0        4 
##                                                              
## Value        Drugs_Involved         No_Drugs     Not_Reported
## Frequency              1626            18335            74725
## Proportion            0.016            0.182            0.740
##                            
## Value      Reported_Unknown
## Frequency              6282
## Proportion            0.062
## ---------------------------------------------------------------------------
## METHOD_OF_DRUG_DETERMINATION 
##        n  missing distinct 
##   100968        0        5 
## 
## Behavioral (621, 0.006), Drug_Recognition_Technician_(DRT) (117, 0.001),
## Evidential_Test_(Blood_Urine) (2675, 0.026), Not_Reported (94794, 0.939),
## Other (2761, 0.027)
## ---------------------------------------------------------------------------
## DRUG_TEST_TYPE 
##        n  missing distinct 
##   100968        0        7 
## 
## Blood_Test (16153, 0.160), Both:_Blood_and_Urine_(Since_1993) (1422,
## 0.014), Not_Tested_for_Drugs (64072, 0.635), Other_Type_Test (240, 0.002),
## Unknown_if_Tested_for_Drugs (15805, 0.157), Unknown_Test_Type (1304,
## 0.013), Urine_Test (1972, 0.020)
## ---------------------------------------------------------------------------
## DRUG_TEST_RESULTS_.1_of_3. 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##   100968        0       95    0.738    207.4    328.3        0        0 
##      .25      .50      .75      .90      .95 
##        0        0        1      999      999 
## 
## lowest :   0   1 100 106 115, highest: 900 996 997 998 999
## ---------------------------------------------------------------------------
## DRUG_TEST_TYPE_.2_of_3. 
##        n  missing distinct 
##   100968        0        7 
## 
## Blood_Test (1743, 0.017), Both:_Blood_and_Urine_(Since_1993) (213, 0.002),
## Not_Tested_for_Drugs (89270, 0.884), Other_Type_Test (114, 0.001),
## Unknown_if_Tested_for_Drugs (9244, 0.092), Unknown_Test_Type (31, 0.000),
## Urine_Test (353, 0.003)
## ---------------------------------------------------------------------------
## DRUG_TEST_RESULTS_.2_of_3. 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##   100968        0       73    0.308    100.1    180.1        0        0 
##      .25      .50      .75      .90      .95 
##        0        0        0      417      999 
## 
## lowest :   0   1 100 117 128, highest: 900 996 997 998 999
## ---------------------------------------------------------------------------
## DRUG_TEST_TYPE_.3_of_3. 
##        n  missing distinct 
##   100968        0        7 
## 
## Blood_Test (1068, 0.011), Both:_Blood_and_Urine_(Since_1993) (84, 0.001),
## Not_Tested_for_Drugs (90394, 0.895), Other_Type_Test (46, 0.000),
## Unknown_if_Tested_for_Drugs (9248, 0.092), Unknown_Test_Type (11, 0.000),
## Urine_Test (117, 0.001)
## ---------------------------------------------------------------------------
## DRUG_TEST_RESULTS_.3_of_3. 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##   100968        0       59    0.282    95.44    172.6        0        0 
##      .25      .50      .75      .90      .95 
##        0        0        0        1      999 
## 
## lowest :   0   1 100 136 145, highest: 924 996 997 998 999
## ---------------------------------------------------------------------------
## HISPANIC_ORIGIN 
##        n  missing distinct 
##   100968        0        9 
## 
## Central_or_South_American (239, 0.002), Cuban (120, 0.001),
## European_Spanish (28, 0.000),
## Hispanic_-_Origin_Not_Specified_or_Other_Origin (290, 0.003), Mexican
## (1145, 0.011), Non-Hispanic (21836, 0.216),
## Not_a_Fatality_(Not_Applicable) (58686, 0.581), Puerto_Rican (153, 0.002),
## Unknown (18471, 0.183)
## ---------------------------------------------------------------------------
## TAKEN_TO_HOSPITAL 
##        n  missing distinct 
##   100968        0        3 
##                                   
## Value           No Unknown     Yes
## Frequency    46699    1914   52355
## Proportion   0.463   0.019   0.519
## ---------------------------------------------------------------------------
## RELATED_FACTOR_.1. 
##        n  missing distinct 
##   100968        0       45 
## 
## lowest : Blind                                                                                         Construction/Maintenance/Utility_Worker                                                       Darting_Stumbling_or_Running_into_Road                                                        Driving_on_Wrong_Side_of_Road                                                                 Emotional_(e.g._Depression_Angry_Disputed)                                                   
## highest: Traveling_on_Prohibited_Trafficway                                                            Unknown                                                                                       Vision_obscured_by_overcorrecting                                                             Walking_With_Cane_or_Crutches                                                                 Walking/Riding_with_or_Against_Traffic_Playing_Working_Sitting_Lying_Standing_etc._in_Roadway
## ---------------------------------------------------------------------------
## RELATED_FACTOR_.2. 
##        n  missing distinct 
##   100968        0       48 
## 
## lowest : Animals_in_Road                                                                               Blind                                                                                         Construction/Maintenance/Utility_Worker                                                       Curve_Hill_Or_Other_Design_Features_(including_Traffic_signs_Embankment)                      Darting_Stumbling_or_Running_into_Road                                                       
## highest: Trees_Crops_Vegetation                                                                        Unknown                                                                                       Vehicle_in_Road                                                                               Walking_With_Cane_or_Crutches                                                                 Walking/Riding_with_or_Against_Traffic_Playing_Working_Sitting_Lying_Standing_etc._in_Roadway
## ---------------------------------------------------------------------------
## RELATED_FACTOR_.3. 
##        n  missing distinct 
##   100968        0       33 
## 
## lowest : Blind                                                                                         Building_Billboard_or_Other_Structures                                                        Darting_Stumbling_or_Running_into_Road                                                        Driving_on_Wrong_Side_of_Road                                                                 Driving_too_Fast_for_Conditions_or_in_Excess_of_Posted_Speed_Limit                           
## highest: Restricted_to_Wheelchair                                                                      Traveling_on_Prohibited_Trafficway                                                            Unknown                                                                                       Walking_With_Cane_or_Crutches                                                                 Walking/Riding_with_or_Against_Traffic_Playing_Working_Sitting_Lying_Standing_etc._in_Roadway
## ---------------------------------------------------------------------------
## RACE 
##        n  missing distinct 
##   100968        0       18 
## 
## lowest : All_Other_Races                                         American_Indian_(_Includes_Aleuts_and_Eskimos)          Asian_Indian                                            Asian_or_Pacific_Islander_No_Specific_(Individual)_Race Black                                                  
## highest: Other_Indian_(Includes_South_and_Central_America)       Samoan                                                  Unknown                                                 Vietnamese                                              White                                                  
## ---------------------------------------------------------------------------
## INJURY_SEVERITY 
##        n  missing distinct 
##   100968        0        8 
## 
## Died_Prior_to_Accident (9, 0.000), Fatal_Injury (42116, 0.417),
## Incapaciting_Injury (15072, 0.149), Injured_Severity_Unknown (299, 0.003),
## No_Injury (20007, 0.198), Nonincapaciting_Evident_Injury (13890, 0.138),
## Possible_Injury (8674, 0.086), Unknown (901, 0.009)
## ---------------------------------------------------------------------------</code></pre>
<p>Para un mejor entendimiento de las variables las podemos visualizar en una tabla aparte.</p>
<!-- Copiamos el dataframe original. Trabajaremos con este dataframe de ahora en adelante-->
</div>
<div id="preparacion-de-las-variables" class="section level2">
<h2><span class="header-section-number">2.2</span> Preparación de las variables</h2>
<p>En esta sección analizaremos cada una de las variables que forman el dataset por separado, con el fin de darles el formato requerido para ser usadas en el modelo final de regresión.</p>
<p>Preparación de la variable <code>INJURY_SEVERITY</code> - la variable respuesta</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>INJURY_SEVERITY =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>INJURY_SEVERITY, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Died_Prior_to_Accident&quot;</span>, <span class="st">&quot;Fatal_Injury&quot;</span>, <span class="st">&quot;Nonincapaciting_Evident_Injury&quot;</span>,<span class="st">&quot;Possible_Injury&quot;</span>,<span class="st">&quot;Incapaciting_Injury&quot;</span>,<span class="st">&quot;No_Injury&quot;</span>,<span class="st">&quot;Unknown&quot;</span>,<span class="st">&quot;Injured_Severity_Unknown&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;Died&quot;</span>, <span class="st">&quot;Died&quot;</span>,<span class="st">&quot;Survived&quot;</span>,<span class="st">&quot;Survived&quot;</span>,<span class="st">&quot;Survived&quot;</span>,<span class="st">&quot;Survived&quot;</span>,<span class="ot">NA</span>,<span class="ot">NA</span>),<span class="dt">warn_missing=</span>F)
<span class="kw">summary</span>(df<span class="op">$</span>INJURY_SEVERITY)</code></pre></div>
<pre><code>##     Died Survived     NA&#39;s 
##    42125    57643     1200</code></pre>
<p>Preparación de otras variables</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Preparation PERSON_TYPE (var 4)</span>
df<span class="op">$</span>PERSON_TYPE =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>PERSON_TYPE, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Bicyclist&quot;</span>, <span class="st">&quot;Driver&quot;</span>, <span class="st">&quot;Occupant_of_a_Non-Motor_Vehicle_Transport_Device&quot;</span>,<span class="st">&quot;Passenger_of_a_Motor_Vehicle_in_Transport&quot;</span>,<span class="st">&quot;Other_Cyclist&quot;</span>,<span class="st">&quot;Pedestrian&quot;</span>,<span class="st">&quot;Occupant_of_a_Motor_Vehicle_Not_in_Transport&quot;</span>,<span class="st">&quot;Other_Pedestrian&quot;</span>,<span class="st">&quot;Unknown_Occupant_Type_in_a_Motor_Vehicle_in_Transport&quot;</span>,<span class="st">&quot;Unknown_Type_of_Non-Motorist&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;Bicyclist&quot;</span>, <span class="st">&quot;Driver&quot;</span>,<span class="st">&quot;ONMotT&quot;</span>,<span class="st">&quot;OMotT&quot;</span>,<span class="st">&quot;Other_Cyclist&quot;</span>,<span class="st">&quot;Pedestrian&quot;</span>,<span class="st">&quot;OMotNT&quot;</span>,<span class="st">&quot;Other_Pedestrian&quot;</span>,<span class="st">&quot;UOT&quot;</span>,<span class="st">&quot;UNM&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation SEATING_POSITION (var 5)</span>
df<span class="op">$</span>SEATING_POSITION =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>SEATING_POSITION, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Fourth_Seat_-_Left_Side&quot;</span>, <span class="st">&quot;Fourth_Seat_-_Right_Side&quot;</span> ,<span class="st">&quot;Front_Seat_-_Right_Side&quot;</span>,<span class="st">&quot;Non-Motorist&quot;</span>,<span class="st">&quot;Riding_on_Vehicle_Exterior&quot;</span>,<span class="st">&quot;Second_Seat_-_Middle&quot;</span>,<span class="st">&quot;Sleeper_Section_of_Cab_(Truck)&quot;</span>,<span class="st">&quot;Third_Seat_-_Middle&quot;</span>,<span class="st">&quot;Third_Seat_-_Right_Side&quot;</span>,<span class="st">&quot;Trailing_Unit&quot;</span>,<span class="st">&quot;Fourth_Seat_-_Middle&quot;</span>,<span class="st">&quot;Front_Seat_-_Left_Side_(Drivers_Side)&quot;</span>,<span class="st">&quot;Front_Seat_-_Other&quot;</span>,<span class="st">&quot;Front_Seat_-_Unknown&quot;</span>,<span class="st">&quot;Other_Passenger_in_enclosed_passenger_or_cargo_area&quot;</span>,<span class="st">&quot;Other_Passenger_in_unenclosed_passenger_or_cargo_area&quot;</span>,<span class="st">&quot;Second_Seat_-_Left_Side&quot;</span>,<span class="st">&quot;Second_Seat_-_Other&quot;</span>,<span class="st">&quot;Second_Seat_-_Unknown&quot;</span>,<span class="st">&quot;Third_Seat_-_Left_Side_(Drivers_Side)&quot;</span>,<span class="st">&quot;Third_Seat_-_Other&quot;</span>,<span class="st">&quot;Third_Seat_-_Unknown&quot;</span>,<span class="st">&quot;Unknown&quot;</span>,<span class="st">&quot;Front_Seat_-_Middle&quot;</span>,<span class="st">&quot;Other_Passenger_in_passenger_or_cargo_area_(unknown_whether_or_not_enclosed)&quot;</span>,<span class="st">&quot;Second_Seat_-_Right_Side&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;FoL&quot;</span>, <span class="st">&quot;FoR&quot;</span>,<span class="st">&quot;FrR&quot;</span>,<span class="st">&quot;NMot&quot;</span>,<span class="st">&quot;VE&quot;</span>,<span class="st">&quot;SM&quot;</span>,<span class="st">&quot;SlepCa&quot;</span>,<span class="st">&quot;TM&quot;</span>,<span class="st">&quot;TR&quot;</span>,<span class="st">&quot;TU&quot;</span>,<span class="st">&quot;FoM&quot;</span>,<span class="st">&quot;FL&quot;</span>, <span class="st">&quot;FO&quot;</span>,<span class="st">&quot;FU&quot;</span>,<span class="st">&quot;OEC&quot;</span>, <span class="st">&quot;OUC&quot;</span>,<span class="st">&quot;SL&quot;</span>,<span class="st">&quot;SO&quot;</span>,<span class="st">&quot;SU&quot;</span>, <span class="st">&quot;TL&quot;</span>,<span class="st">&quot;TO&quot;</span>,<span class="st">&quot;TU&quot;</span>,<span class="ot">NA</span>,<span class="st">&quot;FM&quot;</span>,<span class="st">&quot;OPC&quot;</span>,<span class="st">&quot;SR&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation RESTRAINT_SYSTEM.USE (var 6)</span>
df<span class="op">$</span>RESTRAINT_SYSTEM.USE =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RESTRAINT_SYSTEM.USE, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;None_Used/Not_Applicable&quot;</span>, <span class="st">&quot;Lap_and_Shoulder_Belt&quot;</span>, <span class="st">&quot;Motorcycle_Helmet&quot;</span>,<span class="st">&quot;Child_Safety_Seat&quot;</span>,<span class="st">&quot;Lap_Belt&quot;</span>,<span class="st">&quot;Unknown&quot;</span>,<span class="st">&quot;Helmets_Used_Improperly&quot;</span>,<span class="st">&quot;Restraint_Used_-_Type_Unknown&quot;</span>,<span class="st">&quot;Shoulder_Belt&quot;</span>,<span class="st">&quot;Bicycle_Helmet&quot;</span>,<span class="st">&quot;Child_Safety_Seat_Used_Improperly&quot;</span>,<span class="st">&quot;Safety_Belt_Used_Improperly&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NA&quot;</span>, <span class="st">&quot;LSB&quot;</span>,<span class="st">&quot;MH&quot;</span>,<span class="st">&quot;CHS&quot;</span>,<span class="st">&quot;LB&quot;</span>,<span class="ot">NA</span>,<span class="st">&quot;HUI&quot;</span>,<span class="st">&quot;RUTU&quot;</span>,<span class="st">&quot;SB&quot;</span>,<span class="st">&quot;BH&quot;</span>,<span class="st">&quot;CSSUI&quot;</span>,<span class="st">&quot;SBUI&quot;</span>),<span class="dt">warn_missing=</span>F)



<span class="co"># Preparation AIR_BAG_AVAILABILITY.DEPLOYMENT (var 7)</span>
df<span class="op">$</span>AIR_BAG_AVAILABILITY.DEPLOYMENT =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>AIR_BAG_AVAILABILITY.DEPLOYMENT, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Air_Bag_Available_but_Not_Deployed_for_this_Seat&quot;</span>, <span class="st">&quot;Deployed_Air_Bag_from_Front&quot;</span>, <span class="st">&quot;Air_Bag_Not_Available_for_this_Seat&quot;</span>,<span class="st">&quot;Non-Motorist&quot;</span>,<span class="st">&quot;Air_Bad_Available-Deployment_Not_Known_for_this_Seat&quot;</span>,<span class="st">&quot;Air_Bag_Available_and_Switched_Off&quot;</span>,<span class="st">&quot;Air_Bag_Previously_Deployed_and_not_Replaced&quot;</span>,<span class="st">&quot;Deployed_Air_Bag_Direction_Unknown&quot;</span>,<span class="st">&quot;Deployed_Air_Bag_Multiple_Directions&quot;</span>,<span class="st">&quot;Deployed_Air_Bag_from_Side&quot;</span>,<span class="st">&quot;Air_Bag_Disabled_or_Removed&quot;</span>,<span class="st">&quot;Deployed_Air_Bag_Other_Direction&quot;</span>,<span class="st">&quot;Unknown_(If_Airbag_Available)&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;Av_nD&quot;</span>, <span class="st">&quot;D_F&quot;</span>,<span class="st">&quot;NAv&quot;</span>,<span class="st">&quot;NM&quot;</span>,<span class="st">&quot;A_U&quot;</span>,<span class="st">&quot;A_SO&quot;</span>,<span class="st">&quot;A_PNR&quot;</span>,<span class="st">&quot;D_DU&quot;</span>,<span class="st">&quot;DA_MD&quot;</span>,<span class="st">&quot;DA_fs&quot;</span>,<span class="st">&quot;ADoR&quot;</span>,<span class="st">&quot;D_OD&quot;</span>,<span class="ot">NA</span>),<span class="dt">warn_missing=</span>F)


<span class="co"># Preparation EJECTION_PATH (var 9)</span>
df<span class="op">$</span>EJECTION_PATH =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>EJECTION_PATH, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Unknown&quot;</span>, <span class="st">&quot;Not_Ejected/Not_Applicable&quot;</span>, <span class="st">&quot;Through_Windshield&quot;</span>, <span class="st">&quot;Other_Path_(e.g._back_of_pickup)&quot;</span>, <span class="st">&quot;Through_Roof_Opening&quot;</span>, <span class="st">&quot;Through_Side_Door_Opening&quot;</span>, <span class="st">&quot;Through_Side_Window&quot;</span>, <span class="st">&quot;Through_Back_Window&quot;</span>, <span class="st">&quot;Through_Roof_(convertible_top_up)&quot;</span>, <span class="st">&quot;Through_Back_Door/Tailgate&quot;</span> ), <span class="dt">to =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="st">&quot;NoAp&quot;</span>, <span class="st">&quot;Wind&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Roof&quot;</span>, <span class="st">&quot;SideD&quot;</span>, <span class="st">&quot;SideW&quot;</span>,<span class="st">&quot;BackW&quot;</span>, <span class="st">&quot;RoofC&quot;</span>, <span class="st">&quot;BackD&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation NON_MOTORIST_LOCATION (var 11)</span>
df<span class="op">$</span>NON_MOTORIST_LOCATION =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>NON_MOTORIST_LOCATION, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Not_Applicable_-_Vehicle_Occupant&quot;</span>, <span class="st">&quot;Non-Intersection_-_On_Roadway_Crosswalk_not_Available&quot;</span>, <span class="st">&quot;Non-Intersection_-_On_Roadway_Crosswalk_Availability_Unknown&quot;</span>, <span class="st">&quot;Non-Intersection_-_On_Roadway_Not_in_Crosswalk&quot;</span>,<span class="st">&quot;Non-Intersection_-_On_Road_Shoulder&quot;</span>,<span class="st">&quot;Intersection_-_In_Crosswalk&quot;</span>,<span class="st">&quot;Intersection_-_On_Roadway_Crosswalk_Availability_Unknown&quot;</span>, <span class="st">&quot;Intersection_-_On_Roadway_Not_in_Crosswalk&quot;</span>,<span class="st">&quot;Non-Intersection_-_Other_Not_a_Roadway&quot;</span>, <span class="st">&quot;Intersection_-_On_Roadway_Crosswalk_not_Available&quot;</span>,<span class="st">&quot;Non-Intersection_-_Outside_Trafficway&quot;</span>, <span class="st">&quot;Intersection_-_Not_on_Roadway&quot;</span>,<span class="st">&quot;Unknown&quot;</span>, <span class="st">&quot;Non-Intersection_-_In_Crosswalk&quot;</span>, <span class="st">&quot;Intersection_-_Unknown&quot;</span>, <span class="st">&quot;Non-Intersection_-_Unknown&quot;</span>,<span class="st">&quot;Non-Intersection_-_In_Parking_Lane&quot;</span>, <span class="st">&quot;Non-Intersection_-_Bike_Path&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>,<span class="st">&quot;NIRCNA&quot;</span>,<span class="st">&quot;NIRCAU&quot;</span>,<span class="st">&quot;NIRNC&quot;</span>,<span class="st">&quot;NIRS&quot;</span>, <span class="st">&quot;IIC&quot;</span>,<span class="st">&quot;IRCAU&quot;</span>,<span class="st">&quot;IRNC&quot;</span>,<span class="st">&quot;NIONR&quot;</span>, <span class="st">&quot;IRCNA&quot;</span>, <span class="st">&quot;NIOT&quot;</span>, <span class="st">&quot;INR&quot;</span>, <span class="ot">NA</span>,<span class="st">&quot;NIC&quot;</span>,<span class="st">&quot;IU&quot;</span> ,<span class="st">&quot;NIU&quot;</span>,<span class="st">&quot;NIPL&quot;</span>, <span class="st">&quot;NIBP&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation POLICE_REPORTED_ALCOHOL_INVOLVEMENT (var 12)</span>
df<span class="op">$</span>POLICE_REPORTED_ALCOHOL_INVOLVEMENT =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>POLICE_REPORTED_ALCOHOL_INVOLVEMENT, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;No_(Alcohol_Not_Involved)&quot;</span>, <span class="st">&quot;Yes_(Alcohol_Involved)&quot;</span>, <span class="st">&quot;Not_reported Unknown_(Police_Reported)&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NO&quot;</span>,<span class="st">&quot;YES&quot;</span>, <span class="ot">NA</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation METHOD_ALCOHOL_DETERMINATION (var 13)</span>
df<span class="op">$</span>METHOD_ALCOHOL_DETERMINATION =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>METHOD_ALCOHOL_DETERMINATION, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Behavioral&quot;</span>, <span class="st">&quot;Evidential_Test_(Breath_Blood_Urine)&quot;</span>, <span class="st">&quot;Not_Reported&quot;</span>, <span class="st">&quot;Observed&quot;</span>,<span class="st">&quot;Other_(e.g._Saliva_test)&quot;</span>, <span class="st">&quot;Passive_Alcohol_Sensor_(PAS)&quot;</span>, <span class="st">&quot;Preliminary_Breath_Test_(PBT)&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;BV&quot;</span>,<span class="st">&quot;ET&quot;</span>,<span class="st">&quot;NOAp&quot;</span>, <span class="st">&quot;OBS&quot;</span>, <span class="st">&quot;OTHER&quot;</span>, <span class="st">&quot;PAS&quot;</span>, <span class="st">&quot;PBT&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation ALCOHOL_TEST_TYPE (var 14)</span>
df<span class="op">$</span>ALCOHOL_TEST_TYPE =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>ALCOHOL_TEST_TYPE, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Blood_Clot&quot;</span>, <span class="st">&quot;Blood_Plasma/Serum&quot;</span>, <span class="st">&quot;Breath_BAC&quot;</span>, <span class="st">&quot;Liver&quot;</span>, <span class="st">&quot;Not_Tested_for_Alcohol&quot;</span>, <span class="st">&quot;Other_Test_Type&quot;</span>, <span class="st">&quot;Unknown(Not_Reported_Since_2001)&quot;</span>, <span class="st">&quot;Urine&quot;</span>, <span class="st">&quot;Vitreous&quot;</span>, <span class="st">&quot;Whole_Blood&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;BC&quot;</span>,<span class="st">&quot;BPS&quot;</span>,<span class="st">&quot;BB&quot;</span>, <span class="st">&quot;L&quot;</span>, <span class="st">&quot;NoT&quot;</span>, <span class="st">&quot;OTHER&quot;</span>, <span class="ot">NA</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;V&quot;</span>, <span class="st">&quot;WB&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation POLICE.REPORTED_DRUG_INVOLVEMENT (var 16)</span>
df<span class="op">$</span>POLICE.REPORTED_DRUG_INVOLVEMENT =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>POLICE.REPORTED_DRUG_INVOLVEMENT, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Drugs_Involved&quot;</span>, <span class="st">&quot;No_Drugs&quot;</span>, <span class="st">&quot;Not_Reported&quot;</span>, <span class="st">&quot;Reported_Unknown&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>,<span class="st">&quot;NoRep&quot;</span>,<span class="ot">NA</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation METHOD_OF_DRUG_DETERMINATION (var 17)</span>
df<span class="op">$</span>METHOD_OF_DRUG_DETERMINATION =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>METHOD_OF_DRUG_DETERMINATION, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Behavioral&quot;</span>, <span class="st">&quot;Drug_Recognition_Technician_(DRT)&quot;</span>, <span class="st">&quot;Evidential_Test_(Blood_Urine)&quot;</span>, <span class="st">&quot;Not_Reported&quot;</span>, <span class="st">&quot;Other&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;DRT&quot;</span>, <span class="st">&quot;ET&quot;</span>, <span class="st">&quot;NoRep&quot;</span>,<span class="st">&quot;Other&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation DRUG_TEST_TYPE (var 18)</span>
df<span class="op">$</span>DRUG_TEST_TYPE =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>DRUG_TEST_TYPE, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Blood_Test&quot;</span>, <span class="st">&quot;Both:_Blood_and_Urine_(Since_1993)&quot;</span>, <span class="st">&quot;Not_Tested_for_Drugs&quot;</span>, <span class="st">&quot;Other_Type_Test&quot;</span>, <span class="st">&quot;Unknown_if_Tested_for_Drugs&quot;</span>, <span class="st">&quot;Unknown_Test_Type&quot;</span>, <span class="st">&quot;Urine_Test&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;Btest&quot;</span>, <span class="st">&quot;BUtest&quot;</span>, <span class="st">&quot;no_test&quot;</span>, <span class="st">&quot;Xtest&quot;</span>,<span class="ot">NA</span>,<span class="st">&quot;Xtest&quot;</span>,<span class="st">&quot;Utest&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation DRUG_TEST_TYPE_.2_of_3. (var 20)</span>
df<span class="op">$</span>DRUG_TEST_TYPE_.2_of_<span class="dv">3</span>. =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>DRUG_TEST_TYPE_.2_of_<span class="dv">3</span>., <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Blood_Test&quot;</span>, <span class="st">&quot;Both:_Blood_and_Urine_(Since_1993)&quot;</span>, <span class="st">&quot;Not_Tested_for_Drugs&quot;</span>,<span class="st">&quot;Other_Type_Test&quot;</span>,<span class="st">&quot;Unknown_if_Tested_for_Drugs&quot;</span>,<span class="st">&quot;Unknown_Test_Type&quot;</span>,<span class="st">&quot;Urine_Test&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;Btest&quot;</span>, <span class="st">&quot;BUtest&quot;</span>,<span class="st">&quot;no_test&quot;</span>,<span class="st">&quot;Xtest&quot;</span>,<span class="ot">NA</span>,<span class="st">&quot;Xtest&quot;</span>,<span class="st">&quot;Utest&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation DRUG_TEST_TYPE_.3_of_3. (var 22)</span>

df<span class="op">$</span>DRUG_TEST_TYPE_.3_of_<span class="dv">3</span>. =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>DRUG_TEST_TYPE_.3_of_<span class="dv">3</span>., <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Blood_Test&quot;</span>, <span class="st">&quot;Both:_Blood_and_Urine_(Since_1993)&quot;</span>, <span class="st">&quot;Not_Tested_for_Drugs&quot;</span>,<span class="st">&quot;Other_Type_Test&quot;</span>,<span class="st">&quot;Unknown_if_Tested_for_Drugs&quot;</span>,<span class="st">&quot;Unknown_Test_Type&quot;</span>,<span class="st">&quot;Urine_Test&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;Btest&quot;</span>, <span class="st">&quot;BUtest&quot;</span>,<span class="st">&quot;no_test&quot;</span>,<span class="st">&quot;Xtest&quot;</span>,<span class="ot">NA</span>,<span class="st">&quot;Xtest&quot;</span>,<span class="st">&quot;Utest&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation HISPANIC_ORIGIN (var 24)</span>
df<span class="op">$</span>HISPANIC_ORIGIN =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>HISPANIC_ORIGIN, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Central_or_South_American&quot;</span>, <span class="st">&quot;Hispanic_-_Origin_Not_Specified_or_Other_Origin&quot;</span>, <span class="st">&quot;Not_a_Fatality_(Not_Applicable)&quot;</span>,<span class="st">&quot;Cuban&quot;</span>,<span class="st">&quot;Mexican&quot;</span>,<span class="st">&quot;Puerto_Rican&quot;</span>,<span class="st">&quot;European_Spanish&quot;</span>,<span class="st">&quot;Non-Hispanic&quot;</span>,<span class="st">&quot;Unknown&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;CeSouAme&quot;</span>, <span class="st">&quot;Hisp - Unknown&quot;</span>,<span class="ot">NA</span>,<span class="st">&quot;Cuban&quot;</span>,<span class="st">&quot;Mexican&quot;</span>,<span class="st">&quot;Puerto_Rican&quot;</span>,<span class="st">&quot;European_Spanish&quot;</span>,<span class="st">&quot;Non-Hispanic&quot;</span>,<span class="ot">NA</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation RELATED_FACTOR_.1. (var 26)</span>
df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>. =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>., <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Not_Applicable_-_Driver/None_-_All_Other_Persons&quot;</span>, <span class="st">&quot;Walking/Riding_with_or_Against_Traffic_Playing_Working_Sitting_Lying_Standing_etc._in_Roadway&quot;</span>, <span class="st">&quot;Improper_Crossing_or_Roadway_or_Intersection&quot;</span>, <span class="st">&quot;Unknown&quot;</span>, <span class="st">&quot;Darting_Stumbling_or_Running_into_Road&quot;</span>,<span class="st">&quot;Other_Physical_Impairment&quot;</span>, <span class="st">&quot;Non-Motorist_Pushing_a_Vehicle&quot;</span>, <span class="st">&quot;Opening_Vehicle_Closure_into_Moving_Traffic_or_While_Vehicle_is_in_Motion&quot;</span>, <span class="st">&quot;Failure_to_Yield_Right_of_Way&quot;</span>, <span class="st">&quot;Locked_Wheel&quot;</span>, <span class="st">&quot;Not_Visible&quot;</span>, <span class="st">&quot;Traveling_on_Prohibited_Trafficway&quot;</span>, <span class="st">&quot;Failure_to_Obey_Traffic_Signs_Traffic_Control_Devices_or_Traffic_Officers_Failure_to_Observe_Safety_Zone_Traffic_Laws&quot;</span>,<span class="st">&quot;Impaired_Due_to_Previous_Injury&quot;</span>,<span class="st">&quot;Emotional_(e.g._Depression_Angry_Disputed)&quot;</span>, <span class="st">&quot;Inattentive_(talking_Eating_etc)&quot;</span>, <span class="st">&quot;Failure_to_Keep_in_Proper_Lane&quot;</span>, <span class="st">&quot;Improper_or_Erratic_Lane_Changing&quot;</span>,<span class="st">&quot;Blind&quot;</span>, <span class="st">&quot;Restricted_to_Wheelchair&quot;</span>, <span class="st">&quot;Mother_of_Dead_Fetus&quot;</span>, <span class="st">&quot;Interfering_with_Driver&quot;</span>, <span class="st">&quot;Driving_on_Wrong_Side_of_Road&quot;</span>,<span class="st">&quot;Making_Improper_Turn&quot;</span>, <span class="st">&quot;Getting_Off/Out_of_or_On/In_to_Moving_Transport_Vehicle&quot;</span>, <span class="st">&quot;Operating_without_Required_Equipment&quot;</span>, <span class="st">&quot;Walking_With_Cane_or_Crutches&quot;</span>, <span class="st">&quot;Passing_with_Insufficient_Distance_or_Inadequate_Visibility_or_Failing_to_Yield_to_Overtaking_Vehicle&quot;</span>,<span class="st">&quot;Getting_Off/Out_of_or_On/In_to_Non-Moving_Transport_Vehicle&quot;</span>, <span class="st">&quot;Failing_to_Dim_Lights_or_Have_Lights_on_When_Required&quot;</span>, <span class="st">&quot;Construction/Maintenance/Utility_Worker&quot;</span>, <span class="st">&quot;Operating_the_Vehicle_in_Other_Erratic_Reckless_Careless_or_Negligent_Manner_[or_Operating_at_Erratic_or_Suddenly_Changing_Speeds&quot;</span>, <span class="st">&quot;Motorized_Wheelchair_Rider&quot;</span>, <span class="st">&quot;Passed_OutBlackout&quot;</span>, <span class="st">&quot;Illegal_Driving_on_Road_Shoulder_in_Ditch_on_Sidewalk_on_Median&quot;</span>, <span class="st">&quot;Mentally_Challenged&quot;</span>, <span class="st">&quot;Pedestrian_NON-MOTOR_VEHICLE_OPERATOR_RELATED_FACTORS:&quot;</span>, <span class="st">&quot;Vision_obscured_by_overcorrecting&quot;</span>, <span class="st">&quot;Operator_Inexperience&quot;</span>, <span class="st">&quot;Making_Improper_Entry_to_or_Exit_from_Trafficway&quot;</span>, <span class="st">&quot;Motor_Vehicle_(including_load)&quot;</span>, <span class="st">&quot;Following_Improperly&quot;</span>, <span class="st">&quot;Passing_on_Wrong_Side&quot;</span>,<span class="st">&quot;Head_Restraints_AVOIDING_SWERVING_OR_SLIDING_DUE_TO&quot;</span>, <span class="st">&quot;Slippery_or_Loose_Surface&quot;</span>), 
                                  <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>,<span class="st">&quot;F01&quot;</span>, <span class="st">&quot;F02&quot;</span>, <span class="st">&quot;F03&quot;</span>,<span class="ot">NA</span>,<span class="st">&quot;F04&quot;</span>,<span class="st">&quot;F05&quot;</span>, <span class="st">&quot;F06&quot;</span>,<span class="st">&quot;F07&quot;</span>,<span class="st">&quot;F08&quot;</span>, <span class="st">&quot;F09&quot;</span>, <span class="st">&quot;F10&quot;</span>, <span class="st">&quot;F11&quot;</span>, <span class="st">&quot;F12&quot;</span>, <span class="st">&quot;F13&quot;</span>,<span class="st">&quot;F14&quot;</span>,<span class="st">&quot;F15&quot;</span>,<span class="st">&quot;F16&quot;</span>,<span class="st">&quot;F17&quot;</span>,<span class="st">&quot;F18&quot;</span>,<span class="st">&quot;F19&quot;</span>,<span class="st">&quot;F20&quot;</span>,<span class="st">&quot;F21&quot;</span>, <span class="st">&quot;F22&quot;</span>, <span class="st">&quot;F23&quot;</span>,<span class="st">&quot;F24&quot;</span>,<span class="st">&quot;F25&quot;</span>, <span class="st">&quot;F26&quot;</span>,<span class="st">&quot;F27&quot;</span>,<span class="st">&quot;F28&quot;</span>,<span class="st">&quot;F29&quot;</span>,<span class="st">&quot;F30&quot;</span>,<span class="st">&quot;F31&quot;</span>, <span class="st">&quot;F32&quot;</span>, <span class="st">&quot;F33&quot;</span>,<span class="st">&quot;F34&quot;</span>,<span class="st">&quot;F35&quot;</span>,<span class="st">&quot;F36&quot;</span>,<span class="st">&quot;F37&quot;</span>,<span class="st">&quot;F38&quot;</span>,<span class="st">&quot;F39&quot;</span>,<span class="st">&quot;F40&quot;</span>,<span class="st">&quot;F41&quot;</span>,<span class="st">&quot;F42&quot;</span>, <span class="st">&quot;F43&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation RELATED_FACTOR_.2. (var 27)</span>
df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>. =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Not_Applicable_-_Driver/None_-_All_Other_Persons&quot;</span>, <span class="st">&quot;Walking/Riding_with_or_Against_Traffic_Playing_Working_Sitting_Lying_Standing_etc._in_Roadway&quot;</span>, <span class="st">&quot;Improper_Crossing_or_Roadway_or_Intersection&quot;</span>, <span class="st">&quot;Unknown&quot;</span>, <span class="st">&quot;Darting_Stumbling_or_Running_into_Road&quot;</span>,<span class="st">&quot;Other_Physical_Impairment&quot;</span>, <span class="st">&quot;Non-Motorist_Pushing_a_Vehicle&quot;</span>, <span class="st">&quot;Opening_Vehicle_Closure_into_Moving_Traffic_or_While_Vehicle_is_in_Motion&quot;</span>, <span class="st">&quot;Failure_to_Yield_Right_of_Way&quot;</span>, <span class="st">&quot;Not_Visible&quot;</span>, <span class="st">&quot;Traveling_on_Prohibited_Trafficway&quot;</span>, <span class="st">&quot;Failure_to_Obey_Traffic_Signs_Traffic_Control_Devices_or_Traffic_Officers_Failure_to_Observe_Safety_Zone_Traffic_Laws&quot;</span>,<span class="st">&quot;Impaired_Due_to_Previous_Injury&quot;</span>,<span class="st">&quot;Emotional_(e.g._Depression_Angry_Disputed)&quot;</span>, <span class="st">&quot;Inattentive_(talking_Eating_etc)&quot;</span>, <span class="st">&quot;Failure_to_Keep_in_Proper_Lane&quot;</span>, <span class="st">&quot;Improper_or_Erratic_Lane_Changing&quot;</span>,<span class="st">&quot;Blind&quot;</span>, <span class="st">&quot;Restricted_to_Wheelchair&quot;</span>, <span class="st">&quot;Mother_of_Dead_Fetus&quot;</span>, <span class="st">&quot;Interfering_with_Driver&quot;</span>, <span class="st">&quot;Driving_on_Wrong_Side_of_Road&quot;</span>,<span class="st">&quot;Making_Improper_Turn&quot;</span>, <span class="st">&quot;Getting_Off/Out_of_or_On/In_to_Moving_Transport_Vehicle&quot;</span>, <span class="st">&quot;Operating_without_Required_Equipment&quot;</span>, <span class="st">&quot;Walking_With_Cane_or_Crutches&quot;</span>, <span class="st">&quot;Getting_Off/Out_of_or_On/In_to_Non-Moving_Transport_Vehicle&quot;</span>, <span class="st">&quot;Failing_to_Dim_Lights_or_Have_Lights_on_When_Required&quot;</span>, <span class="st">&quot;Construction/Maintenance/Utility_Worker&quot;</span>, <span class="st">&quot;Operating_the_Vehicle_in_Other_Erratic_Reckless_Careless_or_Negligent_Manner_[or_Operating_at_Erratic_or_Suddenly_Changing_Speeds&quot;</span>, <span class="st">&quot;Motorized_Wheelchair_Rider&quot;</span>, <span class="st">&quot;Passed_OutBlackout&quot;</span>, <span class="st">&quot;Mentally_Challenged&quot;</span>, <span class="st">&quot;Pedestrian_NON-MOTOR_VEHICLE_OPERATOR_RELATED_FACTORS:&quot;</span>, <span class="st">&quot;Making_Improper_Entry_to_or_Exit_from_Trafficway&quot;</span>, <span class="st">&quot;Motor_Vehicle_(including_load)&quot;</span>, <span class="st">&quot;Following_Improperly&quot;</span>,<span class="st">&quot;Head_Restraints_AVOIDING_SWERVING_OR_SLIDING_DUE_TO&quot;</span>,  <span class="st">&quot;Reflected_Glare_Bright_Sunlight_Headlights&quot;</span>,<span class="st">&quot;Failure_to_Observe_Warnings_or_Instructions_on_Vehicles_Displaying_Them&quot;</span>, <span class="st">&quot;Driving_too_Fast_for_Conditions_or_in_Excess_of_Posted_Speed_Limit&quot;</span>, <span class="st">&quot;Parked_Vehicle&quot;</span>, <span class="st">&quot;Trees_Crops_Vegetation&quot;</span>, <span class="st">&quot;Vehicle_in_Road&quot;</span>, <span class="st">&quot;Rain_Snow_Fog_Smoke_Sand_Dust&quot;</span>, <span class="st">&quot;Curve_Hill_Or_Other_Design_Features_(including_Traffic_signs_Embankment)&quot;</span>, <span class="st">&quot;Animals_in_Road&quot;</span>, <span class="st">&quot;Ruts_Holes_Bumps_in_Road&quot;</span>), 
                                  <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp2&quot;</span>,<span class="st">&quot;E01&quot;</span>, <span class="st">&quot;E02&quot;</span>,<span class="ot">NA</span>, <span class="st">&quot;E03&quot;</span>,<span class="st">&quot;E04&quot;</span>,<span class="st">&quot;E05&quot;</span>,<span class="st">&quot;E06&quot;</span>,<span class="st">&quot;E07&quot;</span>,<span class="st">&quot;E09&quot;</span>,<span class="st">&quot;E10&quot;</span>,<span class="st">&quot;E11&quot;</span>, <span class="st">&quot;E12&quot;</span>, <span class="st">&quot;E13&quot;</span>,<span class="st">&quot;E14&quot;</span>,<span class="st">&quot;E15&quot;</span>,<span class="st">&quot;E16&quot;</span>,<span class="st">&quot;E17&quot;</span>,<span class="st">&quot;E18&quot;</span>,<span class="st">&quot;E19&quot;</span>,<span class="st">&quot;E20&quot;</span>,<span class="st">&quot;E21&quot;</span>, <span class="st">&quot;E22&quot;</span>, <span class="st">&quot;E23&quot;</span>,<span class="st">&quot;E24&quot;</span>,<span class="st">&quot;E25&quot;</span>,<span class="st">&quot;E27&quot;</span>,<span class="st">&quot;E28&quot;</span>,<span class="st">&quot;E29&quot;</span>,<span class="st">&quot;E30&quot;</span>,<span class="st">&quot;E31&quot;</span>, <span class="st">&quot;E32&quot;</span>, <span class="st">&quot;E34&quot;</span>,<span class="st">&quot;E35&quot;</span>,<span class="st">&quot;E38&quot;</span>,<span class="st">&quot;E39&quot;</span>,<span class="st">&quot;E40&quot;</span>,<span class="st">&quot;E42&quot;</span>, <span class="st">&quot;E44&quot;</span>,<span class="st">&quot;E45&quot;</span>, <span class="st">&quot;E46&quot;</span>,<span class="st">&quot;E47&quot;</span>,<span class="st">&quot;E48&quot;</span>,<span class="st">&quot;E49&quot;</span>,<span class="st">&quot;E50&quot;</span>,<span class="st">&quot;E51&quot;</span>,<span class="st">&quot;E52&quot;</span>,<span class="st">&quot;E53&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation RELATED_FACTOR_.3. (var 28)</span>
df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>. =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>., <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Not_Applicable_-_Driver/None_-_All_Other_Persons&quot;</span>, <span class="st">&quot;Walking/Riding_with_or_Against_Traffic_Playing_Working_Sitting_Lying_Standing_etc._in_Roadway&quot;</span>, <span class="st">&quot;Improper_Crossing_or_Roadway_or_Intersection&quot;</span>, <span class="st">&quot;Unknown&quot;</span>, <span class="st">&quot;Darting_Stumbling_or_Running_into_Road&quot;</span>,<span class="st">&quot;Other_Physical_Impairment&quot;</span>, <span class="st">&quot;Non-Motorist_Pushing_a_Vehicle&quot;</span>,  <span class="st">&quot;Failure_to_Yield_Right_of_Way&quot;</span>, <span class="st">&quot;Not_Visible&quot;</span>, <span class="st">&quot;Traveling_on_Prohibited_Trafficway&quot;</span>, <span class="st">&quot;Failure_to_Obey_Traffic_Signs_Traffic_Control_Devices_or_Traffic_Officers_Failure_to_Observe_Safety_Zone_Traffic_Laws&quot;</span>,<span class="st">&quot;Impaired_Due_to_Previous_Injury&quot;</span>,<span class="st">&quot;Emotional_(e.g._Depression_Angry_Disputed)&quot;</span>, <span class="st">&quot;Inattentive_(talking_Eating_etc)&quot;</span>, <span class="st">&quot;Failure_to_Keep_in_Proper_Lane&quot;</span>, <span class="st">&quot;Improper_or_Erratic_Lane_Changing&quot;</span>,<span class="st">&quot;Blind&quot;</span>, <span class="st">&quot;Restricted_to_Wheelchair&quot;</span>, <span class="st">&quot;Driving_on_Wrong_Side_of_Road&quot;</span>,<span class="st">&quot;Making_Improper_Turn&quot;</span>, <span class="st">&quot;Getting_Off/Out_of_or_On/In_to_Moving_Transport_Vehicle&quot;</span>, <span class="st">&quot;Operating_without_Required_Equipment&quot;</span>, <span class="st">&quot;Walking_With_Cane_or_Crutches&quot;</span>, <span class="st">&quot;Getting_Off/Out_of_or_On/In_to_Non-Moving_Transport_Vehicle&quot;</span>,  <span class="st">&quot;Passed_OutBlackout&quot;</span>, <span class="st">&quot;Mentally_Challenged&quot;</span>, <span class="st">&quot;Pedestrian_NON-MOTOR_VEHICLE_OPERATOR_RELATED_FACTORS:&quot;</span>, <span class="st">&quot;Motor_Vehicle_(including_load)&quot;</span>,  <span class="st">&quot;Reflected_Glare_Bright_Sunlight_Headlights&quot;</span>,<span class="st">&quot;Driving_too_Fast_for_Conditions_or_in_Excess_of_Posted_Speed_Limit&quot;</span>, <span class="st">&quot;Parked_Vehicle&quot;</span>,  <span class="st">&quot;Rain_Snow_Fog_Smoke_Sand_Dust&quot;</span>, <span class="st">&quot;Building_Billboard_or_Other_Structures&quot;</span>), 
                                  <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp3&quot;</span>,<span class="st">&quot;G01&quot;</span>, <span class="st">&quot;G02&quot;</span>,<span class="ot">NA</span>, <span class="st">&quot;G03&quot;</span>,<span class="st">&quot;G04&quot;</span>,<span class="st">&quot;G05&quot;</span>,<span class="st">&quot;G07&quot;</span>,<span class="st">&quot;G09&quot;</span>,<span class="st">&quot;G10&quot;</span>,<span class="st">&quot;G11&quot;</span>, <span class="st">&quot;G12&quot;</span>, <span class="st">&quot;G13&quot;</span>,<span class="st">&quot;G14&quot;</span>,<span class="st">&quot;G15&quot;</span>,<span class="st">&quot;G16&quot;</span>,<span class="st">&quot;G17&quot;</span>,<span class="st">&quot;G18&quot;</span>,<span class="st">&quot;G21&quot;</span>, <span class="st">&quot;G22&quot;</span>, <span class="st">&quot;G23&quot;</span>,<span class="st">&quot;G24&quot;</span>,<span class="st">&quot;G25&quot;</span>,<span class="st">&quot;G27&quot;</span>,<span class="st">&quot;G32&quot;</span>, <span class="st">&quot;G34&quot;</span>,<span class="st">&quot;G35&quot;</span>,<span class="st">&quot;G39&quot;</span>, <span class="st">&quot;G44&quot;</span>, <span class="st">&quot;G46&quot;</span>,<span class="st">&quot;G47&quot;</span>,<span class="st">&quot;G50&quot;</span>,<span class="st">&quot;G54&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Preparation RACE (var 29)</span>
df<span class="op">$</span>RACE =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RACE, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;White&quot;</span>, <span class="st">&quot;Black&quot;</span>, <span class="st">&quot;Not_a_Fatality_(Not_Applicable)&quot;</span>, <span class="st">&quot;Unknown&quot;</span>, <span class="st">&quot;American_Indian_(_Includes_Aleuts_and_Eskimos)&quot;</span>, <span class="st">&quot;Filipino&quot;</span>, <span class="st">&quot;Other_Asian_or_Pacific_Islander&quot;</span>, <span class="st">&quot;All_Other_Races&quot;</span>, <span class="st">&quot;Asian_or_Pacific_Islander_No_Specific_(Individual)_Race&quot;</span>, <span class="st">&quot;Chinese&quot;</span>, <span class="st">&quot;Asian_Indian&quot;</span>, <span class="st">&quot;Vietnamese&quot;</span>, <span class="st">&quot;Korean&quot;</span>, <span class="st">&quot;Other_Indian_(Includes_South_and_Central_America)&quot;</span>, <span class="st">&quot;Multiple_Races_(Individual_races_not_specified;_ex._mixed)&quot;</span>, <span class="st">&quot;Japanese&quot;</span>, <span class="st">&quot;Hawaiian_(Includes_part-Hawaiian)&quot;</span>, <span class="st">&quot;Samoan&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;W&quot;</span>, <span class="st">&quot;B&quot;</span>,<span class="st">&quot;NoAp&quot;</span>, <span class="ot">NA</span>,<span class="st">&quot;AmI&quot;</span>, <span class="st">&quot;Fil&quot;</span>, <span class="st">&quot;OAsian&quot;</span>,<span class="ot">NA</span>,<span class="st">&quot;AsianPac&quot;</span>, <span class="st">&quot;Chi&quot;</span>, <span class="st">&quot;AsianInd&quot;</span>, <span class="st">&quot;Viet&quot;</span>, <span class="st">&quot;Kor&quot;</span>, <span class="st">&quot;OInd&quot;</span>, <span class="st">&quot;MRace&quot;</span>, <span class="st">&quot;Jap&quot;</span>, <span class="st">&quot;Haw&quot;</span>, <span class="st">&quot;Samoa&quot;</span>),<span class="dt">warn_missing=</span>F)</code></pre></div>
<hr />
</div>
<div id="analisis-individual-de-variables" class="section level2">
<h2><span class="header-section-number">2.3</span> Análisis individual de variables</h2>
<div id="analisis-case_state" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Análisis <code>CASE_STATE</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Obtenemos la información resumen</span>
<span class="kw">summary</span>(df<span class="op">$</span>CASE_STATE)</code></pre></div>
<pre><code>##              Alabama               Alaska              Arizona 
##                 2271                  208                 2875 
##             Arkansas           California             Colorado 
##                 1421                10151                 1766 
##          Connecticut             Delaware District_of_Columbia 
##                  696                  337                  200 
##              Florida              Georgia               Hawaii 
##                 7738                 4030                  333 
##                Idaho             Illinois              Indiana 
##                  660                 3407                 2089 
##                 Iowa               Kansas             Kentucky 
##                 1017                 1053                 1914 
##            Louisiana                Maine             Maryland 
##                 2249                  454                 1538 
##        Massachusetts             Michigan            Minnesota 
##                 1051                 3280                 1364 
##          Mississippi             Missouri              Montana 
##                 1629                 2495                  473 
##             Nebraska               Nevada        New_Hampshire 
##                  633                  818                  322 
##           New_Jersey           New_Mexico             New_York 
##                 1835                 1122                 3765 
##       North_Carolina         North_Dakota                 Ohio 
##                 3607                  208                 3144 
##             Oklahoma               Oregon         Pennsylvania 
##                 1573                 1111                 3558 
##         Rhode_Island       South_Carolina         South_Dakota 
##                  207                 2362                  403 
##            Tennessee                Texas                 Utah 
##                 2859                 9231                  735 
##              Vermont             Virginia           Washington 
##                  190                 2101                 1552 
##        West_Virginia            Wisconsin              Wyoming 
##                  862                 1679                  392</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(df<span class="op">$</span>CASE_STATE)</code></pre></div>
<pre><code>##  [1] Alabama              Alaska               Arizona             
##  [4] Arkansas             California           Colorado            
##  [7] Connecticut          Delaware             District_of_Columbia
## [10] Florida              Georgia              Hawaii              
## [13] Idaho                Illinois             Indiana             
## [16] Iowa                 Kansas               Kentucky            
## [19] Louisiana            Maine                Maryland            
## [22] Massachusetts        Michigan             Minnesota           
## [25] Mississippi          Missouri             Montana             
## [28] Nebraska             Nevada               New_Hampshire       
## [31] New_Jersey           New_Mexico           New_York            
## [34] North_Carolina       North_Dakota         Ohio                
## [37] Oklahoma             Oregon               Pennsylvania        
## [40] Rhode_Island         South_Carolina       South_Dakota        
## [43] Tennessee            Texas                Utah                
## [46] Vermont              Virginia             Washington          
## [49] West_Virginia        Wisconsin            Wyoming             
## 51 Levels: Alabama Alaska Arizona Arkansas California ... Wyoming</code></pre>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-6-1.png" width="1440" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Estados con mayor y menor número de supervivientes</span>
result1 =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(CASE_STATE,INJURY_SEVERITY) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(INJURY_SEVERITY<span class="op">==</span><span class="st">&quot;Died&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(CASE_STATE) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">n=</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(n))
<span class="kw">summary</span>(result1)</code></pre></div>
<pre><code>##       CASE_STATE       n         
##  Alabama   : 1   Min.   :  68.0  
##  Alaska    : 1   1st Qu.: 252.5  
##  Arizona   : 1   Median : 649.0  
##  Arkansas  : 1   Mean   : 826.0  
##  California: 1   3rd Qu.:1054.0  
##  Colorado  : 1   Max.   :3957.0  
##  (Other)   :45</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">*****************************************</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre></div>
<pre><code>## 
## *****************************************</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Estado con mayor y menor número de supervivientes</span>
result2=df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(CASE_STATE,INJURY_SEVERITY) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(INJURY_SEVERITY<span class="op">==</span><span class="st">&quot;Survived&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(CASE_STATE) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">n=</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(n))
<span class="kw">summary</span>(result2)</code></pre></div>
<pre><code>##       CASE_STATE       n       
##  Alabama   : 1   Min.   :  98  
##  Alaska    : 1   1st Qu.: 381  
##  Arizona   : 1   Median : 845  
##  Arkansas  : 1   Mean   :1130  
##  California: 1   3rd Qu.:1334  
##  Colorado  : 1   Max.   :6031  
##  (Other)   :45</code></pre>
<p>Estados con mayor tasa de mortalidad: California, Texas y Florida y con menor: Distrito de Colombia, Rhode_Island y Alaska Estados con mayor accidentes de que produce baja injury: California, Texas y New York y con menor: Vermont, North_Dakota, Wyoming</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>CASE_STATE)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$CASE_STATE
## X-squared = 248.78, df = 50, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z=<span class="kw">table</span>(df<span class="op">$</span>CASE_STATE,df<span class="op">$</span>INJURY_SEVERITY)
porcentajes=z[,<span class="dv">2</span>]<span class="op">/</span><span class="kw">apply</span>(z,<span class="dv">1</span>,sum)
<span class="kw">sort</span>(porcentajes)</code></pre></div>
<pre><code>##         North_Dakota              Montana              Vermont 
##            0.4951923            0.5085470            0.5157895 
##          Mississippi              Wyoming               Kansas 
##            0.5187231            0.5230769            0.5304183 
##        New_Hampshire        Massachusetts            Wisconsin 
##            0.5387097            0.5404624            0.5427376 
##           New_Jersey               Hawaii         Pennsylvania 
##            0.5444580            0.5454545            0.5458321 
##          Connecticut       South_Carolina             Virginia 
##            0.5458515            0.5491699            0.5536993 
##             Missouri                 Ohio             Kentucky 
##            0.5567218            0.5574823            0.5578231 
##               Oregon            Tennessee                 Iowa 
##            0.5583710            0.5602812            0.5604720 
##              Alabama        West_Virginia              Indiana 
##            0.5617284            0.5632985            0.5646552 
##             Maryland             Arkansas             Oklahoma 
##            0.5663601            0.5691114            0.5702479 
##       North_Carolina            Louisiana         South_Dakota 
##            0.5725063            0.5739169            0.5756824 
##                Maine             Colorado            Minnesota 
##            0.5770925            0.5787064            0.5798817 
##           New_Mexico           Washington               Alaska 
##            0.5802357            0.5812903            0.5833333 
##             New_York             Illinois                Texas 
##            0.5836022            0.5843126            0.5914427 
##             Michigan             Delaware              Georgia 
##            0.5923880            0.5952381            0.5963509 
##                 Utah           California                Idaho 
##            0.6016371            0.6038246            0.6075758 
##         Rhode_Island              Florida             Nebraska 
##            0.6086957            0.6100751            0.6113744 
##               Nevada              Arizona District_of_Columbia 
##            0.6135802            0.6192377            0.6344086</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(porcentajes)</code></pre></div>
<p><img src="FARS18052_files/figure-html/case_state_analisis_-1.png" width="672" /></p>
<hr />
</div>
<div id="analisis-age" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Análisis <code>AGE</code></h3>
<p>Esta variable identifica la edad de la persona en el momento del accidente en años. En particular puede tomar los siguientes valores enteros:</p>
<pre><code>##  [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22
## [24] 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45
## [47] 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68
## [70] 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91
## [93] 92 93 94 95 96 97 99</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Obteniendo medidas resumen de variable en cuestión</span>
<span class="kw">summary</span>(df<span class="op">$</span>AGE)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    0.00   20.00   32.00   37.11   49.00   99.00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(INJURY_SEVERITY,AGE) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/2analisis_age-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>AGE, <span class="dt">colour=</span>SEX)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_density</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Relation age with injury&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/2analisis_age-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Comparación con otras variables</span>

<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>AGE, <span class="dt">colour=</span>ALCOHOL_TEST_RESULT)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_density</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Comparative AGE with ALCOHOL TEST RESULT&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/2analisis_age-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Todos los usuarios con sexo desconocido tienen edad 99 años, lo cual implica que seguramente sean valores faltantes</span>
<span class="kw">quantile</span>(df[df<span class="op">$</span>SEX<span class="op">==</span><span class="st">&#39;Unknown&#39;</span>,]<span class="op">$</span>AGE , <span class="kw">c</span>(.<span class="dv">01</span>)) </code></pre></div>
<pre><code>##    1% 
## 14.54</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(df[df<span class="op">$</span>SEX<span class="op">==</span><span class="st">&#39;Unknown&#39;</span>,]<span class="op">$</span>AGE)</code></pre></div>
<pre><code>## df[df$SEX == &quot;Unknown&quot;, ]$AGE 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##     1655        0       26    0.062    97.39    3.172       99       99 
##      .25      .50      .75      .90      .95 
##       99       99       99       99       99 
## 
## lowest :  0  1  2  3  4, highest: 51 52 61 86 99</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(df[fars<span class="op">$</span>INJURY_SEVERITY<span class="op">==</span><span class="st">&#39;Unknown&#39;</span>,]<span class="op">$</span>AGE)</code></pre></div>
<pre><code>## df[fars$INJURY_SEVERITY == &quot;Unknown&quot;, ]$AGE 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      901        0       56    0.428    86.92    20.58       19       28 
##      .25      .50      .75      .90      .95 
##       99       99       99       99       99 
## 
## lowest :  0  1  2  3  4, highest: 67 74 75 90 99</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># El 84% de las filas con edad 99 tienen la variable INJURI_SEVERITY a Unknown</span>
<span class="kw">quantile</span>(df[fars<span class="op">$</span>INJURY_SEVERITY<span class="op">==</span><span class="st">&#39;Unknown&#39;</span>,]<span class="op">$</span>AGE , <span class="fl">0.16</span>) </code></pre></div>
<pre><code>## 16% 
##  56</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Posibles filas con valores desconocidos (comentado)</span>
<span class="co">#df[df$SEX==&#39;Unknown&#39; &amp; df$AGE==99 &amp; df$INJURY_SEVERITY==NA,]</span>

<span class="co"># Consideramos que todos los que tienen edad 99 son NA</span>
df<span class="op">$</span>AGE[<span class="kw">which</span>(df<span class="op">$</span>AGE <span class="op">==</span><span class="st"> </span><span class="dv">99</span>)] &lt;-<span class="ot">NA</span>

<span class="kw">describe</span>(df<span class="op">$</span>AGE)</code></pre></div>
<pre><code>## df$AGE 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    98416     2552       98        1     35.5    22.32        8       15 
##      .25      .50      .75      .90      .95 
##       20       32       48       66       76 
## 
## lowest :  0  1  2  3  4, highest: 93 94 95 96 97</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># VALORES FALTANTES: 2,5%</span>

p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>( PERSON_TYPE, AGE)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size=</span><span class="dv">6</span>)) 
    

p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>( SEX, AGE)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size=</span><span class="dv">6</span>)) 


p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(RESTRAINT_SYSTEM.USE , AGE)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size=</span><span class="dv">6</span>))

p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(SEATING_POSITION, AGE)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size=</span><span class="dv">6</span>)) 

p5 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(HISPANIC_ORIGIN,AGE) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">5</span>,<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))

p6 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(EJECTION,AGE) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">5</span>,<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))


<span class="kw">theme_set</span>(<span class="kw">theme_cowplot</span>(<span class="dt">font_size=</span><span class="dv">12</span>))
<span class="kw">plot_grid</span>(p3,p1,p2,p4,p5,p6,
          <span class="dt">rel_widths=</span><span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">25</span>),<span class="dt">rel_heights=</span><span class="kw">c</span>(<span class="dv">80</span>,<span class="dv">50</span>),  <span class="dt">label_size =</span> <span class="dv">10</span>,
          <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/2analisis_age-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_grid</span>(p5,p6,
          <span class="dt">rel_widths=</span><span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">25</span>),<span class="dt">rel_heights=</span><span class="kw">c</span>(<span class="dv">80</span>,<span class="dv">50</span>),  <span class="dt">label_size =</span> <span class="dv">10</span>,
          <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/2analisis_age-5.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>AGE)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$AGE
## X-squared = 4238.8, df = 97, p-value &lt; 2.2e-16</code></pre>
<p>Como se puede observar existe un gran número de valores con edad 99 y como describimos anteriormente, se corresponden con el valor <em>Unknown</em>. También se puede comprobar que no existen accidentes para la edad igual a 98, como indica la información consultada, y que el número de accidentados con edades superiores o iguales a 97 es muy bajo. El número máximo de accidentes se da para conductores en el rango entre los 17 y los 21 años, lo que se corresponde a conductores noveles. También se observa un repunte en el número de accidentes para conductores más expertos entre los 35 y lo 42 años.</p>
<hr />
</div>
<div id="analisis-sex" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Análisis <code>SEX</code></h3>
<p>Esta variable identifica el sexo de la persona involucrada en el accidente. Esta variable puede tomar los valores</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(df<span class="op">$</span>SEX)</code></pre></div>
<pre><code>##  Female    Male Unknown 
##   33573   65740    1655</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Limpieza de datos</span>

df<span class="op">$</span>SEX =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>SEX, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Female&quot;</span>)))

p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(PERSON_TYPE,<span class="dt">fill=</span>SEX) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))

p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(SEATING_POSITION,<span class="dt">fill=</span>SEX) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>, <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))
p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(HISPANIC_ORIGIN,<span class="dt">fill=</span>SEX) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>, <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))

legend &lt;-<span class="st"> </span><span class="kw">get_legend</span>(p1)


prow &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(p1 <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>),p3<span class="op">+</span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>),p4<span class="op">+</span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>),p5<span class="op">+</span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>),
          <span class="dt">rel_widths=</span><span class="kw">c</span>(<span class="dv">35</span>,<span class="dv">45</span>),<span class="dt">rel_heights=</span><span class="kw">c</span>(<span class="dv">80</span>,<span class="dv">80</span>),  <span class="dt">label_size =</span> <span class="dv">10</span>,
          <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## Warning: Removed 2552 rows containing non-finite values (stat_boxplot).</code></pre>
<pre><code>## Warning: Removed 2552 rows containing missing values (geom_point).</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_grid</span>( prow, legend, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">3</span>, .<span class="dv">3</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/3analisis_sex-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Comparación con otras variables</span>

<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(ALCOHOL_TEST_RESULT,<span class="dt">fill=</span>SEX) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/3analisis_sex-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(RESTRAINT_SYSTEM.USE,<span class="dt">fill=</span>SEX) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/3analisis_sex-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(EJECTION,<span class="dt">fill=</span>SEX) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/3analisis_sex-4.png" width="672" /></p>
<p>Como se puede observar la mayor proporción de accidentes se producen en hombres (65740) que duplican al número de los femeninos (33573). También existe un pequeño número de valores indeterminados (1655).Además los hombres son los que tienen mayor rango de accidentes con muerte</p>
<p>También analizamos la relación entre el número de accidentes y la edad y sexo del accidentado. <img src="FARS18052_files/figure-html/unnamed-chunk-9-1.png" width="1440" style="display: block; margin: auto;" /> Esta gráfica muestra que a partir de la edad en la que una persona puede conducir, los 16 años, el número de accidentes es siempre mayor en el caso de los hombres.</p>
<p>En la siguiente gráfica mostramos una gráfica de densidades, lo que nos permite comparar directamente los accidentes por edades y sexo. Como se puede observar en la siguiente gráfica la siniestralidad de las mujeres es menor para las mujeres menores de 37 años. En el rango entre 38 y 60 años la comparación entre hombres y mujeres es similar. Para edades superiores a los 60 años, las mujeres superan a los hombres en el número de accidentes.</p>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-10-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>Podemos calcular la edad media de los afectados por una accidente de tráfico en función de su sexo: <img src="FARS18052_files/figure-html/unnamed-chunk-11-1.png" width="1440" style="display: block; margin: auto;" /> Como se puede observar la edad media de los hombres y mujeres que se vieron involucrados en un accidente es muy similar.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>SEX)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  df$INJURY_SEVERITY and df$SEX
## X-squared = 208.96, df = 1, p-value &lt; 2.2e-16</code></pre>
<hr />
</div>
<div id="analisis-person_type" class="section level3">
<h3><span class="header-section-number">2.3.4</span> Análisis <code>PERSON_TYPE</code></h3>
<p>Esta variable describe el papel de la persona involucrada en el accidente. Esta variable puede tomar los siguiente valores</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>PERSON_TYPE)</code></pre></div>
<pre><code>## df$PERSON_TYPE 
##        n  missing distinct 
##   100968        0       10 
## 
## Bicyclist (744, 0.007), Driver (57480, 0.569), OMotNT (225, 0.002), ONMotT
## (34, 0.000), Other_Cyclist (3, 0.000), Other_Pedestrian (103, 0.001),
## OMotT (36812, 0.365), Pedestrian (5331, 0.053), UOT (234, 0.002), UNM (2,
## 0.000)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>PERSON_TYPE =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>PERSON_TYPE, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;Driver&quot;</span>,
<span class="st">&quot;OMotT&quot;</span>, <span class="st">&quot;Pedestrian&quot;</span>,<span class="st">&quot;Bicyclist&quot;</span>,<span class="st">&quot;UOT&quot;</span>,<span class="st">&quot;OMotNT&quot;</span>,<span class="st">&quot;ONMotT&quot;</span>,<span class="st">&quot;Other_Cyclist&quot;</span>,<span class="st">&quot;Other_Pedestrian&quot;</span>,<span class="st">&quot;UNM&quot;</span>)))

<span class="co"># Regresión logistica con respecto a grado de afecto</span>
mylogit4 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>PERSON_TYPE , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit4)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ PERSON_TYPE, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.9594  -1.2527   0.8213   1.1039   2.7084  
## 
## Coefficients:
##                              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                  0.175281   0.008435  20.779  &lt; 2e-16 ***
## PERSON_TYPEOMotT             0.738171   0.014330  51.514  &lt; 2e-16 ***
## PERSON_TYPEPedestrian       -2.584092   0.050536 -51.134  &lt; 2e-16 ***
## PERSON_TYPEBicyclist        -3.817014   0.232555 -16.413  &lt; 2e-16 ***
## PERSON_TYPEUOT              -0.128761   0.136696  -0.942    0.346    
## PERSON_TYPEOMotNT            1.585706   0.188633   8.406  &lt; 2e-16 ***
## PERSON_TYPEONMotT            0.181393   0.348568   0.520    0.603    
## PERSON_TYPEOther_Cyclist    -9.741239  41.836449  -0.233    0.816    
## PERSON_TYPEOther_Pedestrian -1.064544   0.217033  -4.905 9.34e-07 ***
## PERSON_TYPEUNM               9.390676  51.238976   0.183    0.855    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 135884  on 99767  degrees of freedom
## Residual deviance: 125641  on 99758  degrees of freedom
##   (1200 observations deleted due to missingness)
## AIC: 125661
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># En función a los valores resultantes de la regresión y el número de valores de cada variable hacemos la siguiente reorganización.</span>

df<span class="op">$</span>PERSON_TYPE =<span class="st"> </span>plyr<span class="op">::</span><span class="kw">mapvalues</span>(df<span class="op">$</span>PERSON_TYPE, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;Bicyclist&quot;</span>, <span class="st">&quot;Driver&quot;</span>,<span class="st">&quot;OMotT&quot;</span>,<span class="st">&quot;ONMotT&quot;</span>,<span class="st">&quot;Other_Cyclist&quot;</span>,<span class="st">&quot;Pedestrian&quot;</span>,<span class="st">&quot;OMotNT&quot;</span>,<span class="st">&quot;Other_Pedestrian&quot;</span>,<span class="st">&quot;UOT&quot;</span>,<span class="st">&quot;UNM&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Driver&quot;</span>, <span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="ot">NA</span>))

<span class="co"># Resultado final</span>
<span class="kw">summary</span>(df<span class="op">$</span>PERSON_TYPE)</code></pre></div>
<pre><code>## Driver  Other   NA&#39;s 
##  57480  43486      2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Volvemos a hacer la regresión</span>
mylogit41 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>PERSON_TYPE , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit41)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ PERSON_TYPE, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.3958  -1.2527   0.9737   1.1039   1.1039  
## 
## Coefficients:
##                  Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)      0.175281   0.008435   20.78   &lt;2e-16 ***
## PERSON_TYPEOther 0.324896   0.013033   24.93   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 135882  on 99765  degrees of freedom
## Residual deviance: 135257  on 99764  degrees of freedom
##   (1202 observations deleted due to missingness)
## AIC: 135261
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(INJURY_SEVERITY,<span class="dt">fill=</span>PERSON_TYPE) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))
p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(SEATING_POSITION,<span class="dt">fill=</span>PERSON_TYPE) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))
p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(RESTRAINT_SYSTEM.USE,<span class="dt">fill=</span>PERSON_TYPE) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">4</span>, <span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))
p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(EJECTION,<span class="dt">fill=</span>PERSON_TYPE) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))

legend &lt;-<span class="st"> </span><span class="kw">get_legend</span>(p1)

prow &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(p1 <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>),p2<span class="op">+</span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>),p3<span class="op">+</span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>),p4<span class="op">+</span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>),
          <span class="dt">rel_widths=</span><span class="kw">c</span>(<span class="dv">35</span>,<span class="dv">45</span>),<span class="dt">rel_heights=</span><span class="kw">c</span>(<span class="dv">80</span>,<span class="dv">80</span>),  <span class="dt">label_size =</span> <span class="dv">10</span>,
          <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)

<span class="kw">plot_grid</span>( prow, legend, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>PERSON_TYPE)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  df$INJURY_SEVERITY and df$PERSON_TYPE
## X-squared = 622.73, df = 1, p-value &lt; 2.2e-16</code></pre>
<p>Como se puede observar la mayor cantidad de personas con lesiones graves son para conductores, seguido de pasajeros de vehiculos a motor y por último peatones. Estos son los tres tipos predominantes</p>
<hr />
</div>
<div id="analisis-seating_position" class="section level3">
<h3><span class="header-section-number">2.3.5</span> Análisis <code>SEATING_POSITION</code></h3>
<p>Esta variable identifica la localización de la persona dentro o fuera el vehículo. Esta variable puede tomar los siguiente valores. Hay que señalar que esta variable no se aplica a ciclistas y peatones, en cuyo caso el valor es Non-Motorist“.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>SEATING_POSITION)</code></pre></div>
<pre><code>## df$SEATING_POSITION 
##        n  missing distinct 
##    99200     1768       24 
## 
## lowest : FoL FoM FoR FL  FM , highest: TL  TM  TO  TR  TU</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Limpieza de datos</span>
df<span class="op">$</span>SEATING_POSITION[<span class="kw">which</span>(df<span class="op">$</span>SEATING_POSITION <span class="op">==</span><span class="st"> &quot;U&quot;</span>)] &lt;-<span class="ot">NA</span>

<span class="co"># Reordenación de variables</span>
df<span class="op">$</span>SEATING_POSITION =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>SEATING_POSITION, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;FL&quot;</span>,
<span class="st">&quot;FrR&quot;</span>, <span class="st">&quot;NMot&quot;</span>,<span class="st">&quot;SR&quot;</span>,<span class="st">&quot;SL&quot;</span>,<span class="st">&quot;SM&quot;</span>,<span class="st">&quot;OEC&quot;</span>,<span class="st">&quot;FM&quot;</span>,<span class="st">&quot;OUC&quot;</span>,<span class="st">&quot;SU&quot;</span>,<span class="st">&quot;TL&quot;</span>,<span class="st">&quot;TR&quot;</span>,<span class="st">&quot;SlepCa&quot;</span>,<span class="st">&quot;TM&quot;</span>,<span class="st">&quot;TU&quot;</span>,<span class="st">&quot;VE&quot;</span>,<span class="st">&quot;SO&quot;</span>,<span class="st">&quot;OPC&quot;</span>,<span class="st">&quot;FU&quot;</span>,<span class="st">&quot;FO&quot;</span>,<span class="st">&quot;TO&quot;</span>,<span class="st">&quot;FoL&quot;</span>,<span class="st">&quot;FoR&quot;</span>,<span class="st">&quot;FoM&quot;</span>)))

<span class="co"># Regresión logistica con respecto a grado de afecto</span>
mylogit5 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>SEATING_POSITION , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit5)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ SEATING_POSITION, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2974  -1.2532   0.7328   1.1034   2.1048  
## 
## Coefficients:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)             0.176545   0.008439  20.921  &lt; 2e-16 ***
## SEATING_POSITIONFrR     0.482132   0.017586  27.416  &lt; 2e-16 ***
## SEATING_POSITIONNMot   -2.276083   0.040869 -55.693  &lt; 2e-16 ***
## SEATING_POSITIONSR      1.001237   0.033633  29.770  &lt; 2e-16 ***
## SEATING_POSITIONSL      0.888749   0.033981  26.154  &lt; 2e-16 ***
## SEATING_POSITIONSM      1.264140   0.055767  22.668  &lt; 2e-16 ***
## SEATING_POSITIONOEC     1.860792   0.077391  24.044  &lt; 2e-16 ***
## SEATING_POSITIONFM      1.111309   0.080315  13.837  &lt; 2e-16 ***
## SEATING_POSITIONOUC     0.363128   0.113757   3.192 0.001412 ** 
## SEATING_POSITIONSU      0.733273   0.150644   4.868 1.13e-06 ***
## SEATING_POSITIONTL      1.426993   0.188149   7.584 3.34e-14 ***
## SEATING_POSITIONTR      1.546221   0.198386   7.794 6.49e-15 ***
## SEATING_POSITIONSlepCa  1.385640   0.215864   6.419 1.37e-10 ***
## SEATING_POSITIONTM      1.871148   0.265774   7.040 1.92e-12 ***
## SEATING_POSITIONTU      0.965552   0.209864   4.601 4.21e-06 ***
## SEATING_POSITIONVE     -1.071929   0.220541  -4.860 1.17e-06 ***
## SEATING_POSITIONSO      1.209749   0.288798   4.189 2.80e-05 ***
## SEATING_POSITIONOPC     1.154689   0.300612   3.841 0.000122 ***
## SEATING_POSITIONFU      0.038566   0.268941   0.143 0.885975    
## SEATING_POSITIONFO      0.516602   0.433095   1.193 0.232942    
## SEATING_POSITIONTO      2.388404   1.037783   2.301 0.021366 *  
## SEATING_POSITIONFoL     0.739745   0.836703   0.884 0.376631    
## SEATING_POSITIONFoR     1.432893   1.095478   1.308 0.190871    
## SEATING_POSITIONFoM     9.389412  36.231428   0.259 0.795519    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 133909  on 98240  degrees of freedom
## Residual deviance: 123739  on 98217  degrees of freedom
##   (2727 observations deleted due to missingness)
## AIC: 123787
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenamos en torno a los valores resultantes</span>
df<span class="op">$</span>SEATING_POSITION =<span class="st"> </span>plyr<span class="op">::</span><span class="kw">mapvalues</span>(df<span class="op">$</span>SEATING_POSITION, 
                                      <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;FL&quot;</span>,
<span class="st">&quot;FrR&quot;</span>, <span class="st">&quot;NMot&quot;</span>,<span class="st">&quot;SR&quot;</span>,<span class="st">&quot;SL&quot;</span>,<span class="st">&quot;SM&quot;</span>,<span class="st">&quot;OEC&quot;</span>,<span class="st">&quot;FM&quot;</span>,<span class="st">&quot;OUC&quot;</span>,<span class="st">&quot;SU&quot;</span>,<span class="st">&quot;TL&quot;</span>,<span class="st">&quot;TR&quot;</span>,<span class="st">&quot;SlepCa&quot;</span>,<span class="st">&quot;TM&quot;</span>,<span class="st">&quot;TU&quot;</span>,<span class="st">&quot;VE&quot;</span>,<span class="st">&quot;SO&quot;</span>,<span class="st">&quot;OPC&quot;</span>,<span class="st">&quot;FU&quot;</span>,<span class="st">&quot;FO&quot;</span>,<span class="st">&quot;TO&quot;</span>,<span class="st">&quot;FoL&quot;</span>,<span class="st">&quot;FoR&quot;</span>,<span class="st">&quot;FoM&quot;</span>), 
<span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;FL&quot;</span>,
<span class="st">&quot;FR&quot;</span>, <span class="st">&quot;NMot&quot;</span>,<span class="st">&quot;S_T&quot;</span>,<span class="st">&quot;S_T&quot;</span>,<span class="st">&quot;S_T&quot;</span>,<span class="st">&quot;CA&quot;</span>,<span class="st">&quot;FM&quot;</span>,<span class="st">&quot;CA&quot;</span>,<span class="st">&quot;S_T&quot;</span>,<span class="st">&quot;S_T&quot;</span>,<span class="st">&quot;S_T&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;S_T&quot;</span>,<span class="st">&quot;S_T&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;S_T&quot;</span>,<span class="st">&quot;CA&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>))

<span class="kw">summary</span>(df<span class="op">$</span>SEATING_POSITION)</code></pre></div>
<pre><code>##    FL    FR  NMot   S_T    CA    FM Other  NA&#39;s 
## 57331 18779  6442 13214  2143   928   363  1768</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Volvemos a aplicar la regresión logistica</span>
mylogit =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>SEATING_POSITION , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)

<span class="kw">summary</span>(mylogit)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ SEATING_POSITION, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.9162  -1.2532   0.7286   1.1034   2.1048  
## 
## Coefficients:
##                        Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)            0.176545   0.008439  20.921  &lt; 2e-16 ***
## SEATING_POSITIONFR     0.482132   0.017586  27.416  &lt; 2e-16 ***
## SEATING_POSITIONNMot  -2.276083   0.040867 -55.694  &lt; 2e-16 ***
## SEATING_POSITIONS_T    1.014242   0.022273  45.536  &lt; 2e-16 ***
## SEATING_POSITIONCA     1.485740   0.060814  24.431  &lt; 2e-16 ***
## SEATING_POSITIONFM     1.111309   0.080315  13.837  &lt; 2e-16 ***
## SEATING_POSITIONOther  0.350565   0.109267   3.208  0.00134 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 133909  on 98240  degrees of freedom
## Residual deviance: 124007  on 98234  degrees of freedom
##   (2727 observations deleted due to missingness)
## AIC: 124021
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Resultado Ok. Todos los factores son representativos.</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(SEATING_POSITION,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(SEATING_POSITION,<span class="dt">fill=</span>SEX) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-14-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(SEATING_POSITION,<span class="dt">fill=</span>EJECTION) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-14-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(SEATING_POSITION,<span class="dt">fill=</span>AIR_BAG_AVAILABILITY.DEPLOYMENT) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-14-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>SEATING_POSITION)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$SEATING_POSITION
## X-squared = 9225.6, df = 6, p-value &lt; 2.2e-16</code></pre>
<p>Como se puede observar los asientos frontales son los que llevan más daño y sobre los que actuan los accidentes</p>
<hr />
</div>
<div id="analisis-air_bag_availability.deployment" class="section level3">
<h3><span class="header-section-number">2.3.6</span> Análisis <code>AIR_BAG_AVAILABILITY.DEPLOYMENT</code></h3>
<p>La variable <em>AIR_BAG_AVAILABILITY_DEPLOYMENT</em> recoge la disponibilidad y empleo del air bag de la persona. Recoge tanto la disponibilidad como el despliegue para cada asiento ocupado.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>AIR_BAG_AVAILABILITY.DEPLOYMENT)</code></pre></div>
<pre><code>## df$AIR_BAG_AVAILABILITY.DEPLOYMENT 
##        n  missing distinct 
##    97708     3260       12 
##                                                                       
## Value        A_U  A_SO Av_nD  ADoR   NAv A_PNR  D_DU   D_F DA_fs DA_MD
## Frequency   7555    28  9455    22 58738    14    60 15136   108   147
## Proportion 0.077 0.000 0.097 0.000 0.601 0.000 0.001 0.155 0.001 0.002
##                       
## Value       D_OD    NM
## Frequency      3  6442
## Proportion 0.000 0.066</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Limpieza de datos</span>
df<span class="op">$</span>AIR_BAG_AVAILABILITY.DEPLOYMENT[<span class="kw">which</span>(df<span class="op">$</span>AIR_BAG_AVAILABILITY.DEPLOYMENT <span class="op">==</span><span class="st"> &quot;U&quot;</span>)] &lt;-<span class="ot">NA</span>

<span class="co"># Reordenación de variables</span>
df<span class="op">$</span>AIR_BAG_AVAILABILITY.DEPLOYMENT =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>AIR_BAG_AVAILABILITY.DEPLOYMENT, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;NAv&quot;</span>,<span class="st">&quot;D_F&quot;</span>,<span class="st">&quot;Av_nD&quot;</span>,<span class="st">&quot;A_U&quot;</span>,<span class="st">&quot;NM&quot;</span>,<span class="st">&quot;DA_MD&quot;</span>,<span class="st">&quot;DA_fs&quot;</span>, <span class="st">&quot;D_DU&quot;</span>,<span class="st">&quot;A_SO&quot;</span>,<span class="st">&quot;ADoR&quot;</span>,<span class="st">&quot;A_PNR&quot;</span>,<span class="st">&quot;D_OD&quot;</span>)))

<span class="co"># Regresión logistica con respecto a grado de afecto</span>
mylogit6 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>AIR_BAG_AVAILABILITY.DEPLOYMENT , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit6)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ AIR_BAG_AVAILABILITY.DEPLOYMENT, 
##     family = &quot;binomial&quot;, data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.5134  -1.3827   0.9406   0.9851   2.1048  
## 
## Coefficients:
##                                      Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)                           0.47078    0.00851  55.321  &lt; 2e-16
## AIR_BAG_AVAILABILITY.DEPLOYMENTD_F   -0.23817    0.01847 -12.892  &lt; 2e-16
## AIR_BAG_AVAILABILITY.DEPLOYMENTAv_nD  0.15616    0.02325   6.717 1.85e-11
## AIR_BAG_AVAILABILITY.DEPLOYMENTA_U    0.11543    0.02555   4.518 6.24e-06
## AIR_BAG_AVAILABILITY.DEPLOYMENTNM    -2.57031    0.04088 -62.871  &lt; 2e-16
## AIR_BAG_AVAILABILITY.DEPLOYMENTDA_MD -0.75435    0.16974  -4.444 8.82e-06
## AIR_BAG_AVAILABILITY.DEPLOYMENTDA_fs -0.24339    0.19570  -1.244   0.2136
## AIR_BAG_AVAILABILITY.DEPLOYMENTD_DU  -0.43688    0.26055  -1.677   0.0936
## AIR_BAG_AVAILABILITY.DEPLOYMENTA_SO  -0.18310    0.38198  -0.479   0.6317
## AIR_BAG_AVAILABILITY.DEPLOYMENTADoR   0.29136    0.45782   0.636   0.5245
## AIR_BAG_AVAILABILITY.DEPLOYMENTA_PNR -0.47078    0.53459  -0.881   0.3785
## AIR_BAG_AVAILABILITY.DEPLOYMENTD_OD   0.22237    1.22477   0.182   0.8559
##                                         
## (Intercept)                          ***
## AIR_BAG_AVAILABILITY.DEPLOYMENTD_F   ***
## AIR_BAG_AVAILABILITY.DEPLOYMENTAv_nD ***
## AIR_BAG_AVAILABILITY.DEPLOYMENTA_U   ***
## AIR_BAG_AVAILABILITY.DEPLOYMENTNM    ***
## AIR_BAG_AVAILABILITY.DEPLOYMENTDA_MD ***
## AIR_BAG_AVAILABILITY.DEPLOYMENTDA_fs    
## AIR_BAG_AVAILABILITY.DEPLOYMENTD_DU  .  
## AIR_BAG_AVAILABILITY.DEPLOYMENTA_SO     
## AIR_BAG_AVAILABILITY.DEPLOYMENTADoR     
## AIR_BAG_AVAILABILITY.DEPLOYMENTA_PNR    
## AIR_BAG_AVAILABILITY.DEPLOYMENTD_OD     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 132293  on 97152  degrees of freedom
## Residual deviance: 125345  on 97141  degrees of freedom
##   (3815 observations deleted due to missingness)
## AIC: 125369
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>AIR_BAG_AVAILABILITY.DEPLOYMENT =<span class="st"> </span>plyr<span class="op">::</span><span class="kw">mapvalues</span>(df<span class="op">$</span>AIR_BAG_AVAILABILITY.DEPLOYMENT, 
                                      <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;NA&quot;</span>, <span class="st">&quot;D_F&quot;</span>,<span class="st">&quot;Av_nD&quot;</span>,<span class="st">&quot;A_U&quot;</span>,<span class="st">&quot;NM&quot;</span>,<span class="st">&quot;DA_MD&quot;</span>,<span class="st">&quot;DA_fs&quot;</span>, <span class="st">&quot;D_DU&quot;</span>,<span class="st">&quot;A_SO&quot;</span>,<span class="st">&quot;ADoR&quot;</span>,<span class="st">&quot;A_PNR&quot;</span>,<span class="st">&quot;D_OD&quot;</span>), 
<span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NA&quot;</span>, <span class="st">&quot;D_F&quot;</span>,<span class="st">&quot;Av_nD&quot;</span>,<span class="st">&quot;A_U&quot;</span>,<span class="st">&quot;NM&quot;</span>,<span class="st">&quot;DA_MD&quot;</span>,<span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Others&quot;</span>))</code></pre></div>
<pre><code>## The following `from` values were not present in `x`: NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(AIR_BAG_AVAILABILITY.DEPLOYMENT,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/6AIR_BAG_AVAILABILITY.DEPLOYMENT-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(AIR_BAG_AVAILABILITY.DEPLOYMENT,<span class="dt">fill=</span>EJECTION) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/6AIR_BAG_AVAILABILITY.DEPLOYMENT-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>AIR_BAG_AVAILABILITY.DEPLOYMENT)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$AIR_BAG_AVAILABILITY.DEPLOYMENT
## X-squared = 6511.9, df = 6, p-value &lt; 2.2e-16</code></pre>
<p>El mayor número de altos lesionados se encuentra en vehiculo que no tienen airbag, seguido por aquellos vehiculos que si lo tienen pero muy por debajo</p>
<p>En los casos en los que no se tiene air bag disponible, se distribuye principalmente entre personas que ocupaban el asiento del conductor, el copiloto y los asientos traseros. El número de accidentados que ocupaban el asiento del copiloto (10000 accidentes) es similar al caso en el que la persona ocupaba cualquiera de los asientos traseros. Además el número de personas en la posición del piloto involucradas en un accidente y que no usaron airbag es 3/2 más alto que al número de personas que ocuparon cualquier otra posición en el vehículo. Esto confirma el cociente conductor/pasajero que observamos en el estudio de la variable <em>PERSON_TYPE</em>.</p>
<hr />
</div>
<div id="analisis-restraint_system.use" class="section level3">
<h3><span class="header-section-number">2.3.7</span> Análisis <code>RESTRAINT_SYSTEM.USE</code></h3>
<p>La variable <em>RESTRAINT_SYSTEM_USE</em> registra el equipo de retención en uso por el ocupante, o el casco en uso de un motociclista, en el momento del accidente.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>RESTRAINT_SYSTEM.USE)</code></pre></div>
<pre><code>## df$RESTRAINT_SYSTEM.USE 
##        n  missing distinct 
##    91951     9017       11 
##                                                                       
## Value         BH   CHS CSSUI   HUI   LSB    LB    MH    NA  RUTU  SBUI
## Frequency     60  1542    73    56 40763  2523  1898 41462  2973   131
## Proportion 0.001 0.017 0.001 0.001 0.443 0.027 0.021 0.451 0.032 0.001
##                 
## Value         SB
## Frequency    470
## Proportion 0.005</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Limpieza de datos</span>
df<span class="op">$</span>RESTRAINT_SYSTEM.USE[<span class="kw">which</span>(df<span class="op">$</span>RESTRAINT_SYSTEM.USE <span class="op">==</span><span class="st"> &quot;U&quot;</span>)] &lt;-<span class="ot">NA</span>

<span class="kw">summary</span>(df<span class="op">$</span>RESTRAINT_SYSTEM.USE)</code></pre></div>
<pre><code>##    BH   CHS CSSUI   HUI   LSB    LB    MH    NA  RUTU  SBUI    SB  NA&#39;s 
##    60  1542    73    56 40763  2523  1898 41462  2973   131   470  9017</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>RESTRAINT_SYSTEM.USE =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>RESTRAINT_SYSTEM.USE, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;LSB&quot;</span>,<span class="st">&quot;RUTU&quot;</span>,<span class="st">&quot;LB&quot;</span>,<span class="st">&quot;MH&quot;</span>,<span class="st">&quot;CHS&quot;</span>,<span class="st">&quot;SB&quot;</span>,<span class="st">&quot;SBUI&quot;</span>, <span class="st">&quot;CSSUI&quot;</span>,<span class="st">&quot;BH&quot;</span>,<span class="st">&quot;HUI&quot;</span>)))


<span class="co"># Regresión logistica con respecto a grado de afecto</span>
mylogit7 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>RESTRAINT_SYSTEM.USE , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit7)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ RESTRAINT_SYSTEM.USE, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.0516  -0.9926   0.7763   0.7763   2.6081  
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               -0.45158    0.01009 -44.736  &lt; 2e-16 ***
## RESTRAINT_SYSTEM.USELSB    1.49658    0.01516  98.728  &lt; 2e-16 ***
## RESTRAINT_SYSTEM.USERUTU   1.77376    0.04617  38.418  &lt; 2e-16 ***
## RESTRAINT_SYSTEM.USELB     2.17997    0.05658  38.532  &lt; 2e-16 ***
## RESTRAINT_SYSTEM.USEMH    -1.46221    0.06932 -21.094  &lt; 2e-16 ***
## RESTRAINT_SYSTEM.USECHS    2.42610    0.07869  30.832  &lt; 2e-16 ***
## RESTRAINT_SYSTEM.USESB     0.18997    0.09369   2.028 0.042595 *  
## RESTRAINT_SYSTEM.USESBUI   0.58920    0.17545   3.358 0.000784 ***
## RESTRAINT_SYSTEM.USECSSUI  0.69941    0.23610   2.962 0.003053 ** 
## RESTRAINT_SYSTEM.USEBH    -2.91572    0.71870  -4.057 4.97e-05 ***
## RESTRAINT_SYSTEM.USEHUI   -2.11337    0.51897  -4.072 4.66e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 125045  on 91618  degrees of freedom
## Residual deviance: 110514  on 91608  degrees of freedom
##   (9349 observations deleted due to missingness)
## AIC: 110536
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Para conseguir un modelo más robusto...</span>
<span class="kw">summary</span>(df<span class="op">$</span>RESTRAINT_SYSTEM.USE)</code></pre></div>
<pre><code>##    NA   LSB  RUTU    LB    MH   CHS    SB  SBUI CSSUI    BH   HUI  NA&#39;s 
## 41462 40763  2973  2523  1898  1542   470   131    73    60    56  9017</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>RESTRAINT_SYSTEM.USE =<span class="st"> </span>plyr<span class="op">::</span><span class="kw">mapvalues</span>(df<span class="op">$</span>RESTRAINT_SYSTEM.USE, 
                                      <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;LSB&quot;</span>,<span class="st">&quot;RUTU&quot;</span>,<span class="st">&quot;LB&quot;</span>,<span class="st">&quot;MH&quot;</span>,<span class="st">&quot;CHS&quot;</span>,<span class="st">&quot;SB&quot;</span>,<span class="st">&quot;SBUI&quot;</span>, <span class="st">&quot;CSSUI&quot;</span>,<span class="st">&quot;BH&quot;</span>,<span class="st">&quot;HUI&quot;</span>), 
<span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>))


<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(RESTRAINT_SYSTEM.USE,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/7RESTRAINT_SYSTEM.USE-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(RESTRAINT_SYSTEM.USE,<span class="dt">fill=</span>EJECTION) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/7RESTRAINT_SYSTEM.USE-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(RESTRAINT_SYSTEM.USE,<span class="dt">fill=</span>EJECTION_PATH) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/7RESTRAINT_SYSTEM.USE-3.png" width="672" /></p>
<p>Como se puede observar, para aquellas personas que usaron el cinturón de seguridad del tipo “lap”&quot; o “lap &amp; shoulder”&quot; el numero de fallecidos es menor que el de heridos o ilesos, al contrario que para el caso de la utilización de un cinturón tipo “shoulder”. Los motociclistas presentan un mayor número de fallecidos para aquellos que llevaban casco. Para aquellos personas que viajaban en un vehículo y que no utilizaron cinturón, el número de fallecidos duplica al de heridos. Hay que señalar que estos datos también incluyen a los peatones.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>RESTRAINT_SYSTEM.USE)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$RESTRAINT_SYSTEM.USE
## X-squared = 11015, df = 2, p-value &lt; 2.2e-16</code></pre>
<hr />
</div>
<div id="analisis-ejection" class="section level3">
<h3><span class="header-section-number">2.3.8</span> Análisis <code>EJECTION</code></h3>
<p>La variable <em>EJECTION</em> se refiere a aquellos ocupantes que fueron total o parcialmente lanzados fuera del vehículo como resultado del impacto o vuelco. Esta variable no se aplica a personas que estaban situadas en el exterior del vehículo, ocupantes de motocicletas o a no-motoristas (peatones).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>EJECTION)</code></pre></div>
<pre><code>## df$EJECTION 
##        n  missing distinct 
##   100968        0        4 
##                                                                 
## Value            Not_Ejected Partially_Ejected   Totally_Ejected
## Frequency              87475              2191             10410
## Proportion             0.866             0.022             0.103
##                             
## Value                Unknown
## Frequency                892
## Proportion             0.009</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Limpieza de datos</span>
df<span class="op">$</span>EJECTION[<span class="kw">which</span>(df<span class="op">$</span>EJECTION <span class="op">==</span><span class="st"> &quot;Unknown&quot;</span>)] &lt;-<span class="ot">NA</span>

<span class="co"># Reordenación de variables</span>
df<span class="op">$</span>EJECTION =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>EJECTION, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;Not_Ejected&quot;</span>,<span class="st">&quot;Totally_Ejected&quot;</span>,<span class="st">&quot;Partially_Ejected&quot;</span>)))

<span class="co"># Regresión logistica con respecto a grado de afecto</span>
mylogit8 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>EJECTION , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit8)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ EJECTION, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.4015  -1.4015   0.9687   0.9687   2.0427  
## 
## Coefficients:
##                            Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                0.512934   0.007024   73.03   &lt;2e-16 ***
## EJECTIONTotally_Ejected   -1.487381   0.023082  -64.44   &lt;2e-16 ***
## EJECTIONPartially_Ejected -2.466691   0.065168  -37.85   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 135025  on 99126  degrees of freedom
## Residual deviance: 128312  on 99124  degrees of freedom
##   (1841 observations deleted due to missingness)
## AIC: 128318
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(EJECTION,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/8EJECTION-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(EJECTION_PATH,<span class="dt">fill=</span>EJECTION) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/8EJECTION-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Un gran porcentaje de los totalmente ejectados murieron</span>

<span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>EJECTION)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$EJECTION
## X-squared = 6588.3, df = 2, p-value &lt; 2.2e-16</code></pre>
<p>El siguiente histograma muestra la distribución de los accidentes en función de la posición que ocupaba la persona involucrada en el accidente por el cada tipo de “ejection”. <img src="FARS18052_files/figure-html/unnamed-chunk-17-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>Podemos estudiar la dependencia del número de accidentes en función de si usa algún tipo de retención para cada tipo de eyección. Como se observa la eyección del vehículo es un proceso minoritario para todos los casos, pero es más evidente para el caso en el que la persona involucrada en el accidente no tenía o no usó ningún tipo de retención. <img src="FARS18052_files/figure-html/unnamed-chunk-18-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>Similarmente el número de accidentes en accidentes en función de la disponibilidad del air bag para cada tipo de eyección, muestra que el número de expulsados del coche, tanto total como parcialmente, es mayor para el caso en el que no se utilizó el air bag. <img src="FARS18052_files/figure-html/unnamed-chunk-19-1.png" width="1440" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="analisis-ejection_path" class="section level3">
<h3><span class="header-section-number">2.3.9</span> Análisis <code>EJECTION_PATH</code></h3>
<p>La variable <em>EJECTION_PATH</em> identifica la trayectoria por el cual la persona fue expulsada del vehículo.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>EJECTION_PATH)</code></pre></div>
<pre><code>## df$EJECTION_PATH 
##        n  missing distinct 
##    90961    10007        9 
##                                                                 
## Value       NoAp Other BackD BackW RoofC  Roof SideD SideW  Wind
## Frequency  87477   407    56   327    45   168   701  1522   258
## Proportion 0.962 0.004 0.001 0.004 0.000 0.002 0.008 0.017 0.003</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>

df<span class="op">$</span>EJECTION_PATH =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>EJECTION_PATH, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>,<span class="st">&quot;SideW&quot;</span>,<span class="st">&quot;SideD&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;BackW&quot;</span>, <span class="st">&quot;Wind&quot;</span>, <span class="st">&quot;Roof&quot;</span>, <span class="st">&quot;BackD&quot;</span>, <span class="st">&quot;RoofC&quot;</span>)))


mylogit9 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>EJECTION_PATH , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit9)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ EJECTION_PATH, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.4015  -1.4015   0.9687   0.9687   1.9781  
## 
## Coefficients:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)         0.512922   0.007023  73.030  &lt; 2e-16 ***
## EJECTION_PATHSideW -2.317008   0.073934 -31.339  &lt; 2e-16 ***
## EJECTION_PATHSideD -2.234677   0.105686 -21.144  &lt; 2e-16 ***
## EJECTION_PATHOther -0.715081   0.099890  -7.159 8.15e-13 ***
## EJECTION_PATHBackW -1.640283   0.128833 -12.732  &lt; 2e-16 ***
## EJECTION_PATHWind  -1.865640   0.154257 -12.094  &lt; 2e-16 ***
## EJECTION_PATHRoof  -1.959841   0.196602  -9.969  &lt; 2e-16 ***
## EJECTION_PATHBackD -1.179400   0.282326  -4.177 2.95e-05 ***
## EJECTION_PATHRoofC -1.206069   0.316306  -3.813 0.000137 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 120474  on 90020  degrees of freedom
## Residual deviance: 117773  on 90012  degrees of freedom
##   (10947 observations deleted due to missingness)
## AIC: 117791
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Son valores diferentes dificil de agrupar por tanto mejor dejarlos así</span>

<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(EJECTION_PATH,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/9EJECTION_PATH-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># RELACIÓN ENTRE EJECTION Y EJECTION_PATH</span>

<span class="co"># Hay dos casos que se consideran que no han eyectado pero en la otra variable aparecen como eyectados.</span>
df[<span class="kw">which</span>(df<span class="op">$</span>EJECTION <span class="op">!=</span><span class="st"> &quot;Not_Ejected&quot;</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>EJECTION_PATH <span class="op">==</span><span class="st"> &quot;NE&quot;</span>),]</code></pre></div>
<pre><code>##  [1] CASE_STATE                         
##  [2] AGE                                
##  [3] SEX                                
##  [4] PERSON_TYPE                        
##  [5] SEATING_POSITION                   
##  [6] RESTRAINT_SYSTEM.USE               
##  [7] AIR_BAG_AVAILABILITY.DEPLOYMENT    
##  [8] EJECTION                           
##  [9] EJECTION_PATH                      
## [10] EXTRICATION                        
## [11] NON_MOTORIST_LOCATION              
## [12] POLICE_REPORTED_ALCOHOL_INVOLVEMENT
## [13] METHOD_ALCOHOL_DETERMINATION       
## [14] ALCOHOL_TEST_TYPE                  
## [15] ALCOHOL_TEST_RESULT                
## [16] POLICE.REPORTED_DRUG_INVOLVEMENT   
## [17] METHOD_OF_DRUG_DETERMINATION       
## [18] DRUG_TEST_TYPE                     
## [19] DRUG_TEST_RESULTS_.1_of_3.         
## [20] DRUG_TEST_TYPE_.2_of_3.            
## [21] DRUG_TEST_RESULTS_.2_of_3.         
## [22] DRUG_TEST_TYPE_.3_of_3.            
## [23] DRUG_TEST_RESULTS_.3_of_3.         
## [24] HISPANIC_ORIGIN                    
## [25] TAKEN_TO_HOSPITAL                  
## [26] RELATED_FACTOR_.1.                 
## [27] RELATED_FACTOR_.2.                 
## [28] RELATED_FACTOR_.3.                 
## [29] RACE                               
## [30] INJURY_SEVERITY                    
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>EJECTION_PATH)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$EJECTION_PATH
## X-squared = 2667.3, df = 8, p-value &lt; 2.2e-16</code></pre>
<p>Casi la totalidad de los usuarios que fueron eyectados murieron, aunque la gran mayoría no lo fueron</p>
<hr />
</div>
<div id="analisis-extrication" class="section level3">
<h3><span class="header-section-number">2.3.10</span> Análisis <code>EXTRICATION</code></h3>
<p>La variable <em>EXTRICATION</em> se refiere al empleo de equipamiento o de la fuerza para extraer a las personas de los vehículos, es decir, más que sólo subir o transportar a una persona de los restos del vehículo. El valor “Unknown” identifica el caso en el que el oficial señala que el ocupante ha sido aplastado y sugiere que el ocupante pudo ser extraído con fuerza, pero no está claro si se utilizó equipo o no. Este valor no es aplicable a motociclistas y no-motoristas (peatones y ciclistas)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>EXTRICATION)</code></pre></div>
<pre><code>## df$EXTRICATION 
##        n  missing distinct 
##   100968        0        3 
##                                                        
## Value          Extricated Not_Extricated        Unknown
## Frequency            9826          89933           1209
## Proportion          0.097          0.891          0.012</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Limpieza de datos</span>
df<span class="op">$</span>EXTRICATION[<span class="kw">which</span>(df<span class="op">$</span>EXTRICATION <span class="op">==</span><span class="st"> &quot;Unknown&quot;</span>)] &lt;-<span class="ot">NA</span>

<span class="co"># Reordenación de variables</span>
df<span class="op">$</span>EXTRICATION =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>EXTRICATION, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;Not_Extricated&quot;</span>,<span class="st">&quot;Extricated&quot;</span>)))

mylogit =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>EXTRICATION , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ EXTRICATION, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.3766  -1.3766   0.9905   0.9905   1.5925  
## 
## Coefficients:
##                        Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)            0.456969   0.006881   66.42   &lt;2e-16 ***
## EXTRICATIONExtricated -1.394467   0.023477  -59.40   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 134456  on 98794  degrees of freedom
## Residual deviance: 130491  on 98793  degrees of freedom
##   (2173 observations deleted due to missingness)
## AIC: 130495
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores representativos, por tanto no se cambia nada</span>

<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(EXTRICATION,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/10extric-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># La mayoría de los extrincated murieron</span>

<span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>EXTRICATION)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  df$INJURY_SEVERITY and df$EXTRICATION
## X-squared = 3970.3, df = 1, p-value &lt; 2.2e-16</code></pre>
<hr />
</div>
<div id="analisis-non_motorist_location" class="section level3">
<h3><span class="header-section-number">2.3.11</span> Análisis <code>NON_MOTORIST_LOCATION</code></h3>
<p>Esta variable sólo es aplicable a los no-motoristas, es decir, peatones y ciclistas, y se refiere a la localización del no-motorista en el momento del accidente.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>NON_MOTORIST_LOCATION)</code></pre></div>
<pre><code>## df$NON_MOTORIST_LOCATION 
##        n  missing distinct 
##   100907       61       17 
##                                                                          
## Value         IIC    INR  IRCAU  IRCNA   IRNC     IU   NIBP    NIC   NIPL
## Frequency     471     64    304    176    300     41      4     48      9
## Proportion  0.005  0.001  0.003  0.002  0.003  0.000  0.000  0.000  0.000
##                                                                   
## Value        NIRS NIRCAU NIRCNA  NIRNC  NIONR   NIOT    NIU   NoAp
## Frequency     508    835   2438    765    296     90     32  94526
## Proportion  0.005  0.008  0.024  0.008  0.003  0.001  0.000  0.937</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>NON_MOTORIST_LOCATION =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>NON_MOTORIST_LOCATION, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>,<span class="st">&quot;NIRCNA&quot;</span>,<span class="st">&quot;NIRCAU&quot;</span>,<span class="st">&quot;NIRNC&quot;</span>,<span class="st">&quot;NIRS&quot;</span>, <span class="st">&quot;IIC&quot;</span>,<span class="st">&quot;IRCAU&quot;</span>,<span class="st">&quot;IRNC&quot;</span>,<span class="st">&quot;NIONR&quot;</span>, <span class="st">&quot;IRCNA&quot;</span>, <span class="st">&quot;NIOT&quot;</span>, <span class="st">&quot;INR&quot;</span>,<span class="st">&quot;NIC&quot;</span>,<span class="st">&quot;IU&quot;</span>,<span class="st">&quot;NIU&quot;</span>,<span class="st">&quot;NIPL&quot;</span>)))

mylogit11 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>NON_MOTORIST_LOCATION , <span class="dt">data =</span> fars, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit11)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ NON_MOTORIST_LOCATION, family = &quot;binomial&quot;, 
##     data = fars)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.3033   0.0138   0.0138   0.0138   0.0138  
## 
## Coefficients:
##                                                                                     Estimate
## (Intercept)                                                                        2.357e+01
## NON_MOTORIST_LOCATIONIntersection_-_Not_on_Roadway                                 9.920e-08
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_Availability_Unknown      7.903e-07
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_not_Available             7.628e-07
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Not_in_Crosswalk                    7.900e-07
## NON_MOTORIST_LOCATIONIntersection_-_Unknown                                        1.949e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_Bike_Path                                  9.344e-08
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Crosswalk                               1.965e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Parking_Lane                            7.865e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Road_Shoulder                           1.015e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_Availability_Unknown  7.657e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_not_Available         1.944e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Not_in_Crosswalk                7.858e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_Other_Not_a_Roadway                        9.826e-08
## NON_MOTORIST_LOCATIONNon-Intersection_-_Outside_Trafficway                         2.043e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_Unknown                                    2.072e-07
## NON_MOTORIST_LOCATIONNot_Applicable_-_Vehicle_Occupant                            -1.431e+01
## NON_MOTORIST_LOCATIONUnknown                                                       7.920e-07
##                                                                                   Std. Error
## (Intercept)                                                                        3.661e+03
## NON_MOTORIST_LOCATIONIntersection_-_Not_on_Roadway                                 1.059e+04
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_Availability_Unknown      5.846e+03
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_not_Available             7.020e+03
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Not_in_Crosswalk                    5.870e+03
## NON_MOTORIST_LOCATIONIntersection_-_Unknown                                        1.294e+04
## NON_MOTORIST_LOCATIONNon-Intersection_-_Bike_Path                                  3.990e+04
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Crosswalk                               1.204e+04
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Parking_Lane                            2.674e+04
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Road_Shoulder                           5.083e+03
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_Availability_Unknown  4.579e+03
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_not_Available         3.999e+03
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Not_in_Crosswalk                4.654e+03
## NON_MOTORIST_LOCATIONNon-Intersection_-_Other_Not_a_Roadway                        5.894e+03
## NON_MOTORIST_LOCATIONNon-Intersection_-_Outside_Trafficway                         9.141e+03
## NON_MOTORIST_LOCATIONNon-Intersection_-_Unknown                                    1.452e+04
## NON_MOTORIST_LOCATIONNot_Applicable_-_Vehicle_Occupant                             3.661e+03
## NON_MOTORIST_LOCATIONUnknown                                                       1.081e+04
##                                                                                   z value
## (Intercept)                                                                         0.006
## NON_MOTORIST_LOCATIONIntersection_-_Not_on_Roadway                                  0.000
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_Availability_Unknown       0.000
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_not_Available              0.000
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Not_in_Crosswalk                     0.000
## NON_MOTORIST_LOCATIONIntersection_-_Unknown                                         0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Bike_Path                                   0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Crosswalk                                0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Parking_Lane                             0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Road_Shoulder                            0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_Availability_Unknown   0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_not_Available          0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Not_in_Crosswalk                 0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Other_Not_a_Roadway                         0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Outside_Trafficway                          0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Unknown                                     0.000
## NON_MOTORIST_LOCATIONNot_Applicable_-_Vehicle_Occupant                             -0.004
## NON_MOTORIST_LOCATIONUnknown                                                        0.000
##                                                                                   Pr(&gt;|z|)
## (Intercept)                                                                          0.995
## NON_MOTORIST_LOCATIONIntersection_-_Not_on_Roadway                                   1.000
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_Availability_Unknown        1.000
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_not_Available               1.000
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Not_in_Crosswalk                      1.000
## NON_MOTORIST_LOCATIONIntersection_-_Unknown                                          1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Bike_Path                                    1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Crosswalk                                 1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Parking_Lane                              1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Road_Shoulder                             1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_Availability_Unknown    1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_not_Available           1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Not_in_Crosswalk                  1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Other_Not_a_Roadway                          1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Outside_Trafficway                           1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Unknown                                      1.000
## NON_MOTORIST_LOCATIONNot_Applicable_-_Vehicle_Occupant                               0.997
## NON_MOTORIST_LOCATIONUnknown                                                         1.000
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 185.86  on 100967  degrees of freedom
## Residual deviance: 184.67  on 100950  degrees of freedom
## AIC: 220.67
## 
## Number of Fisher Scoring iterations: 22</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(NON_MOTORIST_LOCATION,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/11NON_MOTORIST_LOCATION-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(NON_MOTORIST_LOCATION,<span class="dt">fill=</span>POLICE_REPORTED_ALCOHOL_INVOLVEMENT) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/11NON_MOTORIST_LOCATION-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>NON_MOTORIST_LOCATION)</code></pre></div>
<pre><code>## Warning in chisq.test(df$INJURY_SEVERITY, df$NON_MOTORIST_LOCATION): Chi-
## squared approximation may be incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$NON_MOTORIST_LOCATION
## X-squared = 6543.8, df = 15, p-value &lt; 2.2e-16</code></pre>
<p>Se reagruparán las categorías en “Intersection” y “Non_Intersection”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#se vuelven  a reagrupar los valores</span>
df<span class="op">$</span>NON_MOTORIST_LOCATION =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>NON_MOTORIST_LOCATION, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>,<span class="st">&quot;NIRCNA&quot;</span>,<span class="st">&quot;NIRCAU&quot;</span>,<span class="st">&quot;NIRNC&quot;</span>,<span class="st">&quot;NIRS&quot;</span>, <span class="st">&quot;IIC&quot;</span>,<span class="st">&quot;IRCAU&quot;</span>,<span class="st">&quot;IRNC&quot;</span>,<span class="st">&quot;NIONR&quot;</span>, <span class="st">&quot;IRCNA&quot;</span>, <span class="st">&quot;NIOT&quot;</span>, <span class="st">&quot;INR&quot;</span>, <span class="ot">NA</span>,<span class="st">&quot;NIC&quot;</span>,<span class="st">&quot;IU&quot;</span> ,<span class="st">&quot;NIU&quot;</span>,<span class="st">&quot;NIPL&quot;</span>, <span class="st">&quot;NIBP&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>,<span class="st">&quot;NI&quot;</span>,<span class="st">&quot;NI&quot;</span>,<span class="st">&quot;NI&quot;</span>,<span class="st">&quot;NI&quot;</span>, <span class="st">&quot;I&quot;</span>,<span class="st">&quot;I&quot;</span>,<span class="st">&quot;I&quot;</span>,<span class="st">&quot;NI&quot;</span>, <span class="st">&quot;I&quot;</span>, <span class="st">&quot;NI&quot;</span>, <span class="st">&quot;I&quot;</span>, <span class="ot">NA</span>,<span class="st">&quot;NI&quot;</span>,<span class="st">&quot;I&quot;</span> ,<span class="st">&quot;NI&quot;</span>,<span class="st">&quot;NI&quot;</span>, <span class="st">&quot;NI&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="co"># Reordenación de variables</span>
df<span class="op">$</span>NON_MOTORIST_LOCATION =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>NON_MOTORIST_LOCATION, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>,<span class="st">&quot;NI&quot;</span>,<span class="st">&quot;I&quot;</span>, <span class="ot">NA</span>)))

mylogit11_<span class="dv">2</span> =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>NON_MOTORIST_LOCATION , <span class="dt">data =</span> fars, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit11_<span class="dv">2</span>)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ NON_MOTORIST_LOCATION, family = &quot;binomial&quot;, 
##     data = fars)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.3033   0.0138   0.0138   0.0138   0.0138  
## 
## Coefficients:
##                                                                                     Estimate
## (Intercept)                                                                        2.357e+01
## NON_MOTORIST_LOCATIONIntersection_-_Not_on_Roadway                                 9.920e-08
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_Availability_Unknown      7.903e-07
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_not_Available             7.628e-07
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Not_in_Crosswalk                    7.900e-07
## NON_MOTORIST_LOCATIONIntersection_-_Unknown                                        1.949e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_Bike_Path                                  9.344e-08
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Crosswalk                               1.965e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Parking_Lane                            7.865e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Road_Shoulder                           1.015e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_Availability_Unknown  7.657e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_not_Available         1.944e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Not_in_Crosswalk                7.858e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_Other_Not_a_Roadway                        9.826e-08
## NON_MOTORIST_LOCATIONNon-Intersection_-_Outside_Trafficway                         2.043e-07
## NON_MOTORIST_LOCATIONNon-Intersection_-_Unknown                                    2.072e-07
## NON_MOTORIST_LOCATIONNot_Applicable_-_Vehicle_Occupant                            -1.431e+01
## NON_MOTORIST_LOCATIONUnknown                                                       7.920e-07
##                                                                                   Std. Error
## (Intercept)                                                                        3.661e+03
## NON_MOTORIST_LOCATIONIntersection_-_Not_on_Roadway                                 1.059e+04
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_Availability_Unknown      5.846e+03
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_not_Available             7.020e+03
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Not_in_Crosswalk                    5.870e+03
## NON_MOTORIST_LOCATIONIntersection_-_Unknown                                        1.294e+04
## NON_MOTORIST_LOCATIONNon-Intersection_-_Bike_Path                                  3.990e+04
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Crosswalk                               1.204e+04
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Parking_Lane                            2.674e+04
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Road_Shoulder                           5.083e+03
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_Availability_Unknown  4.579e+03
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_not_Available         3.999e+03
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Not_in_Crosswalk                4.654e+03
## NON_MOTORIST_LOCATIONNon-Intersection_-_Other_Not_a_Roadway                        5.894e+03
## NON_MOTORIST_LOCATIONNon-Intersection_-_Outside_Trafficway                         9.141e+03
## NON_MOTORIST_LOCATIONNon-Intersection_-_Unknown                                    1.452e+04
## NON_MOTORIST_LOCATIONNot_Applicable_-_Vehicle_Occupant                             3.661e+03
## NON_MOTORIST_LOCATIONUnknown                                                       1.081e+04
##                                                                                   z value
## (Intercept)                                                                         0.006
## NON_MOTORIST_LOCATIONIntersection_-_Not_on_Roadway                                  0.000
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_Availability_Unknown       0.000
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_not_Available              0.000
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Not_in_Crosswalk                     0.000
## NON_MOTORIST_LOCATIONIntersection_-_Unknown                                         0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Bike_Path                                   0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Crosswalk                                0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Parking_Lane                             0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Road_Shoulder                            0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_Availability_Unknown   0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_not_Available          0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Not_in_Crosswalk                 0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Other_Not_a_Roadway                         0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Outside_Trafficway                          0.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Unknown                                     0.000
## NON_MOTORIST_LOCATIONNot_Applicable_-_Vehicle_Occupant                             -0.004
## NON_MOTORIST_LOCATIONUnknown                                                        0.000
##                                                                                   Pr(&gt;|z|)
## (Intercept)                                                                          0.995
## NON_MOTORIST_LOCATIONIntersection_-_Not_on_Roadway                                   1.000
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_Availability_Unknown        1.000
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Crosswalk_not_Available               1.000
## NON_MOTORIST_LOCATIONIntersection_-_On_Roadway_Not_in_Crosswalk                      1.000
## NON_MOTORIST_LOCATIONIntersection_-_Unknown                                          1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Bike_Path                                    1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Crosswalk                                 1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_In_Parking_Lane                              1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Road_Shoulder                             1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_Availability_Unknown    1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Crosswalk_not_Available           1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_On_Roadway_Not_in_Crosswalk                  1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Other_Not_a_Roadway                          1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Outside_Trafficway                           1.000
## NON_MOTORIST_LOCATIONNon-Intersection_-_Unknown                                      1.000
## NON_MOTORIST_LOCATIONNot_Applicable_-_Vehicle_Occupant                               0.997
## NON_MOTORIST_LOCATIONUnknown                                                         1.000
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 185.86  on 100967  degrees of freedom
## Residual deviance: 184.67  on 100950  degrees of freedom
## AIC: 220.67
## 
## Number of Fisher Scoring iterations: 22</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(NON_MOTORIST_LOCATION,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/NON_MOTORIST_LOCATION_-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(NON_MOTORIST_LOCATION,<span class="dt">fill=</span>POLICE_REPORTED_ALCOHOL_INVOLVEMENT) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/NON_MOTORIST_LOCATION_-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>NON_MOTORIST_LOCATION)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$NON_MOTORIST_LOCATION
## X-squared = 6129.5, df = 2, p-value &lt; 2.2e-16</code></pre>
<p>Por un lado, en lo que respecta los accidentes sufridos por motoristas, se registran muchas más muertes en carreteras que no son intersecciones (“Non_Intersection”) en comparación con los accidentes que se producen en los cruces (“intersection”). Además, en ambos casos, los accidentes producen muchas más muertes que supervivientes. Por otro lado, en el caso de que los accidentados sean no motoristas, los casos registrados de personas que sobreviven es mucho mayor respecto a los que tienen como consecuencia la muerte. Un factor muy notable, es que la proporción de supervivientes en los accidentados no motoristas es enorme en comparación con la de motoristas, lo que nos haría pensar que la peligrosidad de los accidentes en moto es mucho mayor y habría que tenerlo en cuenta.</p>
<hr />
</div>
<div id="analisis-police_reported_alcohol_involvement" class="section level3">
<h3><span class="header-section-number">2.3.12</span> Análisis <code>POLICE_REPORTED_ALCOHOL_INVOLVEMENT</code></h3>
<p>Esta variable recoge evidencias sobre la involucración del alcohol en las personas que formaron parte del accidente. Esta variable puede tomar los siguientes valores.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>POLICE_REPORTED_ALCOHOL_INVOLVEMENT)</code></pre></div>
<pre><code>## df$POLICE_REPORTED_ALCOHOL_INVOLVEMENT 
##        n  missing distinct 
##   100968        0        4 
##                                                               
## Value                             NO              Not_reported
## Frequency                      34810                     45448
## Proportion                     0.345                     0.450
##                                                               
## Value      Unknown_(Police_Reported)                       YES
## Frequency                      10799                      9911
## Proportion                     0.107                     0.098</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>POLICE_REPORTED_ALCOHOL_INVOLVEMENT =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>POLICE_REPORTED_ALCOHOL_INVOLVEMENT, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;NO&quot;</span>,<span class="st">&quot;YES&quot;</span>)))

mylogit12 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>POLICE_REPORTED_ALCOHOL_INVOLVEMENT , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit12)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ POLICE_REPORTED_ALCOHOL_INVOLVEMENT, 
##     family = &quot;binomial&quot;, data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.4229  -1.4229   0.9503   0.9503   1.3979  
## 
## Coefficients:
##                                        Estimate Std. Error z value
## (Intercept)                             0.56085    0.01116   50.27
## POLICE_REPORTED_ALCOHOL_INVOLVEMENTYES -1.06562    0.02359  -45.18
##                                        Pr(&gt;|z|)    
## (Intercept)                              &lt;2e-16 ***
## POLICE_REPORTED_ALCOHOL_INVOLVEMENTYES   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 60707  on 44598  degrees of freedom
## Residual deviance: 58591  on 44597  degrees of freedom
##   (56369 observations deleted due to missingness)
## AIC: 58595
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(POLICE_REPORTED_ALCOHOL_INVOLVEMENT,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/12POLICE_REPORTED_ALCOHOL_INVOLVEMENT-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(POLICE_REPORTED_ALCOHOL_INVOLVEMENT,<span class="dt">fill=</span>SEX) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/12POLICE_REPORTED_ALCOHOL_INVOLVEMENT-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>POLICE_REPORTED_ALCOHOL_INVOLVEMENT)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  df$INJURY_SEVERITY and df$POLICE_REPORTED_ALCOHOL_INVOLVEMENT
## X-squared = 2133.3, df = 1, p-value &lt; 2.2e-16</code></pre>
<p>Se podría deducir, de este gráfico de barras, que la ingesta de alcohol aumenta notablemente la probabilidad de muerte en caso de accidente. Por consiguiente, los hombres tienen muchos más accidentes que las mujeres. En resumen, la ingesta de alcohol es determinante.</p>
<hr />
</div>
<div id="analisis-method_alcohol_determination" class="section level3">
<h3><span class="header-section-number">2.3.13</span> Análisis <code>METHOD_ALCOHOL_DETERMINATION</code></h3>
<p>Esta variable recoge el método por el cual la policía determinó si el alcohol intervino o no en el accidente. Esta variable puede tomar los siguiente valores</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">unique</span>(df<span class="op">$</span>METHOD_ALCOHOL_DETERMINATION)</code></pre></div>
<pre><code>## [1] NOAp  OTHER ET    OBS   PBT   BV    PAS  
## Levels: BV ET NOAp OBS OTHER PAS PBT</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>METHOD_ALCOHOL_DETERMINATION =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>METHOD_ALCOHOL_DETERMINATION, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>,<span class="st">&quot;ET&quot;</span>, <span class="st">&quot;OBS&quot;</span>, <span class="st">&quot;OTHER&quot;</span>, <span class="st">&quot;PBT&quot;</span>, <span class="st">&quot;BV&quot;</span>,<span class="st">&quot;PAS&quot;</span>))

<span class="co"># Regresión logistica con respecto a grado de afecto</span>
mylogit13 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>METHOD_ALCOHOL_DETERMINATION , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit13)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ METHOD_ALCOHOL_DETERMINATION, 
##     family = &quot;binomial&quot;, data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.9222  -0.9718   0.1678   0.9279   1.4856  
## 
## Coefficients:
##                                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                       -0.50500    0.02413 -20.932  &lt; 2e-16 ***
## METHOD_ALCOHOL_DETERMINATIONOBS    1.12491    0.03471  32.413  &lt; 2e-16 ***
## METHOD_ALCOHOL_DETERMINATIONOTHER -0.19547    0.06519  -2.999  0.00271 ** 
## METHOD_ALCOHOL_DETERMINATIONPBT    4.76061    0.31919  14.915  &lt; 2e-16 ***
## METHOD_ALCOHOL_DETERMINATIONBV     2.47020    0.16277  15.176  &lt; 2e-16 ***
## METHOD_ALCOHOL_DETERMINATIONPAS    2.49743    0.61593   4.055 5.02e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 23121  on 16711  degrees of freedom
## Residual deviance: 20794  on 16706  degrees of freedom
##   (84256 observations deleted due to missingness)
## AIC: 20806
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(METHOD_ALCOHOL_DETERMINATION,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/13METHOD_ALCOHOL_DETERMINATION-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>METHOD_ALCOHOL_DETERMINATION)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$METHOD_ALCOHOL_DETERMINATION
## X-squared = 2077.2, df = 5, p-value &lt; 2.2e-16</code></pre>
<hr />
</div>
<div id="analisis-alcohol_test_type" class="section level3">
<h3><span class="header-section-number">2.3.14</span> Análisis <code>ALCOHOL_TEST_TYPE</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>ALCOHOL_TEST_TYPE)</code></pre></div>
<pre><code>## df$ALCOHOL_TEST_TYPE 
##        n  missing distinct 
##    91158     9810        9 
##                                                                 
## Value         BC   BPS    BB     L   NoT OTHER     U     V    WB
## Frequency      3    92  1447    18 55405   268   231   144 33550
## Proportion 0.000 0.001 0.016 0.000 0.608 0.003 0.003 0.002 0.368</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(<span class="kw">summary</span> (df<span class="op">$</span>ALCOHOL_TEST_TYPE), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##   NoT    WB  NA&#39;s    BB OTHER     U     V   BPS     L    BC 
## 55405 33550  9810  1447   268   231   144    92    18     3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>ALCOHOL_TEST_TYPE =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>ALCOHOL_TEST_TYPE, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;NoT&quot;</span>,<span class="st">&quot;WB&quot;</span>,<span class="ot">NA</span>, <span class="st">&quot;BB&quot;</span>,<span class="st">&quot;OTHER&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;V&quot;</span>,<span class="st">&quot;BPS&quot;</span>, <span class="st">&quot;L&quot;</span>, <span class="st">&quot;BC&quot;</span>))

<span class="co"># Regresión logistica</span>
mylogit14 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>ALCOHOL_TEST_TYPE , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit14)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ ALCOHOL_TEST_TYPE, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.7712  -0.7347   0.6783   0.6783   2.9246  
## 
## Coefficients:
##                         Estimate Std. Error  z value Pr(&gt;|z|)    
## (Intercept)              1.35229    0.01059  127.655  &lt; 2e-16 ***
## ALCOHOL_TEST_TYPEWB     -2.52403    0.01666 -151.496  &lt; 2e-16 ***
## ALCOHOL_TEST_TYPEBB      2.46578    0.18188   13.557  &lt; 2e-16 ***
## ALCOHOL_TEST_TYPEOTHER  -2.63895    0.14871  -17.745  &lt; 2e-16 ***
## ALCOHOL_TEST_TYPEU      -1.35229    0.13230  -10.221  &lt; 2e-16 ***
## ALCOHOL_TEST_TYPEV      -5.61497    0.71215   -7.885 3.16e-15 ***
## ALCOHOL_TEST_TYPEBPS    -2.91043    0.27526  -10.573  &lt; 2e-16 ***
## ALCOHOL_TEST_TYPEL     -12.91834   46.42573   -0.278   0.7808    
## ALCOHOL_TEST_TYPEBC     -2.04544    1.22479   -1.670   0.0949 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 122453  on 90263  degrees of freedom
## Residual deviance:  93092  on 90255  degrees of freedom
##   (10704 observations deleted due to missingness)
## AIC: 93110
## 
## Number of Fisher Scoring iterations: 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(ALCOHOL_TEST_TYPE,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>ALCOHOL_TEST_TYPE)</code></pre></div>
<pre><code>## Warning in chisq.test(df$INJURY_SEVERITY, df$ALCOHOL_TEST_TYPE): Chi-
## squared approximation may be incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$ALCOHOL_TEST_TYPE
## X-squared = 27994, df = 8, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>ALCOHOL_TEST_TYPE =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>ALCOHOL_TEST_TYPE, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;NoT&quot;</span>,<span class="st">&quot;WB&quot;</span>,<span class="ot">NA</span>, <span class="st">&quot;BB&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;V&quot;</span>,<span class="st">&quot;BPS&quot;</span>))

<span class="co"># Regresión logistica</span>
mylogit14 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>ALCOHOL_TEST_TYPE , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit14)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ ALCOHOL_TEST_TYPE, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.7712  -0.7347   0.6783   0.6783   2.9246  
## 
## Coefficients:
##                      Estimate Std. Error  z value Pr(&gt;|z|)    
## (Intercept)           1.35229    0.01059  127.655  &lt; 2e-16 ***
## ALCOHOL_TEST_TYPEWB  -2.52403    0.01666 -151.496  &lt; 2e-16 ***
## ALCOHOL_TEST_TYPEBB   2.46578    0.18187   13.558  &lt; 2e-16 ***
## ALCOHOL_TEST_TYPEU   -1.35229    0.13230  -10.221  &lt; 2e-16 ***
## ALCOHOL_TEST_TYPEV   -5.61497    0.71172   -7.889 3.04e-15 ***
## ALCOHOL_TEST_TYPEBPS -2.91043    0.27526  -10.573  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 121984  on 89974  degrees of freedom
## Residual deviance:  92808  on 89969  degrees of freedom
##   (10993 observations deleted due to missingness)
## AIC: 92820
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(ALCOHOL_TEST_TYPE,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>ALCOHOL_TEST_TYPE)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$ALCOHOL_TEST_TYPE
## X-squared = 27841, df = 5, p-value &lt; 2.2e-16</code></pre>
<hr />
</div>
<div id="analisis-alcohol_test_result" class="section level3">
<h3><span class="header-section-number">2.3.15</span> Análisis <code>ALCOHOL_TEST_RESULT</code></h3>
<p>Esta variable identifica el resultados del test que se llevo a la persona involucrada en el accidente. Los tests se basan en la tasa de alcohol en sangre (blood alcohol concentration (BAC)), que viene expresado en gramos de alcohol por decilitro (g/dL).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>ALCOHOL_TEST_RESULT)</code></pre></div>
<pre><code>## df$ALCOHOL_TEST_RESULT 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##   100968        0       69    0.827    68.02    40.23        0        0 
##      .25      .50      .75      .90      .95 
##       15       96       96       97       99 
## 
## lowest :  0  1  2  3  4, highest: 81 95 96 97 99</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(df<span class="op">$</span>ALCOHOL_TEST_RESULT)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    0.00   15.00   96.00   68.02   96.00   99.00</code></pre>
<p>Podemos representar gráficamente el número de accidentes por la edad de la persona involucrada en el accidente: <img src="FARS18052_files/figure-html/unnamed-chunk-23-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>Como se puede observar, esta variable toma valores enteros entre 0 y 99. En la siguiente tabla resumimos el significado de estos valores</p>
<table>
<thead>
<tr class="header">
<th>Resultado test alcohol</th>
<th>Explicación</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>00-93</td>
<td>Valor real del test BAC</td>
</tr>
<tr class="even">
<td>94</td>
<td>.94 or valores superiores</td>
</tr>
<tr class="odd">
<td>95</td>
<td>Test rechazado</td>
</tr>
<tr class="even">
<td>96</td>
<td>Test no ofrecido</td>
</tr>
<tr class="odd">
<td>97</td>
<td>AC Test realizado, Resultado desconocidos</td>
</tr>
<tr class="even">
<td>99</td>
<td>Desconocido si el conductor paso el test</td>
</tr>
</tbody>
</table>
<p>Podemos estudiar en detalle el nivel de alcoholismo de las personas involucradas en el accidente eliminado los valores extremos, 0 y &gt;94</p>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-24-1.png" width="1440" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>ALCOHOL_TEST_RESULT[<span class="kw">which</span>(df<span class="op">$</span>ALCOHOL_TEST_RESULT <span class="op">&gt;</span><span class="dv">95</span>)] &lt;-<span class="ot">NA</span>

<span class="co"># Regresión logistica</span>
mylogit15 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>ALCOHOL_TEST_RESULT , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit15)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ ALCOHOL_TEST_RESULT, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.8017  -0.8017  -0.7443   1.6072   2.4739  
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)         -0.970172   0.014969  -64.81   &lt;2e-16 ***
## ALCOHOL_TEST_RESULT -0.021495   0.001437  -14.96   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 35835  on 31807  degrees of freedom
## Residual deviance: 35585  on 31806  degrees of freedom
##   (69160 observations deleted due to missingness)
## AIC: 35589
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(ALCOHOL_TEST_RESULT,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<pre><code>## Warning: Removed 69104 rows containing non-finite values (stat_count).</code></pre>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>ALCOHOL_TEST_RESULT)</code></pre></div>
<pre><code>## Warning in chisq.test(df$INJURY_SEVERITY, df$ALCOHOL_TEST_RESULT): Chi-
## squared approximation may be incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$ALCOHOL_TEST_RESULT
## X-squared = 919.79, df = 65, p-value &lt; 2.2e-16</code></pre>
<p>Los valores máximos de alcoholemia se centran en tordo a 16-18 g/dL, el triple de lo permitido por la ley en EE.UU (0.5-0.8 g/dL).</p>
<p>En este caso empezamos por cambiar los posibles valores de la variable. Para ello tendremos en consideración la siguiente información: “State laws in 21 states make it a criminal offense to operate a motor vehicle at a blood alcohol concentration (BAC) of 0.10 g/dl. Twenty-nine states and the District of Columbia have adopted 0.08 g/dl. One state and Puerto Rico do not have illegal per se BAC levels.” Teniendo en cuenta la anterior información cambiamos los valores de la variable <em>ALCOHOL_TEST_RESULT</em> pero simplicando la clasificación y considrando un resultado mayor que 0 como positivo.</p>
<table>
<thead>
<tr class="header">
<th>BAC (g/dl)</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>00</td>
<td>Negative_alcohol</td>
</tr>
<tr class="even">
<td>01 - 94</td>
<td>Positive_alcohol</td>
</tr>
<tr class="odd">
<td>95 –</td>
<td>NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#conversión a binomial de la variable ALCOHOL_TEST_RESULT1  </span>
<span class="kw">summary</span>(df<span class="op">$</span>ALCOHOL_TEST_RESULT)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##    0.00    0.00    0.00    6.35   12.00   95.00   69104</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>ALCOHOL_TEST_RESULT[<span class="kw">which</span>(df<span class="op">$</span>ALCOHOL_TEST_RESULT <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)] &lt;-<span class="st">&#39;Positive_alcohol&#39;</span> 
df<span class="op">$</span>ALCOHOL_TEST_RESULT[<span class="kw">which</span>(df<span class="op">$</span>ALCOHOL_TEST_RESULT <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)] &lt;-<span class="st">&#39;Negative_alcohol&#39;</span>
df<span class="op">$</span>ALCOHOL_TEST_RESULT1 &lt;-<span class="st"> </span><span class="kw">as.factor</span>(df<span class="op">$</span>ALCOHOL_TEST_RESULT)

<span class="kw">str</span>(df<span class="op">$</span>ALCOHOL_TEST_RESULT1)</code></pre></div>
<pre><code>##  Factor w/ 2 levels &quot;Negative_alcohol&quot;,..: NA NA NA NA NA NA NA NA NA 1 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(df<span class="op">$</span>ALCOHOL_TEST_RESULT1)</code></pre></div>
<pre><code>## Negative_alcohol Positive_alcohol             NA&#39;s 
##            19798            12066            69104</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># VERIFICACIONES CON LA VARIABLE TRANSFORMADA</span>
<span class="co"># Regresión logistica</span>
mylogit151 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>ALCOHOL_TEST_RESULT1 , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit151)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ ALCOHOL_TEST_RESULT1, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.8119  -0.8119  -0.6714   1.5938   1.7892  
## 
## Coefficients:
##                                      Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)                          -0.94050    0.01583  -59.42   &lt;2e-16
## ALCOHOL_TEST_RESULT1Positive_alcohol -0.43473    0.02768  -15.71   &lt;2e-16
##                                         
## (Intercept)                          ***
## ALCOHOL_TEST_RESULT1Positive_alcohol ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 35835  on 31807  degrees of freedom
## Residual deviance: 35581  on 31806  degrees of freedom
##   (69160 observations deleted due to missingness)
## AIC: 35585
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(ALCOHOL_TEST_RESULT1,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>ALCOHOL_TEST_RESULT1)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  df$INJURY_SEVERITY and df$ALCOHOL_TEST_RESULT1
## X-squared = 248.22, df = 1, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[<span class="kw">which</span>(df<span class="op">$</span>ALCOHOL_TEST_RESULT1<span class="op">==</span><span class="st">&#39;Negative_alcohol&#39;</span>),]</code></pre></div>
<p>El número de fallecidos es siempre mayor independiente del grado de embriaguez de la persona involucrada en el accidente. De hecho el número de fallecidos sobrios supera levemente al número de personas involucradas ebrias, teniendo en cuenta el número relativo entre ambos.</p>
<p>Podemos estudiar la distribución de la embriaguez de la persona involucrada en el accidente en función de su edad <img src="FARS18052_files/figure-html/unnamed-chunk-27-1.png" width="1440" style="display: block; margin: auto;" /> En este caso se observa que el pico en el consumo de alcohol se desplaza hasta los 21, edad en la que es legal el consumo de alcohol. Sorprende que se hicieran test de alcoholemia a personas comprendidas entre los 0 y los 14 años.</p>
<hr />
</div>
<div id="analisis-police_reported_drug_involvement" class="section level3">
<h3><span class="header-section-number">2.3.16</span> Análisis <code>POLICE_REPORTED_DRUG_INVOLVEMENT</code></h3>
<p>Esta variable recoge evidencias sobre la involucración de drogas en las personas que formaron parte del accidente. No incluye nicotina, aspirina, alcohol o drogas suministradas después del accidente. Esta variable puede tomar los siguientes valores.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>POLICE.REPORTED_DRUG_INVOLVEMENT)</code></pre></div>
<pre><code>## df$POLICE.REPORTED_DRUG_INVOLVEMENT 
##        n  missing distinct 
##    94686     6282        3 
##                             
## Value        Yes    No NoRep
## Frequency   1626 18335 74725
## Proportion 0.017 0.194 0.789</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>POLICE.REPORTED_DRUG_INVOLVEMENT =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>POLICE.REPORTED_DRUG_INVOLVEMENT, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;NoRep&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>))


<span class="co"># Regresión logistica</span>
mylogit16 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>POLICE.REPORTED_DRUG_INVOLVEMENT , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit16)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ POLICE.REPORTED_DRUG_INVOLVEMENT, 
##     family = &quot;binomial&quot;, data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.3668  -1.3668   0.9991   0.9991   1.4686  
## 
## Coefficients:
##                                      Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)                          0.435006   0.007527  57.791  &lt; 2e-16
## POLICE.REPORTED_DRUG_INVOLVEMENTNo  -0.129659   0.016750  -7.741 9.88e-15
## POLICE.REPORTED_DRUG_INVOLVEMENTYes -1.097751   0.052981 -20.720  &lt; 2e-16
##                                        
## (Intercept)                         ***
## POLICE.REPORTED_DRUG_INVOLVEMENTNo  ***
## POLICE.REPORTED_DRUG_INVOLVEMENTYes ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 126655  on 93893  degrees of freedom
## Residual deviance: 126156  on 93891  degrees of freedom
##   (7074 observations deleted due to missingness)
## AIC: 126162
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(POLICE.REPORTED_DRUG_INVOLVEMENT,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/16POLICE.REPORTED_DRUG_INVOLVEMENT-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>POLICE.REPORTED_DRUG_INVOLVEMENT)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$POLICE.REPORTED_DRUG_INVOLVEMENT
## X-squared = 509.39, df = 2, p-value &lt; 2.2e-16</code></pre>
<p><strong>De este gráfico se podría deducir que el hecho de que la policía notifique que se han tomado drogas, no relevancia respecto a la variable respuesta</strong></p>
<hr />
</div>
<div id="analisis-method_of_drug_determination" class="section level3">
<h3><span class="header-section-number">2.3.17</span> Análisis <code>METHOD_OF_DRUG_DETERMINATION</code></h3>
<p>Esta variable recoge evidencias sobre la involucración de drogas en las personas que formaron parte del accidente. No incluye nicotina, aspirina, alcohol o drogas suministradas después del accidente. Esta variable puede tomar los siguientes valores.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>METHOD_OF_DRUG_DETERMINATION)</code></pre></div>
<pre><code>## df$METHOD_OF_DRUG_DETERMINATION 
##        n  missing distinct 
##   100968        0        5 
##                                         
## Value          B   DRT    ET NoRep Other
## Frequency    621   117  2675 94794  2761
## Proportion 0.006 0.001 0.026 0.939 0.027</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>METHOD_OF_DRUG_DETERMINATION =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>METHOD_OF_DRUG_DETERMINATION, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;NoRep&quot;</span>, <span class="st">&quot;Other&quot;</span>, <span class="st">&quot;ET&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;DRT&quot;</span>))

<span class="co"># Regresión logistica</span>
mylogit17 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>METHOD_OF_DRUG_DETERMINATION , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit17)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ METHOD_OF_DRUG_DETERMINATION, 
##     family = &quot;binomial&quot;, data = df)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -2.175  -1.325   1.037   1.037   1.588  
## 
## Coefficients:
##                                    Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)                        0.340338   0.006632  51.319  &lt; 2e-16
## METHOD_OF_DRUG_DETERMINATIONOther -0.080541   0.038987  -2.066   0.0388
## METHOD_OF_DRUG_DETERMINATIONET    -1.268201   0.043471 -29.173  &lt; 2e-16
## METHOD_OF_DRUG_DETERMINATIONB      1.472276   0.115821  12.712  &lt; 2e-16
## METHOD_OF_DRUG_DETERMINATIONDRT    1.925206   0.316791   6.077 1.22e-09
##                                      
## (Intercept)                       ***
## METHOD_OF_DRUG_DETERMINATIONOther *  
## METHOD_OF_DRUG_DETERMINATIONET    ***
## METHOD_OF_DRUG_DETERMINATIONB     ***
## METHOD_OF_DRUG_DETERMINATIONDRT   ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 135884  on 99767  degrees of freedom
## Residual deviance: 134626  on 99763  degrees of freedom
##   (1200 observations deleted due to missingness)
## AIC: 134636
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(METHOD_OF_DRUG_DETERMINATION,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/17METHOD_OF_DRUG_DETERMINATION-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>METHOD_OF_DRUG_DETERMINATION)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$METHOD_OF_DRUG_DETERMINATION
## X-squared = 1219.8, df = 4, p-value &lt; 2.2e-16</code></pre>
<p>El test de orina puede ser muy efectivo, porque el número de personas a las que se les ha hecho el test de orina que han sobrevivido, es muy alto.</p>
<hr />
</div>
<div id="analisis-drug_test_type" class="section level3">
<h3><span class="header-section-number">2.3.18</span> Análisis <code>DRUG_TEST_TYPE</code></h3>
<p>Esta variable hace referencia al tipo de test que se llevó a cabo en un laboratorio para obtener información sobre la presencia de droga. Esta variable puede tomar los siguientes valores.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>DRUG_TEST_TYPE)</code></pre></div>
<pre><code>## df$DRUG_TEST_TYPE 
##        n  missing distinct 
##    85163    15805        5 
##                                                   
## Value        Btest  BUtest no_test   Xtest   Utest
## Frequency    16153    1422   64072    1544    1972
## Proportion   0.190   0.017   0.752   0.018   0.023</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>DRUG_TEST_TYPE =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>DRUG_TEST_TYPE, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;notest&quot;</span>,<span class="st">&quot;Btest&quot;</span>,<span class="st">&quot;Utest&quot;</span>,<span class="st">&quot;Xtest&quot;</span>, <span class="st">&quot;BUtest&quot;</span>)))

<span class="co"># Regresión logistica con respecto a grado de afecto</span>
mylogit18 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>DRUG_TEST_TYPE, <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit18)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ DRUG_TEST_TYPE, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.9047  -0.5934  -0.5934  -0.5934   1.9199  
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          -1.64777    0.02142 -76.941   &lt;2e-16 ***
## DRUG_TEST_TYPEUtest   0.96602    0.05228  18.478   &lt;2e-16 ***
## DRUG_TEST_TYPEXtest   0.73918    0.06022  12.276   &lt;2e-16 ***
## DRUG_TEST_TYPEBUtest -0.02287    0.07576  -0.302    0.763    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 20264  on 21041  degrees of freedom
## Residual deviance: 19847  on 21038  degrees of freedom
##   (79926 observations deleted due to missingness)
## AIC: 19855
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(DRUG_TEST_TYPE,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/18DRUG_TEST_TYPE-1.png" width="672" /> Según los p-valores, las categorías más relevantes respecto de la variable respuesta son:“Utest” y “Xtest”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#realizamos un Chi sq test para ver si la variable es representativa respecto a la variable respuesta, en principio no lo es</span>
<span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>DRUG_TEST_TYPE)</code></pre></div>
<pre><code>##           
##            notest Btest Utest Xtest BUtest
##   Died          0 13508  1309  1099   1196
##   Survived      0  2600   662   443    225</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>DRUG_TEST_TYPE)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$DRUG_TEST_TYPE
## X-squared = 466.83, df = 3, p-value &lt; 2.2e-16</code></pre>
<hr />
</div>
<div id="analisis-drug_test_results_.1_of_3." class="section level3">
<h3><span class="header-section-number">2.3.19</span> Análisis <code>DRUG_TEST_RESULTS_.1_of_3.</code></h3>
<p>Esta variable hace referencia al resultado del test de drogas que se llevo sobre la persona involucrada en el accidente.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.)</code></pre></div>
<pre><code>## df$DRUG_TEST_RESULTS_.1_of_3. 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##   100968        0       95    0.738    207.4    328.3        0        0 
##      .25      .50      .75      .90      .95 
##        0        0        1      999      999 
## 
## lowest :   0   1 100 106 115, highest: 900 996 997 998 999</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_1_of_<span class="dv">3</span>)</code></pre></div>
<pre><code>## NULL</code></pre>
<p>Como se puede observar, esta variable toma valores enteros entre 0 y 999. Los valores que pueden tomar estas variables vienen resumidos en la siguiente tabla:</p>
<table>
<thead>
<tr class="header">
<th>Valor</th>
<th>Descripción</th>
<th>Valor reducido</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>000</td>
<td>Not Tested For Drugs</td>
<td>Unknown</td>
</tr>
<tr class="even">
<td>001</td>
<td>No Drugs Reported</td>
<td>No_Drug</td>
</tr>
<tr class="odd">
<td>100-295</td>
<td>Narcotic Drug</td>
<td>Narcotic</td>
</tr>
<tr class="even">
<td>300-395</td>
<td>Depressant Drug</td>
<td>Depressant</td>
</tr>
<tr class="odd">
<td>400-495</td>
<td>Stimulant Drug</td>
<td>Stimulant</td>
</tr>
<tr class="even">
<td>500-595</td>
<td>Hallucinogen Drug</td>
<td>Hallucinogen</td>
</tr>
<tr class="odd">
<td>600-695</td>
<td>Cannabinoid Drug</td>
<td>Cannabinoid</td>
</tr>
<tr class="even">
<td>700-795</td>
<td>Phencyclidine (PCP)</td>
<td>Phencyclidine</td>
</tr>
<tr class="odd">
<td>800-895</td>
<td>Anabolic Steroid</td>
<td>Anabolic_Steroid</td>
</tr>
<tr class="even">
<td>900-995</td>
<td>Inhalant Drug</td>
<td>Inhalant</td>
</tr>
<tr class="odd">
<td>997</td>
<td>Tested For Drugs, Results Unknown</td>
<td>Unknown</td>
</tr>
<tr class="even">
<td>998</td>
<td>Tested For Drugs, Drugs Found, Type Unknown</td>
<td>Other_Drug</td>
</tr>
<tr class="odd">
<td>999</td>
<td>Unknown If Tested for Drug</td>
<td>Unknown</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(INJURY_SEVERITY,DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>., <span class="dt">colour=</span>INJURY_SEVERITY)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_density</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;1º drug test results vs injury&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-29-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Comparación con otras variables</span>

p1e &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>( PERSON_TYPE, DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size=</span><span class="dv">6</span>)) 
  
p2e &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>( SEX, DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size=</span><span class="dv">6</span>)) 

p3e &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(RESTRAINT_SYSTEM.USE , DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size=</span><span class="dv">6</span>))

p4e &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(HISPANIC_ORIGIN,DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">5</span>,<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))

p5e &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(RACE,DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">5</span>,<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))


<span class="kw">theme_set</span>(<span class="kw">theme_cowplot</span>(<span class="dt">font_size=</span><span class="dv">12</span>))
<span class="kw">plot_grid</span>(p1e,p2e,p3e,p4e,p5e,
          <span class="dt">rel_widths=</span><span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">25</span>),<span class="dt">rel_heights=</span><span class="kw">c</span>(<span class="dv">80</span>,<span class="dv">50</span>),  <span class="dt">label_size =</span> <span class="dv">10</span>,
          <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-29-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_grid</span>(p4e,p5e,
          <span class="dt">rel_widths=</span><span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">25</span>),<span class="dt">rel_heights=</span><span class="kw">c</span>(<span class="dv">80</span>,<span class="dv">50</span>),  <span class="dt">label_size =</span> <span class="dv">10</span>,
          <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-29-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Histograma para ver el número de valores faltantes</span>

<span class="kw">hist</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.)</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-29-5.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">which</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.<span class="op">==</span><span class="dv">0</span>))</code></pre></div>
<pre><code>## [1] 64072</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#DRUG_TEST_RESULTS_.1_of_3.</span>
<span class="co">#En el histograma inicial vemos que tenemos gran cantidad de resultados superiores a 900</span>
<span class="co">#Agrupamos los valores para una clasificación negativo en resultado de droga, positivo y 999 - NA (como nos indica la tabla de codificación de los datos)</span>
z =<span class="st"> </span><span class="kw">cut</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>., <span class="kw">c</span>(<span class="kw">min</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">998.9</span>, <span class="kw">max</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.)))
<span class="kw">table</span>(z)</code></pre></div>
<pre><code>## z
##    (-1,0.1] (0.1,998.9] (998.9,999] 
##       64072       21081       15815</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#comparamos los resulatdos con el método de detección de la droga en el caso del valor 999 y observamos que 15804 de #los valores no tienen identificado ningún tipo de metodo. Consideramos como NA los valores identificados</span>
dr1 =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.,DRUG_TEST_TYPE) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.<span class="op">==</span><span class="dv">999</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(DRUG_TEST_TYPE) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">n=</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(n))
<span class="kw">table</span>(dr1)</code></pre></div>
<pre><code>##               n
## DRUG_TEST_TYPE 1 10 15804
##         notest 0  0     0
##         Btest  0  1     0
##         Utest  0  0     0
##         Xtest  0  0     0
##         BUtest 1  0     0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Consideramos el valor 999 como un NA</span>
df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.[<span class="kw">which</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>. <span class="op">==</span><span class="st"> </span><span class="dv">999</span>)] &lt;-<span class="ot">NA</span> 
<span class="kw">summary</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##    0.00    0.00    0.00   60.37    0.00  998.00   15815</code></pre>
<hr />
</div>
<div id="analisis-drug_test_type_.2_of_3." class="section level3">
<h3><span class="header-section-number">2.3.20</span> Análisis <code>DRUG_TEST_TYPE_.2_of_3.</code></h3>
<p>Esta variable hace referencia al tipo de test que se llevó a cabo para obtener información sobre la presencia de droga.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>DRUG_TEST_TYPE_.2_of_<span class="dv">3</span>.)</code></pre></div>
<pre><code>## df$DRUG_TEST_TYPE_.2_of_3. 
##        n  missing distinct 
##    91724     9244        5 
##                                                   
## Value        Btest  BUtest no_test   Xtest   Utest
## Frequency     1743     213   89270     145     353
## Proportion   0.019   0.002   0.973   0.002   0.004</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>DRUG_TEST_TYPE_.2_of_<span class="dv">3</span>. =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>DRUG_TEST_TYPE_.2_of_<span class="dv">3</span>., <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;notest&quot;</span>,<span class="st">&quot;Btest&quot;</span>, <span class="st">&quot;Utest&quot;</span>, <span class="st">&quot;BUtest&quot;</span>, <span class="st">&quot;Xtest&quot;</span>)))

<span class="co"># Regresión logistica con respecto a grado de afecto</span>
mylogit20 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>DRUG_TEST_TYPE_.2_of_<span class="dv">3</span>., <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit20)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ DRUG_TEST_TYPE_.2_of_3., family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.6964  -0.5936  -0.5936  -0.5103   2.3578  
## 
## Coefficients:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                   -1.64699    0.06562 -25.100  &lt; 2e-16 ***
## DRUG_TEST_TYPE_.2_of_3.Utest   0.35371    0.14517   2.437  0.01483 *  
## DRUG_TEST_TYPE_.2_of_3.BUtest -0.32602    0.21935  -1.486  0.13720    
## DRUG_TEST_TYPE_.2_of_3.Xtest  -1.06844    0.35038  -3.049  0.00229 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2132.7  on 2425  degrees of freedom
## Residual deviance: 2109.9  on 2422  degrees of freedom
##   (98542 observations deleted due to missingness)
## AIC: 2117.9
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(DRUG_TEST_TYPE_.2_of_<span class="dv">3</span>.,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/20DRUG_TEST_TYPE_.2_of_3.-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>DRUG_TEST_TYPE_.2_of_<span class="dv">3</span>.)</code></pre></div>
<pre><code>##           
##            notest Btest Utest BUtest Xtest
##   Died          0  1438   277    187   136
##   Survived      0   277    76     26     9</code></pre>
<p>Si el 88,4% de los implicados en los accidentes no han pasado ningún segundo test de drogas por lo tanto se desconoce si estaba bajo la influencia de las drogas y será considerado NA, se propone la eliminación de la variable del estudio por no representativa para nuestra pregunta.</p>
<hr />
</div>
<div id="analisis-drug_test_results_.2_of_3." class="section level3">
<h3><span class="header-section-number">2.3.21</span> Análisis <code>DRUG_TEST_RESULTS_.2_of_3.</code></h3>
<p>Esta variable hace referencia al resultado del test de drogas que se llevo sobre la persona involucrada en el accidente.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.)</code></pre></div>
<pre><code>## df$DRUG_TEST_RESULTS_.2_of_3. 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##   100968        0       73    0.308    100.1    180.1        0        0 
##      .25      .50      .75      .90      .95 
##        0        0        0      417      999 
## 
## lowest :   0   1 100 117 128, highest: 900 996 997 998 999</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(INJURY_SEVERITY,DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/21DRUG_TEST_RESULTS_.2_of_3.-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>., <span class="dt">colour=</span>INJURY_SEVERITY)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_density</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;2º drug test results vs injury&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/21DRUG_TEST_RESULTS_.2_of_3.-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Comparación con otras variables</span>


p1d &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>( PERSON_TYPE, DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size=</span><span class="dv">6</span>)) 
    

p2d &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>( SEX, DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size=</span><span class="dv">6</span>)) 


p3d &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(RESTRAINT_SYSTEM.USE , DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size=</span><span class="dv">6</span>))


p4d &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(HISPANIC_ORIGIN,DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">5</span>,<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))

p5d &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(RACE,DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">5</span>,<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))


<span class="kw">theme_set</span>(<span class="kw">theme_cowplot</span>(<span class="dt">font_size=</span><span class="dv">12</span>))
<span class="kw">plot_grid</span>(p1d,p2d,p3d,p4d,p5d,
          <span class="dt">rel_widths=</span><span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">25</span>),<span class="dt">rel_heights=</span><span class="kw">c</span>(<span class="dv">80</span>,<span class="dv">50</span>),  <span class="dt">label_size =</span> <span class="dv">10</span>,
          <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/21DRUG_TEST_RESULTS_.2_of_3.-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_grid</span>(p4d,p5d,
          <span class="dt">rel_widths=</span><span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">25</span>),<span class="dt">rel_heights=</span><span class="kw">c</span>(<span class="dv">80</span>,<span class="dv">50</span>),  <span class="dt">label_size =</span> <span class="dv">10</span>,
          <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/21DRUG_TEST_RESULTS_.2_of_3.-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Histograma para ver el número de valores faltantes</span>

<span class="kw">hist</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.)</code></pre></div>
<p><img src="FARS18052_files/figure-html/21DRUG_TEST_RESULTS_.2_of_3.-5.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">which</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.<span class="op">==</span><span class="dv">0</span>))</code></pre></div>
<pre><code>## [1] 89270</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Relación entre el 2º test y los resultados del test</span>

<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(DRUG_TEST_TYPE_.2_of_<span class="dv">3</span>. ,<span class="dt">fill=</span>DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.) ) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>), <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/21DRUG_TEST_RESULTS_.2_of_3.-6.png" width="672" /> La variable muestra los resultados de los segundos test de drogas, que en este caso, como hemos visto anteriormente no se han realizado en un 88.4%. Siendo un 9,15% NA’s. Además 89.270 de los resultados tienen un valor igual a cero, mientras que los no testados son exactamente 89.270. Por lo tanto los datos serían relevantes sólo para el resto 2,7% de implicados en accidentes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#DRUG_TEST_RESULTS_.2_of_3.</span>
<span class="co">#En el histograma inicial vemos que tenemos gran cantidad de resultados superiores a 900</span>
<span class="co">#Agrupamos los valores para una clasificación negativo en resultado de droga, positivo y 999 -  NA</span>
zz =<span class="st"> </span><span class="kw">cut</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>., <span class="kw">c</span>(<span class="kw">min</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">998.9</span>, <span class="kw">max</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.)))
<span class="kw">table</span>(zz)</code></pre></div>
<pre><code>## zz
## (0.1,998.9] (998.9,999] 
##        2454        9244</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#comparamos los resulatdos con el método de detección de la droga en el caso del valor 999 y observamos que 9116 de #los valores no tienen identificado ningún tipo de metodo. No obstante hay varios valores con metodo identificado</span>
dr2 =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.,DRUG_TEST_TYPE) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.<span class="op">==</span><span class="dv">999</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(DRUG_TEST_TYPE) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">n=</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(n))
<span class="kw">table</span>(dr2)</code></pre></div>
<pre><code>##               n
## DRUG_TEST_TYPE 2 6 16 104 9116
##         notest 0 0  0   0    0
##         Btest  0 0  0   1    0
##         Utest  0 0  1   0    0
##         Xtest  0 1  0   0    0
##         BUtest 1 0  0   0    0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#consideramos los valores iguales a 999 como NA</span>
df<span class="op">$</span>DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.[<span class="kw">which</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>. <span class="op">==</span><span class="st"> </span><span class="dv">999</span>)] &lt;-<span class="ot">NA</span> 
<span class="kw">summary</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>.)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##     0.0     0.0     0.0   100.1     0.0   999.0</code></pre>
<hr />
</div>
<div id="analisis-drug_test_type_.3_of_3." class="section level3">
<h3><span class="header-section-number">2.3.22</span> Análisis <code>DRUG_TEST_TYPE_.3_of_3.</code></h3>
<p>Esta variable hace referencia al tipo de test que se llevó a cabo para obtener información sobre la presencia de droga.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>DRUG_TEST_TYPE_.3_of_<span class="dv">3</span>.)</code></pre></div>
<pre><code>## df$DRUG_TEST_TYPE_.3_of_3. 
##        n  missing distinct 
##    91720     9248        5 
##                                                   
## Value        Btest  BUtest no_test   Xtest   Utest
## Frequency     1068      84   90394      57     117
## Proportion   0.012   0.001   0.986   0.001   0.001</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>DRUG_TEST_TYPE_.3_of_<span class="dv">3</span>. =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>DRUG_TEST_TYPE_.3_of_<span class="dv">3</span>., <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;notest&quot;</span>,<span class="st">&quot;Btest&quot;</span>,<span class="st">&quot;Utest&quot;</span>,<span class="st">&quot;BUtest&quot;</span>,<span class="st">&quot;Xtest&quot;</span>)))

<span class="co"># Regresión logistica con respecto a grado de afecto</span>
mylogit22 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>DRUG_TEST_TYPE_.3_of_<span class="dv">3</span>. , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit22)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ DRUG_TEST_TYPE_.3_of_3., family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.7846  -0.6237  -0.6237  -0.6237   2.4267  
## 
## Coefficients:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                   -1.53850    0.08125 -18.935   &lt;2e-16 ***
## DRUG_TEST_TYPE_.3_of_3.Utest   0.51814    0.22469   2.306   0.0211 *  
## DRUG_TEST_TYPE_.3_of_3.BUtest  0.01245    0.29624   0.042   0.9665    
## DRUG_TEST_TYPE_.3_of_3.Xtest  -1.35187    0.59869  -2.258   0.0239 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1222.2  on 1298  degrees of freedom
## Residual deviance: 1208.7  on 1295  degrees of freedom
##   (99669 observations deleted due to missingness)
## AIC: 1216.7
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(DRUG_TEST_TYPE_.3_of_<span class="dv">3</span>.,<span class="dt">fill=</span>INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/22drug%20test%20type%202-1.png" width="672" /></p>
<hr />
</div>
<div id="analisis-drug_test_results_.3_of_3." class="section level3">
<h3><span class="header-section-number">2.3.23</span> Análisis <code>DRUG_TEST_RESULTS_.3_of_3.</code></h3>
<p>Esta variable hace referencia al resultado del test de drogas que se llevo sobre la persona involucrada en el accidente.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.)</code></pre></div>
<pre><code>## df$DRUG_TEST_RESULTS_.3_of_3. 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##   100968        0       59    0.282    95.44    172.6        0        0 
##      .25      .50      .75      .90      .95 
##        0        0        0        1      999 
## 
## lowest :   0   1 100 136 145, highest: 924 996 997 998 999</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(INJURY_SEVERITY,DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/23DRUG_TEST_RESULTS_.3_of_3.-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>., <span class="dt">colour=</span>INJURY_SEVERITY)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_density</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;3º drug test results vs injury&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/23DRUG_TEST_RESULTS_.3_of_3.-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Comparación con otras variables</span>

p1d &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>( PERSON_TYPE, DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size=</span><span class="dv">6</span>)) 
    

p2d &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>( SEX, DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size=</span><span class="dv">6</span>)) 


p3d &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(RESTRAINT_SYSTEM.USE , DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size=</span><span class="dv">6</span>))


p4d &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(HISPANIC_ORIGIN,DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">5</span>,<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))

p5d &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(RACE,DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">5</span>,<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))


<span class="kw">theme_set</span>(<span class="kw">theme_cowplot</span>(<span class="dt">font_size=</span><span class="dv">12</span>))
<span class="kw">plot_grid</span>(p1d,p2d,p3d,p4d,p5d,
          <span class="dt">rel_widths=</span><span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">25</span>),<span class="dt">rel_heights=</span><span class="kw">c</span>(<span class="dv">80</span>,<span class="dv">50</span>),  <span class="dt">label_size =</span> <span class="dv">10</span>,
          <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/23DRUG_TEST_RESULTS_.3_of_3.-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_grid</span>(p4d,p5d,
          <span class="dt">rel_widths=</span><span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">25</span>),<span class="dt">rel_heights=</span><span class="kw">c</span>(<span class="dv">80</span>,<span class="dv">50</span>),  <span class="dt">label_size =</span> <span class="dv">10</span>,
          <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/23DRUG_TEST_RESULTS_.3_of_3.-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Histograma para ver el número de valores faltantes</span>

<span class="kw">hist</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.)</code></pre></div>
<p><img src="FARS18052_files/figure-html/23DRUG_TEST_RESULTS_.3_of_3.-5.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">which</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.<span class="op">==</span><span class="dv">0</span>))</code></pre></div>
<pre><code>## [1] 90394</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Relación entre el 3º test y los resultados del test</span>

<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(DRUG_TEST_TYPE_.3_of_<span class="dv">3</span>. ,<span class="dt">fill=</span>DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.) ) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>), <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/23DRUG_TEST_RESULTS_.3_of_3.-6.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#DRUG_TEST_RESULTS_.3_of_3.</span>
<span class="co">#En el histograma inicial vemos que tenemos gran cantidad de resultados superiores a 900</span>
<span class="co">#Agrupamos los valores para una clasificación negativo en resultado de droga, positivo y 999 - NA</span>
zzz =<span class="st"> </span><span class="kw">cut</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>., <span class="kw">c</span>(<span class="kw">min</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">998.9</span>, <span class="kw">max</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.)))
<span class="kw">table</span>(zzz)</code></pre></div>
<pre><code>## zzz
## (0.1,998.9] (998.9,999] 
##        1326        9248</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#comparamos los resulatdos con el método de detección de la droga en el caso del valor 999 y observamos que 9115 de los valores no tienen identificado ningún tipo de metodo. No obstante hay varios valores con metodo identificado</span>
dr3 =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.,DRUG_TEST_TYPE) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.<span class="op">==</span><span class="dv">999</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(DRUG_TEST_TYPE) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">n=</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(n))
<span class="kw">table</span>(dr3)</code></pre></div>
<pre><code>##               n
## DRUG_TEST_TYPE 2 6 17 108 9115
##         notest 0 0  0   0    0
##         Btest  0 0  0   1    0
##         Utest  0 0  1   0    0
##         Xtest  0 1  0   0    0
##         BUtest 1 0  0   0    0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#consideramos los valores iguales a 999 como NA</span>
df<span class="op">$</span>DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.[<span class="kw">which</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>. <span class="op">==</span><span class="st"> </span><span class="dv">999</span>)] &lt;-<span class="ot">NA</span> 
<span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>.)</code></pre></div>
<pre><code>##           
##                0     1   100   136   145   155   156   157   165   167
##   Died     36960   541     1     0     1     5     1     0     2     3
##   Survived 52495   135     0     2     0     2     0     1     1     0
##           
##              177   187   188   189   196   208   300   303   304   307
##   Died         7     8     1     3     1     5     3     1     4     1
##   Survived     1     0     0     1     0     0     0     1     2     0
##           
##              308   313   321   333   334   338   343   348   351   352
##   Died         1     0    17     0     2     1     9     4    24     1
##   Survived     0     1     4     1     0     0     1     0     4     0
##           
##              358   367   376   401   402   405   407   410   417   421
##   Died         4     1     5    16    14     1    25    23    30     1
##   Survived     0     0     3     2     0     0     0     1     5     0
##           
##              495   501   513   514   515   519   600   601   603   605
##   Died         3     1     5     0     2     1     9     1    13     4
##   Survived     0     0     0     1     1     0     3     0     6     7
##           
##              606   695   702   795   924   996   997   998   999
##   Died        27    33     4     1     1   171     7    16  4099
##   Survived    12    12     0     0     0    18     3     2  4915</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#renombrar y unificar las variables DRUG_TEST_RESULTS 1, 2 y 3 en una única variable positivo vs negativo en drogas</span>

df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.[<span class="kw">which</span>((df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>. <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">|</span><span class="st"> </span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>. <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">|</span><span class="st"> </span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>. <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>))] &lt;-<span class="st">&quot;Posd&quot;</span> 
df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.[<span class="kw">which</span>((df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>. <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.2_of_<span class="dv">3</span>. <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.3_of_<span class="dv">3</span>. <span class="op">==</span><span class="st"> </span><span class="dv">0</span>))] &lt;-<span class="st">&quot;Negd&quot;</span>
df<span class="op">$</span>DRUG_TEST_RESULTS &lt;-<span class="st"> </span><span class="kw">as.factor</span>(df<span class="op">$</span>DRUG_TEST_RESULTS_.1_of_<span class="dv">3</span>.)

<span class="kw">str</span>(df<span class="op">$</span>DRUG_TEST_RESULTS)</code></pre></div>
<pre><code>##  Factor w/ 2 levels &quot;Negd&quot;,&quot;Posd&quot;: NA 1 1 1 NA 1 1 NA NA 2 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>DRUG_TEST_RESULTS)</code></pre></div>
<pre><code>##           
##             Negd  Posd
##   Died     17043 21107
##   Survived 46184  8813</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>DRUG_TEST_RESULTS)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  df$INJURY_SEVERITY and df$DRUG_TEST_RESULTS
## X-squared = 15956, df = 1, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(df<span class="op">$</span>ALCOHOL_TEST_RESULT1, df<span class="op">$</span>DRUG_TEST_RESULTS)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  df$ALCOHOL_TEST_RESULT1 and df$DRUG_TEST_RESULTS
## X-squared = 19.351, df = 1, p-value = 1.088e-05</code></pre>
<hr />
</div>
<div id="analisis-hispanic_origin" class="section level3">
<h3><span class="header-section-number">2.3.24</span> Análisis <code>HISPANIC_ORIGIN</code></h3>
<p>Esta variable recoge la raza de la persona a partir de su certificado de defunción.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>HISPANIC_ORIGIN)</code></pre></div>
<pre><code>## df$HISPANIC_ORIGIN 
##        n  missing distinct 
##    23811    77157        7 
## 
## CeSouAme (239, 0.010), Cuban (120, 0.005), European_Spanish (28, 0.001),
## Hisp - Unknown (290, 0.012), Mexican (1145, 0.048), Non-Hispanic (21836,
## 0.917), Puerto_Rican (153, 0.006)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(df<span class="op">$</span>HISPANIC_ORIGIN)</code></pre></div>
<pre><code>##         CeSouAme            Cuban European_Spanish   Hisp - Unknown 
##              239              120               28              290 
##          Mexican     Non-Hispanic     Puerto_Rican             NA&#39;s 
##             1145            21836              153            77157</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>HISPANIC_ORIGIN =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>HISPANIC_ORIGIN, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;Non-Hispanic&quot;</span>, <span class="st">&quot;Mexican&quot;</span>, <span class="st">&quot;Hisp - Unknown&quot;</span>, <span class="st">&quot;Puerto_Rican&quot;</span>, <span class="st">&quot;CeSouAme&quot;</span>, <span class="st">&quot;Cuban&quot;</span>, <span class="st">&quot;European_Spanish&quot;</span>)))

mylogit23 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>HISPANIC_ORIGIN , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</code></pre></div>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mylogit23)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ HISPANIC_ORIGIN, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##        Min          1Q      Median          3Q         Max  
## -2.409e-06  -2.409e-06  -2.409e-06  -2.409e-06  -2.409e-06  
## 
## Coefficients:
##                                   Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)                     -2.657e+01  2.410e+03  -0.011    0.991
## HISPANIC_ORIGINMexican           9.904e-14  1.080e+04   0.000    1.000
## HISPANIC_ORIGINHisp - Unknown    9.904e-14  2.105e+04   0.000    1.000
## HISPANIC_ORIGINPuerto_Rican      9.904e-14  2.889e+04   0.000    1.000
## HISPANIC_ORIGINCeSouAme          9.904e-14  2.316e+04   0.000    1.000
## HISPANIC_ORIGINCuban             9.904e-14  3.260e+04   0.000    1.000
## HISPANIC_ORIGINEuropean_Spanish  9.904e-14  6.734e+04   0.000    1.000
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 0.0000e+00  on 23810  degrees of freedom
## Residual deviance: 1.3814e-07  on 23804  degrees of freedom
##   (77157 observations deleted due to missingness)
## AIC: 14
## 
## Number of Fisher Scoring iterations: 25</code></pre>
<p>Ninguna de las caracteristicas de la variable son representativas para nuestra variable resultado.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#redimensionamiento de los componentes de la variable</span>
df<span class="op">$</span>HISPANIC_ORIGIN =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>HISPANIC_ORIGIN, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;CeSouAme&quot;</span>, <span class="st">&quot;Hisp - Unknown&quot;</span>, <span class="st">&quot;Cuban&quot;</span>, <span class="st">&quot;Mexican&quot;</span>, <span class="st">&quot;Puerto_Rican&quot;</span>, <span class="st">&quot;European_Spanish&quot;</span>, <span class="st">&quot;Non-Hispanic&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;Hisp&quot;</span>, <span class="st">&quot;Hisp&quot;</span>,<span class="st">&quot;Hisp&quot;</span>,<span class="st">&quot;Hisp&quot;</span>,<span class="st">&quot;Hisp&quot;</span>,<span class="st">&quot;Hisp&quot;</span>,<span class="st">&quot;Non-Hispanic&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="kw">describe</span>(df<span class="op">$</span>HISPANIC_ORIGIN)</code></pre></div>
<pre><code>## df$HISPANIC_ORIGIN 
##        n  missing distinct 
##    23811    77157        2 
##                                     
## Value      Non-Hispanic         Hisp
## Frequency         21836         1975
## Proportion        0.917        0.083</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mylogit232 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>HISPANIC_ORIGIN , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</code></pre></div>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mylogit232)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ HISPANIC_ORIGIN, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##        Min          1Q      Median          3Q         Max  
## -2.409e-06  -2.409e-06  -2.409e-06  -2.409e-06  -2.409e-06  
## 
## Coefficients:
##                       Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)         -2.657e+01  2.410e+03  -0.011    0.991
## HISPANIC_ORIGINHisp  9.513e-14  8.368e+03   0.000    1.000
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 0.0000e+00  on 23810  degrees of freedom
## Residual deviance: 1.3814e-07  on 23809  degrees of freedom
##   (77157 observations deleted due to missingness)
## AIC: 4
## 
## Number of Fisher Scoring iterations: 25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Atención la regresión entre estas dos variables no convergen -&gt; Correlación</span>

<span class="kw">summary</span>(df[<span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(df<span class="op">$</span>HISPANIC_ORIGIN)),]<span class="op">$</span>INJURY_SEVERITY)</code></pre></div>
<pre><code>##     Died Survived 
##    23811        0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># IMPORTANTE: Todas las entradas en Hispanic_Origin son para gente que murieron. -&gt; 23811 filas </span>
numNotNA &lt;-<span class="st"> </span><span class="kw">nrow</span>(df[<span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(df<span class="op">$</span>HISPANIC_ORIGIN)),]) <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(df) <span class="co"># ünicamente tiene el 23,58 % de datos diferente a NA</span>

<span class="kw">summary</span>(df[<span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(df<span class="op">$</span>HISPANIC_ORIGIN)),])</code></pre></div>
<pre><code>##           CASE_STATE         AGE            SEX        PERSON_TYPE   
##  Florida       : 2462   Min.   : 0.00   Male  :16267   Driver:15046  
##  North_Carolina: 1511   1st Qu.:22.00   Female: 7542   Other : 8765  
##  Georgia       : 1380   Median :36.00   NA&#39;s  :    2                 
##  Michigan      : 1303   Mean   :39.76                                
##  Tennessee     : 1173   3rd Qu.:53.00                                
##  Illinois      : 1139   Max.   :97.00                                
##  (Other)       :14843   NA&#39;s   :40                                   
##  SEATING_POSITION RESTRAINT_SYSTEM.USE AIR_BAG_AVAILABILITY.DEPLOYMENT
##  FL     :15047    No   :14613          NAv    :13036                  
##  FR     : 3643    Yes  : 5922          D_F    : 3991                  
##  NMot   : 2815    Other: 1631          NM     : 2815                  
##  S_T    : 1670    NA&#39;s : 1645          Av_nD  : 1943                  
##  CA     :  171                         A_U    : 1215                  
##  (Other):  200                         (Other):   89                  
##  NA&#39;s   :  265                         NA&#39;s   :  722                  
##               EJECTION     EJECTION_PATH           EXTRICATION   
##  Not_Ejected      :18057   NoAp   :18057   Not_Extricated:19040  
##  Totally_Ejected  : 4491   SideW  :  871   Extricated    : 4575  
##  Partially_Ejected: 1144   SideD  :  383   NA&#39;s          :  196  
##  NA&#39;s             :  119   BackW  :  160                         
##                            Wind   :  144                         
##                            (Other):  272                         
##                            NA&#39;s   : 3924                         
##  NON_MOTORIST_LOCATION POLICE_REPORTED_ALCOHOL_INVOLVEMENT
##  NoAp:20996            NO  : 7476                         
##  NI  : 2292            YES : 3622                         
##  I   :  503            NA&#39;s:12713                         
##  NA&#39;s:   20                                               
##                                                           
##                                                           
##                                                           
##  METHOD_ALCOHOL_DETERMINATION ALCOHOL_TEST_TYPE ALCOHOL_TEST_RESULT
##  ET     : 2810                NoT : 5998        Length:23811       
##  OBS    : 1521                WB  :14901        Class :character   
##  OTHER  :  409                BB  :   14        Mode  :character   
##  BV     :   33                U   :   81                           
##  PBT    :    7                V   :  101                           
##  (Other):    3                BPS :   52                           
##  NA&#39;s   :19028                NA&#39;s: 2664                           
##  POLICE.REPORTED_DRUG_INVOLVEMENT METHOD_OF_DRUG_DETERMINATION
##  NoRep:16366                      NoRep:21700                 
##  No   : 4671                      Other:  691                 
##  Yes  :  700                      ET   : 1354                 
##  NA&#39;s : 2074                      B    :   60                 
##                                   DRT  :    6                 
##                                                               
##                                                               
##  DRUG_TEST_TYPE DRUG_TEST_RESULTS_.1_of_3. DRUG_TEST_TYPE_.2_of_3.
##  notest:    0   Length:23811               notest:    0           
##  Btest : 7189   Class :character           Btest :  663           
##  Utest : 1002   Mode  :character           Utest :  218           
##  Xtest :  864                              BUtest:  119           
##  BUtest:  848                              Xtest :  113           
##  NA&#39;s  :13908                              NA&#39;s  :22698           
##                                                                   
##  DRUG_TEST_RESULTS_.2_of_3. DRUG_TEST_TYPE_.3_of_3.
##  Min.   :  0.0              notest:    0           
##  1st Qu.:  0.0              Btest :  345           
##  Median :  0.0              Utest :   76           
##  Mean   :135.3              BUtest:   54           
##  3rd Qu.:  0.0              Xtest :   48           
##  Max.   :999.0              NA&#39;s  :23288           
##                                                    
##  DRUG_TEST_RESULTS_.3_of_3.     HISPANIC_ORIGIN  TAKEN_TO_HOSPITAL
##  Min.   :  0.0              Non-Hispanic:21836   No     :13506    
##  1st Qu.:  0.0              Hisp        : 1975   Unknown:   47    
##  Median :  0.0                                   Yes    :10258    
##  Mean   :125.7                                                    
##  3rd Qu.:  0.0                                                    
##  Max.   :999.0                                                    
##                                                                   
##  RELATED_FACTOR_.1. RELATED_FACTOR_.2. RELATED_FACTOR_.3.      RACE      
##  NoAp   :21683      NoAp2  :23209      NoAp3  :23652      W      :19444  
##  F01    :  635      E01    :  128      G07    :   19      B      : 3380  
##  F02    :  604      E02    :  105      G02    :   14      AmI    :  435  
##  F09    :  252      E07    :   78      G09    :   13      Fil    :  103  
##  F07    :   88      E14    :   56      G01    :   13      OAsian :   63  
##  (Other):  274      (Other):  176      (Other):   41      (Other):  266  
##  NA&#39;s   :  275      NA&#39;s   :   59      NA&#39;s   :   59      NA&#39;s   :  120  
##  INJURY_SEVERITY        ALCOHOL_TEST_RESULT1 DRUG_TEST_RESULTS
##  Died    :23811   Negative_alcohol:8321      Negd: 9908       
##  Survived:    0   Positive_alcohol:5889      Posd:12601       
##                   NA&#39;s            :9601      NA&#39;s: 1302       
##                                                               
##                                                               
##                                                               
## </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Por tanto, está variable no nos aporta información con respecto a ninguna otra.</span></code></pre></div>
<hr />
</div>
<div id="analisis-taken_to_hospital" class="section level3">
<h3><span class="header-section-number">2.3.25</span> Análisis <code>TAKEN_TO_HOSPITAL</code></h3>
<p>Esta variable identifica el modo de transporte al hospital o similares proporcionado a la persona involucrada en el accidente.</p>
<p>0 No (Use this code for victims who are dead on the scene and for those who are not taken (or do not go) to a treatment facility or hospital.) 1 Yes (Use this code for victims who are taken to treatment by EMS, who go to a treatment facility on their own, or who die en route.) 9 Unknown (Use this code when it is unknown whether or not this victim was taken (or went) to a hospital/treatment facility.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(df<span class="op">$</span>TAKEN_TO_HOSPITAL)</code></pre></div>
<pre><code>## df$TAKEN_TO_HOSPITAL 
##        n  missing distinct 
##   100968        0        3 
##                                   
## Value           No Unknown     Yes
## Frequency    46699    1914   52355
## Proportion   0.463   0.019   0.519</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>TAKEN_TO_HOSPITAL[<span class="kw">which</span>(df<span class="op">$</span>TAKEN_TO_HOSPITAL <span class="op">==</span><span class="st"> &quot;Unknown&quot;</span>)] &lt;-<span class="ot">NA</span>
df<span class="op">$</span>TAKEN_TO_HOSPITAL =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>TAKEN_TO_HOSPITAL, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;No&quot;</span>)))

mylogit25 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>TAKEN_TO_HOSPITAL , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit25)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ TAKEN_TO_HOSPITAL, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.4395  -1.1814   0.9362   0.9362   1.1735  
## 
## Coefficients:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          0.59783    0.00916   65.27   &lt;2e-16 ***
## TAKEN_TO_HOSPITALNo -0.58849    0.01305  -45.08   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 133875  on 98301  degrees of freedom
## Residual deviance: 131823  on 98300  degrees of freedom
##   (2666 observations deleted due to missingness)
## AIC: 131827
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Gráfica que muestra el número de accidentes que han sido transportados al hospital</span>
<span class="kw">ggplot</span>(<span class="dt">data=</span>df, <span class="kw">aes</span>(<span class="dt">x=</span>TAKEN_TO_HOSPITAL, <span class="dt">fill=</span>INJURY_SEVERITY)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">6</span>,<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/25TAKEN_TO_HOSPITAL-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>TAKEN_TO_HOSPITAL)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  df$INJURY_SEVERITY and df$TAKEN_TO_HOSPITAL
## X-squared = 2047.4, df = 1, p-value &lt; 2.2e-16</code></pre>
<p>Los datos muestran que ha habido un mayor número de implicados en accidentes que han sido llevados al hospital, de los cuales han sobrevivido un mayor número que los que no han sido llevados al hospital. Además, la regresión logistica nos indica que la variable es representativa para nuestra pregunta.</p>
</div>
<div id="analisis-related_factor_.1." class="section level3">
<h3><span class="header-section-number">2.3.26</span> Análisis <code>RELATED_FACTOR_.1.</code></h3>
<p>Estas variables recogen factores relacionados con los ocupantes de un vehículo a motor diferentes conductores y las personas no situadas en vehículos a motor como recogió el investigador del accidente.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Obtenemos la información resumen</span>
<span class="kw">summary</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>.)</code></pre></div>
<pre><code>##   F17   F29   F21   F13   F28   F15   F11   F07   F40   F23   F27   F42 
##     2    36     6    17    11    19    54   316     1    43     7     1 
##   F33   F12   F02   F16   F14   F20   F08   F38   F22   F34   F19   F39 
##     1     8  1231     5    69    53     1     2     7     4    21     2 
##   F31   F05  NoAp   F09   F06   F30   F24   F37   F04   F32   F41   F26 
##     6    19 96541   442    10     2    12     1     6    20     1     2 
##   F35   F18   F43   F10   F03   F36   F25   F01  NA&#39;s 
##     4    10     1     6   265     1     6  1192   504</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Número de registros que no aplican</span>
<span class="kw">length</span>(<span class="kw">which</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>.<span class="op">==</span><span class="st">&quot;NoAp&quot;</span>))</code></pre></div>
<pre><code>## [1] 96541</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Histograma para obtener visualizar la distribución de los datos</span>
<span class="kw">plot</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>., <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">&quot;Distribución de los factores tipo 1&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/26RELATED_FACTOR_.1.-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Histograma con la distribución de los factores sin &quot;NOAp&quot;</span>
df1 =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span>dplyr<span class="op">::</span><span class="kw">select</span>(RELATED_FACTOR_.<span class="dv">1</span>.) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(RELATED_FACTOR_.<span class="dv">1</span>.<span class="op">!=</span><span class="st">&quot;NoAp&quot;</span>)
<span class="kw">plot</span>(df1<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>., <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">&quot;Distribución de los factores tipo 1 sin &#39;NoAp&#39;&quot;</span>)

<span class="co">#Histograma con la distribución de los factores sin &quot;NOAp&quot;</span>
df1 =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(RELATED_FACTOR_.<span class="dv">1</span>.,INJURY_SEVERITY) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(RELATED_FACTOR_.<span class="dv">1</span>.<span class="op">!=</span><span class="st">&quot;NoAp&quot;</span>)
<span class="kw">plot</span>(df1<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>., <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">&quot;Distribución de los factores tipo 1 sin &#39;NoAp&#39;&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/26RELATED_FACTOR_.1.-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Grafica del número de accidentes por tipo de factor 1 sin &quot;NoAp&quot;</span>

<span class="kw">ggplot</span>(<span class="dt">data=</span>df1, <span class="kw">aes</span>(<span class="dt">x=</span>RELATED_FACTOR_.<span class="dv">1</span>., <span class="dt">fill=</span>INJURY_SEVERITY)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">6</span>,<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">          </span><span class="kw">ggtitle</span>(<span class="st">&quot;Número de accidentes </span><span class="ch">\n</span><span class="st"> por tipo de factor 1 sin &#39;NoAp&#39;&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/26RELATED_FACTOR_.1.-3.png" width="672" /></p>
<p>Al analizar los datos vemos que los principales factores mencionados y que además tienen una incidencia de fallecimiento muy alta es F02 y F01 que hacen referencia a cruzar la calle por sitios indebidos <code>Improper_Crossing_or_Roadway_or_Intersection</code> o andar/cabalgar/jugar/trabajar en la calzada <code>Walking/Riding_with_or_Against_Traffic_Playing_Working_Sitting_Lying_Standing_etc._in_Roadway</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Regresión logistica con respecto al factor relacionado</span>
mylogit26 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>RELATED_FACTOR_.<span class="dv">1</span>., <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit26)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ RELATED_FACTOR_.1., family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1.358  -1.358   1.007   1.007   3.052  
## 
## Coefficients:
##                          Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)            -1.357e+01  3.786e+02  -0.036    0.971
## RELATED_FACTOR_.1.F29   1.311e+01  3.786e+02   0.035    0.972
## RELATED_FACTOR_.1.F21  -3.668e-05  4.372e+02   0.000    1.000
## RELATED_FACTOR_.1.F13   1.239e+01  3.786e+02   0.033    0.974
## RELATED_FACTOR_.1.F28  -3.668e-05  4.116e+02   0.000    1.000
## RELATED_FACTOR_.1.F15  -3.668e-05  3.980e+02   0.000    1.000
## RELATED_FACTOR_.1.F11   9.596e+00  3.786e+02   0.025    0.980
## RELATED_FACTOR_.1.F07   8.918e+00  3.786e+02   0.024    0.981
## RELATED_FACTOR_.1.F40  -3.668e-05  6.557e+02   0.000    1.000
## RELATED_FACTOR_.1.F23   9.828e+00  3.786e+02   0.026    0.979
## RELATED_FACTOR_.1.F27   1.328e+01  3.786e+02   0.035    0.972
## RELATED_FACTOR_.1.F42  -3.668e-05  6.557e+02   0.000    1.000
## RELATED_FACTOR_.1.F33  -3.669e-05  6.557e+02   0.000    1.000
## RELATED_FACTOR_.1.F12  -3.668e-05  4.233e+02   0.000    1.000
## RELATED_FACTOR_.1.F02   9.808e+00  3.786e+02   0.026    0.979
## RELATED_FACTOR_.1.F16  -3.668e-05  4.480e+02   0.000    1.000
## RELATED_FACTOR_.1.F14   9.347e+00  3.786e+02   0.025    0.980
## RELATED_FACTOR_.1.F20   1.307e+01  3.786e+02   0.035    0.972
## RELATED_FACTOR_.1.F08  -3.669e-05  6.557e+02   0.000    1.000
## RELATED_FACTOR_.1.F38  -3.668e-05  5.354e+02   0.000    1.000
## RELATED_FACTOR_.1.F22  -3.668e-05  4.293e+02   0.000    1.000
## RELATED_FACTOR_.1.F34   1.357e+01  3.786e+02   0.036    0.971
## RELATED_FACTOR_.1.F19  -3.668e-05  3.962e+02   0.000    1.000
## RELATED_FACTOR_.1.F39  -3.669e-05  5.354e+02   0.000    1.000
## RELATED_FACTOR_.1.F31  -3.668e-05  4.372e+02   0.000    1.000
## RELATED_FACTOR_.1.F05   1.279e+01  3.786e+02   0.034    0.973
## RELATED_FACTOR_.1.NoAp  1.398e+01  3.786e+02   0.037    0.971
## RELATED_FACTOR_.1.F09   9.900e+00  3.786e+02   0.026    0.979
## RELATED_FACTOR_.1.F06  -3.668e-05  4.147e+02   0.000    1.000
## RELATED_FACTOR_.1.F30  -3.669e-05  5.354e+02   0.000    1.000
## RELATED_FACTOR_.1.F24  -3.669e-05  4.089e+02   0.000    1.000
## RELATED_FACTOR_.1.F37  -3.668e-05  6.557e+02   0.000    1.000
## RELATED_FACTOR_.1.F04  -3.668e-05  4.372e+02   0.000    1.000
## RELATED_FACTOR_.1.F32  -3.668e-05  3.971e+02   0.000    1.000
## RELATED_FACTOR_.1.F41  -3.668e-05  6.557e+02   0.000    1.000
## RELATED_FACTOR_.1.F26  -3.669e-05  5.354e+02   0.000    1.000
## RELATED_FACTOR_.1.F35  -3.668e-05  4.637e+02   0.000    1.000
## RELATED_FACTOR_.1.F18  -3.668e-05  4.147e+02   0.000    1.000
## RELATED_FACTOR_.1.F43  -3.668e-05  6.557e+02   0.000    1.000
## RELATED_FACTOR_.1.F10  -3.668e-05  4.372e+02   0.000    1.000
## RELATED_FACTOR_.1.F03   1.145e+01  3.786e+02   0.030    0.976
## RELATED_FACTOR_.1.F36  -3.669e-05  6.557e+02   0.000    1.000
## RELATED_FACTOR_.1.F25  -3.668e-05  4.372e+02   0.000    1.000
## RELATED_FACTOR_.1.F01   1.063e+01  3.786e+02   0.028    0.978
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 135018  on 99264  degrees of freedom
## Residual deviance: 129477  on 99221  degrees of freedom
##   (1703 observations deleted due to missingness)
## AIC: 129565
## 
## Number of Fisher Scoring iterations: 12</code></pre>
<p>En vista de la gran dispersión vamos a reclasificar los componentes de las siguientes tres variables por criterios cualitativos con objetivo reducir la heterogeneidad.</p>
<div style="white-space: pre-line;">VAR | DESCRIPCIÓN | CATEGORÍA |
01 | Walking/Riding_with_or_Against_Traffic_Playing… | Break Traffic Laws |
02 | Improper_Crossing_or_Roadway_or_Intersection | Break Traffic Laws |
03 | Darting_Stumbling_or_Running_into_Road | Distractions |
04 | Other_Physical_Impairment | Physical Issues |
05 | Non-Motorist_Pushing_a_Vehicle | Others |
06 | Opening_Vehicle_Closure_into_Moving_Traffic_or… | Mechanical Issues |
07 | Failure_to_Yield_Right_of_Way | Break Traffic Laws |
08 | Locked_Wheel | Mechanical Issues |
09 | Not_Visible | Physical Issues |
10 | Traveling_on_Prohibited_Trafficway | Break Traffic Laws |
11 | Failure_to_Obey_Traffic_Signs_Traffic_Control… | Break Traffic Laws |
12 | Impaired_Due_to_Previous_Injury | Physical Issues |
13 | Emotional_(e.g._Depression_Angry_Disputed) | Mental Issues |
14 | Inattentive_(talking_Eating_etc) | Distractions |
15 | Failure_to_Keep_in_Proper_Lane | Break Traffic Laws |
16 | Improper_or_Erratic_Lane_Changing | Break Traffic Laws |
17 | Blind | Physical Issues |
18 | Restricted_to_Wheelchair | Physical Issues |
19 | Mother_of_Dead_Fetus | Others |
20 | Interfering_with_Driver | Distractions |
21 | Driving_on_Wrong_Side_of_Road | Break Traffic Laws |
22 | Making_Improper_Turn | Break Traffic Laws |
23 | Getting_Off/Out_of_or_On/In_to_Moving_Transport | Break Traffic Laws |
24 | Operating_without_Required_Equipment | Mechanical Issues |
25 | Walking_With_Cane_or_Crutches | Physical Issues |
26 | Passing_with_Insufficient_Distance_or_Inadequate | Break Traffic Laws |
27 | Getting_Off/Out_of_or_On/In_to_Non-Moving_Transp… | Break Traffic Laws |
28 | Failing_to_Dim_Lights_or_Have_Lights_on_When_Req… | Break Traffic Laws |
29 | Construction/Maintenance/Utility_Worker | Others |
30 | Operating_the_Vehicle_in_Other_Erratic_Reckless… | Break Traffic Laws |
31 | Motorized_Wheelchair_Rider | Physical Issues |
32 | Passed_OutBlackout | Physical Issues |
33 | Illegal_Driving_on_Road_Shoulder_in_Ditch_on_Sidew… | Break Traffic Laws |
34 | Mentally_Challenged | Mental Issues |
35 | Pedestrian_NON-MOTOR_VEHICLE_OPERATOR_RELATED_FACTORS: | Others |
36 | Vision_obscured_by_overcorrecting | Physical Issues |
37 | Operator_Inexperience | Others |
38 | Making_Improper_Entry_to_or_Exit_from_Trafficway | Break Traffic Laws |
39 | Motor_Vehicle_(including_load) | Obstacles |
40 | Following_Improperly | Break Traffic Laws |
41 | Passing_on_Wrong_Side | Break Traffic Laws |
42 | Head_Restraints_AVOIDING_SWERVING_OR_SLIDING_DUE_TO | Mechanical Issues |
43 | Slippery_or_Loose_Surface | Others |
44 | Reflected_Glare_Bright_Sunlight | Physical Issues |
45 | Failure_to_Observe_Warnings_or_Instructions_on_Vehicles… | Break Traffic Laws |
46 | Driving_too_Fast_for_Conditions_or_in_Excess_of_Posted_Speed_Limit | Break Traffic Laws |
47 | Parked_Vehicle | Obstacles |
48 | Trees_Crops_Vegetation | Obstacles |
49 | Vehicle_in_Road | Obstacles |
50 | Rain_Snow_Fog_Smoke_Sand_Dust | Others |
51 | Curve_Hill_Or_Other_Design_Features_(including_Traffic_sign… | Break Traffic Laws |
52 | Animals_in_Road | Obstacles |
53 | Ruts_Holes_Bumps_in_Road | Obstacles |
54 | Building_Billboard_or_Other_Structures | Obstacles |</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#redimensionamiento de los componentes de la variable</span>
df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>. =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>., <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>,<span class="st">&quot;F01&quot;</span>, <span class="st">&quot;F02&quot;</span>, <span class="st">&quot;F03&quot;</span>,<span class="st">&quot;F04&quot;</span>,<span class="st">&quot;F05&quot;</span>, <span class="st">&quot;F06&quot;</span>,<span class="st">&quot;F07&quot;</span>,<span class="st">&quot;F08&quot;</span>, <span class="st">&quot;F09&quot;</span>, <span class="st">&quot;F10&quot;</span>, <span class="st">&quot;F11&quot;</span>, <span class="st">&quot;F12&quot;</span>, <span class="st">&quot;F13&quot;</span>,<span class="st">&quot;F14&quot;</span>,<span class="st">&quot;F15&quot;</span>,<span class="st">&quot;F16&quot;</span>,<span class="st">&quot;F17&quot;</span>,<span class="st">&quot;F18&quot;</span>,<span class="st">&quot;F19&quot;</span>,<span class="st">&quot;F20&quot;</span>,<span class="st">&quot;F21&quot;</span>, <span class="st">&quot;F22&quot;</span>, <span class="st">&quot;F23&quot;</span>,<span class="st">&quot;F24&quot;</span>,<span class="st">&quot;F25&quot;</span>, <span class="st">&quot;F26&quot;</span>,<span class="st">&quot;F27&quot;</span>,<span class="st">&quot;F28&quot;</span>,<span class="st">&quot;F29&quot;</span>,<span class="st">&quot;F30&quot;</span>,<span class="st">&quot;F31&quot;</span>, <span class="st">&quot;F32&quot;</span>, <span class="st">&quot;F33&quot;</span>,<span class="st">&quot;F34&quot;</span>,<span class="st">&quot;F35&quot;</span>,<span class="st">&quot;F36&quot;</span>,<span class="st">&quot;F37&quot;</span>,<span class="st">&quot;F38&quot;</span>,<span class="st">&quot;F39&quot;</span>,<span class="st">&quot;F40&quot;</span>,<span class="st">&quot;F41&quot;</span>,<span class="st">&quot;F42&quot;</span>, <span class="st">&quot;F43&quot;</span>), 
                                  <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Distractions&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Mechanical Issues&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Mechanical Issues&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Mental Issues&quot;</span>,<span class="st">&quot;Distractions&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Distractions&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Mechanical Issues&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Mental Issues&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Obstacles&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Mechanical Issues&quot;</span>, <span class="st">&quot;Others&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="kw">describe</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>.)</code></pre></div>
<pre><code>## df$RELATED_FACTOR_.1. 
##        n  missing distinct 
##   100464      504        8 
## 
## Physical Issues (501, 0.005), Others (82, 0.001), Break Traffic Laws
## (2906, 0.029), Mental Issues (21, 0.000), Mechanical Issues (24, 0.000),
## Distractions (387, 0.004), Obstacles (2, 0.000), NoAp (96541, 0.961)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Histograma con la distribución de los factores sin &quot;NOAp&quot;</span>
df11 =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(RELATED_FACTOR_.<span class="dv">1</span>.,INJURY_SEVERITY) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(RELATED_FACTOR_.<span class="dv">1</span>.<span class="op">!=</span><span class="st">&quot;NoAp&quot;</span>)
<span class="kw">plot</span>(df11<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>., <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">&quot;Distribución de los factores tipo 1 sin &#39;NoAp&#39;&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/factor%201-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>. =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>., <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>, <span class="st">&quot;Traffic Laws&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Distractions&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Mechanical Issues&quot;</span>, <span class="st">&quot;Mental Issues&quot;</span>, <span class="st">&quot;Obstacles&quot;</span>)))

mylogit262 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>RELATED_FACTOR_.<span class="dv">1</span>., <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit262)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ RELATED_FACTOR_.1., family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1.358  -1.358   1.007   1.007   2.763  
## 
## Coefficients:
##                                       Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)                           0.414705   0.006614  62.697  &lt; 2e-16
## RELATED_FACTOR_.1.Physical Issues    -4.209172   0.304955 -13.803  &lt; 2e-16
## RELATED_FACTOR_.1.Distractions       -2.293807   0.165800 -13.835  &lt; 2e-16
## RELATED_FACTOR_.1.Others             -1.546107   0.257241  -6.010 1.85e-09
## RELATED_FACTOR_.1.Mechanical Issues -11.980759  40.205860  -0.298  0.76571
## RELATED_FACTOR_.1.Mental Issues      -1.330996   0.483091  -2.755  0.00587
## RELATED_FACTOR_.1.Obstacles         -11.980759 139.277182  -0.086  0.93145
##                                        
## (Intercept)                         ***
## RELATED_FACTOR_.1.Physical Issues   ***
## RELATED_FACTOR_.1.Distractions      ***
## RELATED_FACTOR_.1.Others            ***
## RELATED_FACTOR_.1.Mechanical Issues    
## RELATED_FACTOR_.1.Mental Issues     ** 
## RELATED_FACTOR_.1.Obstacles            
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 129927  on 96361  degrees of freedom
## Residual deviance: 128729  on 96355  degrees of freedom
##   (4606 observations deleted due to missingness)
## AIC: 128743
## 
## Number of Fisher Scoring iterations: 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>.)</code></pre></div>
<pre><code>##           
##             NoAp Traffic Laws Physical Issues Distractions Others
##   Died     37955            0             489          275     62
##   Survived 57461            0              11           42     20
##           
##            Mechanical Issues Mental Issues Obstacles
##   Died                    24            15         2
##   Survived                 0             6         0</code></pre>
<hr />
</div>
<div id="analisis-related_factor_.2." class="section level3">
<h3><span class="header-section-number">2.3.27</span> Análisis <code>RELATED_FACTOR_.2.</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Obtenemos la información resumen</span>
<span class="kw">summary</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>.)</code></pre></div>
<pre><code>##   E52   E17   E29   E51   E03   E21   E46   E13   E28   E15   E11   E45 
##     1     2     3     1    88     1     3    16     6    10    60     2 
##   E07   E40   E23   E27   E42   E12   E02   E16   E14   E20   E38   E22 
##   419     1     6     6     3     8   265     4    88     2     2     8 
##   E34   E19   E39   E31   E05 NoAp2   E09   E06   E30   E24   E04   E47 
##    10     1     9     2     1 99269    48     4     3    20    13     6 
##   E32   E35   E50   E44   E18   E53   E10   E48   E49   E25   E01  NA&#39;s 
##    20     2     3     3     4     1    14     3     1     5   256   265</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Número de registros que no aplican</span>
<span class="kw">length</span>(<span class="kw">which</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>.<span class="op">==</span><span class="st">&quot;NoAp2&quot;</span>))</code></pre></div>
<pre><code>## [1] 99269</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Histograma para obtener visualizar la distribución de los datos</span>
<span class="kw">plot</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">&quot;Distribución de los factores tipo 2&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/27RELATED_FACTOR_.2.-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Histograma con la distribución de los factores sin &quot;NOAp&quot;</span>
df2 =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(RELATED_FACTOR_.<span class="dv">2</span>.,INJURY_SEVERITY) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(RELATED_FACTOR_.<span class="dv">2</span>.<span class="op">!=</span><span class="st">&quot;NoAp2&quot;</span>)
<span class="kw">plot</span>(df2<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">&quot;Distribución de los factores tipo 2 sin &#39;NoAp&#39;&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/27RELATED_FACTOR_.2.-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Grafica del número de accidentes por tipo de factor 1 sin &quot;NoAp&quot;</span>

<span class="kw">ggplot</span>(<span class="dt">data=</span>df2, <span class="kw">aes</span>(<span class="dt">x=</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">fill=</span>INJURY_SEVERITY)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">6</span>,<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Número de accidentes </span><span class="ch">\n</span><span class="st"> por tipo de factor 1 sin &#39;NoAp&#39;&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/27RELATED_FACTOR_.2.-3.png" width="672" /> Vemos que más de 99000 sujetos no tienen asignado ningún factor de tipo 2 y sin tomar en cuenta los valores NA. De los que si tienen asignado una valor de tipo 2, presentan mayores valores los E07 seguido por E02 y E01, lo que corresponde con la cesión del paso <code>Failure_to_Yield_Right_of_Way</code> seguido por cruzar la calle por sitios indebidos (<code>Improper_Crossing_or_Roadway_or_Intersection</code> - factor destacado también en el tipo 1) y saltar, tropezar o correr en la calle <code>Darting_Stumbling_or_Running_into_Road</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Filtramos por NoAp en factor 1</span>
df3 =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(RELATED_FACTOR_.<span class="dv">2</span>.,RELATED_FACTOR_.<span class="dv">1</span>.) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(RELATED_FACTOR_.<span class="dv">1</span>.<span class="op">==</span><span class="st">&quot;NoAp&quot;</span>)
<span class="kw">plot</span>(df3<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">&quot;Distribución de los factores tipo 2 </span><span class="ch">\n</span><span class="st"> que son &#39;NoAp&#39; en el factor 1&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Filtramos por datos que no son NoAp en factor 1</span>
df4 =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(RELATED_FACTOR_.<span class="dv">2</span>.,RELATED_FACTOR_.<span class="dv">1</span>.) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(RELATED_FACTOR_.<span class="dv">1</span>.<span class="op">!=</span><span class="st">&quot;NoAp&quot;</span>)
<span class="kw">plot</span>(df4<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">&quot;Distribución de los factores tipo 2 </span><span class="ch">\n</span><span class="st"> que NO son &#39;NoAp&#39; en el factor 1&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Grafica del número de accidentes por tipo de factor 1 sin &quot;NoAp&quot;</span>
<span class="kw">ggplot</span>(<span class="dt">data=</span>df4, <span class="kw">aes</span>(<span class="dt">x=</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">fill=</span>RELATED_FACTOR_.<span class="dv">1</span>.)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">6</span>,<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Número de accidentes </span><span class="ch">\n</span><span class="st"> por tipo de factor 2 sin &#39;NoAp&#39; en factor 1&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-36-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Regresión logistica con respecto a grado de afecto</span>
mylogit27 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit27)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ RELATED_FACTOR_.2., family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1.330  -1.330   1.033   1.033   2.992  
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)             -1.357e+01  5.354e+02  -0.025    0.980
## RELATED_FACTOR_.2.E17   -6.435e-05  6.557e+02   0.000    1.000
## RELATED_FACTOR_.2.E29   -6.435e-05  6.182e+02   0.000    1.000
## RELATED_FACTOR_.2.E51   -6.435e-05  7.572e+02   0.000    1.000
## RELATED_FACTOR_.2.E03    9.112e+00  5.354e+02   0.017    0.986
## RELATED_FACTOR_.2.E21   -6.435e-05  7.572e+02   0.000    1.000
## RELATED_FACTOR_.2.E46   -6.435e-05  6.182e+02   0.000    1.000
## RELATED_FACTOR_.2.E13    1.086e+01  5.354e+02   0.020    0.984
## RELATED_FACTOR_.2.E28   -6.435e-05  5.783e+02   0.000    1.000
## RELATED_FACTOR_.2.E15   -6.435e-05  5.615e+02   0.000    1.000
## RELATED_FACTOR_.2.E11    1.062e+01  5.354e+02   0.020    0.984
## RELATED_FACTOR_.2.E45   -6.435e-05  6.557e+02   0.000    1.000
## RELATED_FACTOR_.2.E07    9.855e+00  5.354e+02   0.018    0.985
## RELATED_FACTOR_.2.E40   -6.435e-05  7.572e+02   0.000    1.000
## RELATED_FACTOR_.2.E23   -6.435e-05  5.783e+02   0.000    1.000
## RELATED_FACTOR_.2.E27    1.287e+01  5.354e+02   0.024    0.981
## RELATED_FACTOR_.2.E42   -6.435e-05  6.182e+02   0.000    1.000
## RELATED_FACTOR_.2.E12   -6.435e-05  5.679e+02   0.000    1.000
## RELATED_FACTOR_.2.E02    9.615e+00  5.354e+02   0.018    0.986
## RELATED_FACTOR_.2.E16   -6.435e-05  5.986e+02   0.000    1.000
## RELATED_FACTOR_.2.E14    9.100e+00  5.354e+02   0.017    0.986
## RELATED_FACTOR_.2.E20    1.357e+01  5.354e+02   0.025    0.980
## RELATED_FACTOR_.2.E38   -6.435e-05  6.557e+02   0.000    1.000
## RELATED_FACTOR_.2.E22   -6.435e-05  5.679e+02   0.000    1.000
## RELATED_FACTOR_.2.E34   -6.435e-05  5.615e+02   0.000    1.000
## RELATED_FACTOR_.2.E19   -6.435e-05  7.572e+02   0.000    1.000
## RELATED_FACTOR_.2.E39   -6.435e-05  5.644e+02   0.000    1.000
## RELATED_FACTOR_.2.E31   -6.435e-05  6.557e+02   0.000    1.000
## RELATED_FACTOR_.2.NoAp2  1.392e+01  5.354e+02   0.026    0.979
## RELATED_FACTOR_.2.E09    9.716e+00  5.354e+02   0.018    0.986
## RELATED_FACTOR_.2.E06   -6.435e-05  5.986e+02   0.000    1.000
## RELATED_FACTOR_.2.E30    1.287e+01  5.354e+02   0.024    0.981
## RELATED_FACTOR_.2.E24   -6.435e-05  5.486e+02   0.000    1.000
## RELATED_FACTOR_.2.E04   -6.435e-05  5.556e+02   0.000    1.000
## RELATED_FACTOR_.2.E47    1.287e+01  5.354e+02   0.024    0.981
## RELATED_FACTOR_.2.E32    1.062e+01  5.354e+02   0.020    0.984
## RELATED_FACTOR_.2.E35   -6.435e-05  6.557e+02   0.000    1.000
## RELATED_FACTOR_.2.E50   -6.435e-05  6.182e+02   0.000    1.000
## RELATED_FACTOR_.2.E44   -6.435e-05  6.182e+02   0.000    1.000
## RELATED_FACTOR_.2.E18   -6.435e-05  5.986e+02   0.000    1.000
## RELATED_FACTOR_.2.E53   -6.434e-05  7.572e+02   0.000    1.000
## RELATED_FACTOR_.2.E10   -6.435e-05  5.542e+02   0.000    1.000
## RELATED_FACTOR_.2.E48   -6.435e-05  6.182e+02   0.000    1.000
## RELATED_FACTOR_.2.E49   -6.434e-05  7.572e+02   0.000    1.000
## RELATED_FACTOR_.2.E25   -6.435e-05  5.865e+02   0.000    1.000
## RELATED_FACTOR_.2.E01    9.423e+00  5.354e+02   0.018    0.986
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 135561  on 99572  degrees of freedom
## Residual deviance: 133358  on 99527  degrees of freedom
##   (1395 observations deleted due to missingness)
## AIC: 133450
## 
## Number of Fisher Scoring iterations: 12</code></pre>
<p>No obstante nos interesa saber si los <code>Not_Applicable_-_Driver/None_-_All_Other_Persons</code>del primer factor tienen algún valor asignado en el segundo y al revés. Vemos que no todos “NoAp” del primer factor son “NoAp” a su vez en el segundo aunque sí la gran mayoría son “NoAp” en el segundo también. Por otro lado, del los datos que no son “NoAp” en el primer factor, destaca el E05 en el segundo <code>Non-Motorist_Pushing_a_Vehicle</code>, dato que es muy poco relevante en el primer factor.</p>
<p>También hay que mencionar que el factor 1 y el factor 2 comparten la mayor parte de las categorias, 36 aparte de “NoAp” y NA. Aunque el factor 1 tiene 7 categoria que no se repite en factor 2 y este a su vez tiene 10 categorias que no se repiten en factor 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#redimensionamiento de los componentes de la variable</span>
df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>. =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp2&quot;</span>,<span class="st">&quot;E01&quot;</span>, <span class="st">&quot;E02&quot;</span>, <span class="st">&quot;E03&quot;</span>,<span class="st">&quot;E04&quot;</span>,<span class="st">&quot;E05&quot;</span>,<span class="st">&quot;E06&quot;</span>,<span class="st">&quot;E07&quot;</span>,<span class="st">&quot;E09&quot;</span>,<span class="st">&quot;E10&quot;</span>,<span class="st">&quot;E11&quot;</span>, <span class="st">&quot;E12&quot;</span>, <span class="st">&quot;E13&quot;</span>,<span class="st">&quot;E14&quot;</span>,<span class="st">&quot;E15&quot;</span>,<span class="st">&quot;E16&quot;</span>,<span class="st">&quot;E17&quot;</span>,<span class="st">&quot;E18&quot;</span>,<span class="st">&quot;E19&quot;</span>,<span class="st">&quot;E20&quot;</span>,<span class="st">&quot;E21&quot;</span>, <span class="st">&quot;E22&quot;</span>, <span class="st">&quot;E23&quot;</span>,<span class="st">&quot;E24&quot;</span>,<span class="st">&quot;E25&quot;</span>,<span class="st">&quot;E27&quot;</span>,<span class="st">&quot;E28&quot;</span>,<span class="st">&quot;E29&quot;</span>,<span class="st">&quot;E30&quot;</span>,<span class="st">&quot;E31&quot;</span>, <span class="st">&quot;E32&quot;</span>, <span class="st">&quot;E34&quot;</span>,<span class="st">&quot;E35&quot;</span>,<span class="st">&quot;E38&quot;</span>,<span class="st">&quot;E39&quot;</span>,<span class="st">&quot;E40&quot;</span>,<span class="st">&quot;E42&quot;</span>, <span class="st">&quot;E44&quot;</span>,<span class="st">&quot;E45&quot;</span>, <span class="st">&quot;E46&quot;</span>,<span class="st">&quot;E47&quot;</span>,<span class="st">&quot;E48&quot;</span>,<span class="st">&quot;E49&quot;</span>,<span class="st">&quot;E50&quot;</span>,<span class="st">&quot;E51&quot;</span>,<span class="st">&quot;E52&quot;</span>,<span class="st">&quot;E53&quot;</span>), 
                                  <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp2&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Distractions&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Mechanical Issues&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Mental Issues&quot;</span>,<span class="st">&quot;Distractions&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Distractions&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Mechanical Issues&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Mental Issues&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Obstacles&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Mechanical Issues&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Obstacles&quot;</span>,<span class="st">&quot;Obstacles&quot;</span>,<span class="st">&quot;Obstacles&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Obstacles&quot;</span>,<span class="st">&quot;Obstacles&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="kw">describe</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>.)</code></pre></div>
<pre><code>## df$RELATED_FACTOR_.2. 
##        n  missing distinct 
##   100703      265        8 
## 
## Obstacles (21, 0.000), Physical Issues (105, 0.001), Others (10, 0.000),
## Break Traffic Laws (1067, 0.011), Distractions (178, 0.002), Mental Issues
## (26, 0.000), Mechanical Issues (27, 0.000), NoAp2 (99269, 0.986)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Histograma con la distribución de los factores sin &quot;NOAp&quot;</span>
df21 =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(RELATED_FACTOR_.<span class="dv">2</span>.,INJURY_SEVERITY) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(RELATED_FACTOR_.<span class="dv">2</span>.<span class="op">!=</span><span class="st">&quot;NoAp2&quot;</span>)
<span class="kw">plot</span>(df21<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">&quot;Distribución de los factores tipo 2 sin &#39;NoAp&#39;&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/factor%202-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>. =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;NoAp2&quot;</span>, <span class="st">&quot;Traffic Laws&quot;</span>, <span class="st">&quot;Distractions&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Mechanical Issues&quot;</span>, <span class="st">&quot;Mental Issues&quot;</span>, <span class="st">&quot;Obstacles&quot;</span>, <span class="st">&quot;Others&quot;</span>)))

mylogit272 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit272)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ RELATED_FACTOR_.2., family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1.330  -1.330   1.033   1.033   2.856  
## 
## Coefficients:
##                                       Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)                           0.350746   0.006483  54.106  &lt; 2e-16
## RELATED_FACTOR_.2.Distractions       -4.411189   0.582342  -7.575 3.59e-14
## RELATED_FACTOR_.2.Physical Issues    -4.292328   0.713968  -6.012 1.83e-09
## RELATED_FACTOR_.2.Mechanical Issues -11.916800  37.906448  -0.314 0.753237
## RELATED_FACTOR_.2.Mental Issues      -3.569622   1.019825  -3.500 0.000465
## RELATED_FACTOR_.2.Obstacles          -2.602038   0.743420  -3.500 0.000465
## RELATED_FACTOR_.2.Others            -11.916800  65.655893  -0.182 0.855972
##                                        
## (Intercept)                         ***
## RELATED_FACTOR_.2.Distractions      ***
## RELATED_FACTOR_.2.Physical Issues   ***
## RELATED_FACTOR_.2.Mechanical Issues    
## RELATED_FACTOR_.2.Mental Issues     ***
## RELATED_FACTOR_.2.Obstacles         ***
## RELATED_FACTOR_.2.Others               
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 133718  on 98505  degrees of freedom
## Residual deviance: 133152  on 98499  degrees of freedom
##   (2462 observations deleted due to missingness)
## AIC: 133166
## 
## Number of Fisher Scoring iterations: 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>.)</code></pre></div>
<pre><code>##           
##            NoAp2 Traffic Laws Distractions Physical Issues
##   Died     40552            0          174             103
##   Survived 57589            0            3               2
##           
##            Mechanical Issues Mental Issues Obstacles Others
##   Died                    27            25        19      9
##   Survived                 0             1         2      0</code></pre>
<hr />
</div>
<div id="analisis-related_factor_.3." class="section level3">
<h3><span class="header-section-number">2.3.28</span> Análisis <code>RELATED_FACTOR_.3.</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Obtenemos la información resumen</span>
<span class="kw">summary</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>.)</code></pre></div>
<pre><code>##    G17    G54    G03    G21    G46    G13    G15    G11    G07    G23 
##      3      3      4      5      2      1      5     34    128      3 
##    G27    G12    G02    G16    G14    G22    G34    G39    G05  NoAp3 
##      2     11     24      1     22      4      1      2      3 100362 
##    G09    G24    G04    G47    G32    G35    G50    G44    G18    G10 
##     30      3      6      2      5      3      4      1      1      7 
##    G25    G01   NA&#39;s 
##      1     20    265</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Número de registros que no aplican</span>
<span class="kw">length</span>(<span class="kw">which</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>.<span class="op">==</span><span class="st">&quot;NoAp3&quot;</span>))</code></pre></div>
<pre><code>## [1] 100362</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Histograma para obtener visualizar la distribución de los datos</span>
<span class="kw">plot</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>., <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">&quot;Distribución de los factores tipo 3&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/28RELATED_FACTOR_.3.-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Histograma con la distribución de los factores sin &quot;NOAp&quot;</span>
df5 =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(RELATED_FACTOR_.<span class="dv">3</span>.,INJURY_SEVERITY) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(RELATED_FACTOR_.<span class="dv">3</span>.<span class="op">!=</span><span class="st">&quot;NoAp3&quot;</span>)
<span class="kw">plot</span>(df5<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>., <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">&quot;Distribución de los factores tipo 3 sin &#39;NoAp&#39;&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/28RELATED_FACTOR_.3.-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Grafica del número de accidentes por tipo de factor 3 sin &quot;NoAp&quot;</span>

<span class="kw">ggplot</span>(<span class="dt">data=</span>df5, <span class="kw">aes</span>(<span class="dt">x=</span>RELATED_FACTOR_.<span class="dv">3</span>., <span class="dt">fill=</span>INJURY_SEVERITY)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">6</span>,<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/28RELATED_FACTOR_.3.-3.png" width="672" /> Al analizar el factor de tipo 3 vemos que la variable <code>Not_Applicable_-_Driver/None_-_All_Other_Persons</code> o “NoAp” tiene un valor de 100362 registros lo que representa un 99.4% del total de valores. Aún así, el 0.6% del que restamos 265 de NA’s se distribuye en 33 categorias, de las cuales casi todas son comunes con el factor 1, cuatro son comunes unicamente con el factor 2 y una variables es única para el factor 3, <code>Building_Billboard_or_Other_Structures</code>. Quitando los “NoAp”, la caracteristica más representativa es la G07, o sea <code>Failure_to_Yield_Right_of_Way</code> coincidiendo con la caracteristica más representativa en el segundo factor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#redimensionamiento de los componentes de la variable</span>
df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>. =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>., <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp3&quot;</span>,<span class="st">&quot;G01&quot;</span>, <span class="st">&quot;G02&quot;</span>,<span class="st">&quot;G03&quot;</span>,<span class="st">&quot;G04&quot;</span>,<span class="st">&quot;G05&quot;</span>,<span class="st">&quot;G07&quot;</span>,<span class="st">&quot;G09&quot;</span>,<span class="st">&quot;G10&quot;</span>,<span class="st">&quot;G11&quot;</span>, <span class="st">&quot;G12&quot;</span>, <span class="st">&quot;G13&quot;</span>,<span class="st">&quot;G14&quot;</span>,<span class="st">&quot;G15&quot;</span>,<span class="st">&quot;G16&quot;</span>,<span class="st">&quot;G17&quot;</span>,<span class="st">&quot;G18&quot;</span>,<span class="st">&quot;G21&quot;</span>, <span class="st">&quot;G22&quot;</span>, <span class="st">&quot;G23&quot;</span>,<span class="st">&quot;G24&quot;</span>,<span class="st">&quot;G25&quot;</span>,<span class="st">&quot;G27&quot;</span>,<span class="st">&quot;G32&quot;</span>, <span class="st">&quot;G34&quot;</span>,<span class="st">&quot;G35&quot;</span>,<span class="st">&quot;G39&quot;</span>, <span class="st">&quot;G44&quot;</span>, <span class="st">&quot;G46&quot;</span>,<span class="st">&quot;G47&quot;</span>,<span class="st">&quot;G50&quot;</span>,<span class="st">&quot;G54&quot;</span>), 
                                  <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp3&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Distractions&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Mental Issues&quot;</span>,<span class="st">&quot;Distractions&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Mechanical Issues&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>,<span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Mental Issues&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Obstacles&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Break Traffic Laws&quot;</span>,<span class="st">&quot;Obstacles&quot;</span>,<span class="st">&quot;Others&quot;</span>,<span class="st">&quot;Obstacles&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="kw">describe</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>.)</code></pre></div>
<pre><code>## df$RELATED_FACTOR_.3. 
##        n  missing distinct 
##   100703      265        8 
## 
## Physical Issues (58, 0.001), Obstacles (7, 0.000), Distractions (26,
## 0.000), Break Traffic Laws (235, 0.002), Mental Issues (2, 0.000), Others
## (10, 0.000), NoAp3 (100362, 0.997), Mechanical Issues (3, 0.000)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Histograma con la distribución de los factores sin &quot;NOAp&quot;</span>
df31 =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(RELATED_FACTOR_.<span class="dv">3</span>.,INJURY_SEVERITY) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(RELATED_FACTOR_.<span class="dv">3</span>.<span class="op">!=</span><span class="st">&quot;NoAp3&quot;</span>)
<span class="kw">plot</span>(df31<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>., <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">&quot;Distribución de los factores tipo 3 sin &#39;NoAp&#39;&quot;</span>)</code></pre></div>
<p><img src="FARS18052_files/figure-html/factor%203_-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>. =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>., <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;NoAp3&quot;</span>, <span class="st">&quot;Traffic Laws&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Distractions&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Obstacles&quot;</span>, <span class="st">&quot;Mechanical Issues&quot;</span>, <span class="st">&quot;Mental Issues&quot;</span>)))

mylogit282 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>RELATED_FACTOR_.<span class="dv">3</span>., <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit282)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ RELATED_FACTOR_.3., family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1.318  -1.318   1.043   1.043   2.146  
## 
## Coefficients:
##                                       Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)                           0.325233   0.006433  50.556   &lt;2e-16
## RELATED_FACTOR_.3.Physical Issues   -12.891296  42.640937  -0.302   0.7624
## RELATED_FACTOR_.3.Distractions      -12.891296  63.687479  -0.202   0.8396
## RELATED_FACTOR_.3.Others             -2.522457   1.054112  -2.393   0.0167
## RELATED_FACTOR_.3.Obstacles         -12.891296 122.741580  -0.105   0.9164
## RELATED_FACTOR_.3.Mechanical Issues -12.891296 187.490860  -0.069   0.9452
## RELATED_FACTOR_.3.Mental Issues     -12.891296 229.628470  -0.056   0.9552
##                                        
## (Intercept)                         ***
## RELATED_FACTOR_.3.Physical Issues      
## RELATED_FACTOR_.3.Distractions         
## RELATED_FACTOR_.3.Others            *  
## RELATED_FACTOR_.3.Obstacles            
## RELATED_FACTOR_.3.Mechanical Issues    
## RELATED_FACTOR_.3.Mental Issues        
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 135158  on 99337  degrees of freedom
## Residual deviance: 134981  on 99331  degrees of freedom
##   (1630 observations deleted due to missingness)
## AIC: 134995
## 
## Number of Fisher Scoring iterations: 11</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>.)</code></pre></div>
<pre><code>##           
##            NoAp3 Traffic Laws Physical Issues Distractions Others
##   Died     41618            0              58           26      9
##   Survived 57614            0               0            0      1
##           
##            Obstacles Mechanical Issues Mental Issues
##   Died             7                 3             2
##   Survived         0                 0             0</code></pre>
<p>Tratamiento de las tres variables RELATED_FACTOR</p>
<p>Al analizar los datos respecto a la variable respuesta, vemos que las categorias que tienen valores dentro de la variable son “Physiscal Issues” y “Distractions” siendo las demás poco representativas para la variable respuesta o nada representativa como “Traffic Laws” no habiendo ninguna correspondencia con “Survived” or “Died” sino que todo factor de tipo “Traffic Laws” está dentro de los casos desconocidos de “INJURY SEVERITY”. Por lo tanto vamos a unificar las categorias dentro de cada una de las variables en: Physical Issues, Distractions y Others.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Factor 1</span>
<span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>.)</code></pre></div>
<pre><code>##           
##             NoAp Traffic Laws Physical Issues Distractions Others
##   Died     37955            0             489          275     62
##   Survived 57461            0              11           42     20
##           
##            Mechanical Issues Mental Issues Obstacles
##   Died                    24            15         2
##   Survived                 0             6         0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>. =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>., <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>, <span class="st">&quot;Traffic Laws&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Distractions&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Obstacles&quot;</span>, <span class="st">&quot;Mechanical Issues&quot;</span>, <span class="st">&quot;Mental Issues&quot;</span>), 
                                  <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Distractions&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Others&quot;</span>),<span class="dt">warn_missing=</span>F)
<span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>.)</code></pre></div>
<pre><code>##           
##             NoAp Others Physical Issues Distractions
##   Died     37955    103             489          275
##   Survived 57461     26              11           42</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#reordenamos las categorias</span>
df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>. =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>., <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Distractions&quot;</span>, <span class="st">&quot;Others&quot;</span>)))

mylogit263 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>RELATED_FACTOR_.<span class="dv">1</span>., <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit263)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ RELATED_FACTOR_.1., family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1.358  -1.358   1.007   1.007   2.763  
## 
## Coefficients:
##                                    Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)                        0.414705   0.006614  62.697  &lt; 2e-16
## RELATED_FACTOR_.1.Physical Issues -4.209172   0.304946 -13.803  &lt; 2e-16
## RELATED_FACTOR_.1.Distractions    -2.293807   0.165800 -13.835  &lt; 2e-16
## RELATED_FACTOR_.1.Others          -1.791338   0.219577  -8.158  3.4e-16
##                                      
## (Intercept)                       ***
## RELATED_FACTOR_.1.Physical Issues ***
## RELATED_FACTOR_.1.Distractions    ***
## RELATED_FACTOR_.1.Others          ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 129927  on 96361  degrees of freedom
## Residual deviance: 128742  on 96358  degrees of freedom
##   (4606 observations deleted due to missingness)
## AIC: 128750
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Factor 2</span>
<span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>.)</code></pre></div>
<pre><code>##           
##            NoAp2 Traffic Laws Distractions Physical Issues
##   Died     40552            0          174             103
##   Survived 57589            0            3               2
##           
##            Mechanical Issues Mental Issues Obstacles Others
##   Died                    27            25        19      9
##   Survived                 0             1         2      0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>. =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp2&quot;</span>, <span class="st">&quot;Traffic Laws&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Distractions&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Obstacles&quot;</span>, <span class="st">&quot;Mechanical Issues&quot;</span>, <span class="st">&quot;Mental Issues&quot;</span>), 
                                  <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp2&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Distractions&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Others&quot;</span>),<span class="dt">warn_missing=</span>F)
<span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>.)</code></pre></div>
<pre><code>##           
##            NoAp2 Others Distractions Physical Issues
##   Died     40552     80          174             103
##   Survived 57589      3            3               2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#reordenamos las categorias</span>
df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>. =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;NoAp2&quot;</span>, <span class="st">&quot;Distractions&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>,  <span class="st">&quot;Others&quot;</span>)))

mylogit273 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit273)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ RELATED_FACTOR_.2., family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1.330  -1.330   1.033   1.033   2.856  
## 
## Coefficients:
##                                    Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)                        0.350746   0.006483  54.106  &lt; 2e-16
## RELATED_FACTOR_.2.Distractions    -4.411189   0.582234  -7.576 3.56e-14
## RELATED_FACTOR_.2.Physical Issues -4.292328   0.713907  -6.012 1.83e-09
## RELATED_FACTOR_.2.Others          -3.634161   0.588112  -6.179 6.44e-10
##                                      
## (Intercept)                       ***
## RELATED_FACTOR_.2.Distractions    ***
## RELATED_FACTOR_.2.Physical Issues ***
## RELATED_FACTOR_.2.Others          ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 133718  on 98505  degrees of freedom
## Residual deviance: 133156  on 98502  degrees of freedom
##   (2462 observations deleted due to missingness)
## AIC: 133164
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Factor 3</span>
<span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>.)</code></pre></div>
<pre><code>##           
##            NoAp3 Traffic Laws Physical Issues Distractions Others
##   Died     41618            0              58           26      9
##   Survived 57614            0               0            0      1
##           
##            Obstacles Mechanical Issues Mental Issues
##   Died             7                 3             2
##   Survived         0                 0             0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>. =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>., <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp3&quot;</span>, <span class="st">&quot;Traffic Laws&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Distractions&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Obstacles&quot;</span>, <span class="st">&quot;Mechanical Issues&quot;</span>, <span class="st">&quot;Mental Issues&quot;</span>), 
                                  <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp3&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Distractions&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Others&quot;</span>),<span class="dt">warn_missing=</span>F)
<span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>.)</code></pre></div>
<pre><code>##           
##            NoAp3 Others Physical Issues Distractions
##   Died     41618     21              58           26
##   Survived 57614      1               0            0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#reordenamos las categorias</span>
df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>. =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>., <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;NoAp3&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Distractions&quot;</span>,   <span class="st">&quot;Others&quot;</span>)))

mylogit283 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>RELATED_FACTOR_.<span class="dv">3</span>., <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit283)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ RELATED_FACTOR_.3., family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1.318  -1.318   1.043   1.043   2.486  
## 
## Coefficients:
##                                     Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)                         0.325233   0.006433  50.556  &lt; 2e-16
## RELATED_FACTOR_.3.Physical Issues -12.891296  42.640937  -0.302 0.762407
## RELATED_FACTOR_.3.Distractions    -12.891296  63.687479  -0.202 0.839592
## RELATED_FACTOR_.3.Others           -3.369755   1.023553  -3.292 0.000994
##                                      
## (Intercept)                       ***
## RELATED_FACTOR_.3.Physical Issues    
## RELATED_FACTOR_.3.Distractions       
## RELATED_FACTOR_.3.Others          ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 135158  on 99337  degrees of freedom
## Residual deviance: 134983  on 99334  degrees of freedom
##   (1630 observations deleted due to missingness)
## AIC: 134991
## 
## Number of Fisher Scoring iterations: 11</code></pre>
<p>Al comparar los valores AIC de los tres factores que la relevancia va bajando en orden decreciente. En los primeros dos casos, los factores son representativos mientras que en el tercero unicamente “Others” es representativo dentro de la variable. Vamos a contruir una nueva variable compuesta de los tres factores que en caso de tener presente alguno de los factores relacionados se tome en cuenta y en caso contrario se considera NoAp.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>. =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">1</span>., <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Distractions&quot;</span>, <span class="st">&quot;Others&quot;</span>), 
                                  <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>, <span class="st">&quot;Factor1&quot;</span>, <span class="st">&quot;Factor1&quot;</span>, <span class="st">&quot;Factor1&quot;</span>),<span class="dt">warn_missing=</span>F)

df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>. =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">2</span>., <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Distractions&quot;</span>, <span class="st">&quot;Others&quot;</span>), 
                                  <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>, <span class="st">&quot;Factor2&quot;</span>, <span class="st">&quot;Factor2&quot;</span>, <span class="st">&quot;Factor2&quot;</span>),<span class="dt">warn_missing=</span>F)

df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>. =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RELATED_FACTOR_.<span class="dv">3</span>., <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp3&quot;</span>, <span class="st">&quot;Physical Issues&quot;</span>, <span class="st">&quot;Distractions&quot;</span>, <span class="st">&quot;Others&quot;</span>), 
                                  <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp3&quot;</span>, <span class="st">&quot;Factor3&quot;</span>, <span class="st">&quot;Factor3&quot;</span>, <span class="st">&quot;Factor3&quot;</span>),<span class="dt">warn_missing=</span>F)

df<span class="op">$</span>factorC &lt;-<span class="st"> </span><span class="kw">with</span>(df, <span class="kw">interaction</span>(RELATED_FACTOR_.<span class="dv">1</span>.,RELATED_FACTOR_.<span class="dv">2</span>.,RELATED_FACTOR_.<span class="dv">3</span>.))
df<span class="op">$</span>factorC =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>factorC, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp.NoAp2.NoAp3&quot;</span>, <span class="st">&quot;Factor1.NoAp2.NoAp3&quot;</span>, <span class="st">&quot;Factor1.Factor2.NoAp3&quot;</span>, <span class="st">&quot;Factor1.Factor2.Factor3&quot;</span>, <span class="st">&quot;NoAp.Factor2.NoAp3&quot;</span>,<span class="st">&quot;NoAp.NoAp2.Factor3&quot;</span>, <span class="st">&quot;Factor1.NoAp2.Factor3&quot;</span>, <span class="st">&quot;NoAp.Factor2.Factor3&quot;</span>), 
                                  <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>, <span class="st">&quot;RelatedFactor&quot;</span>, <span class="st">&quot;RelatedFactor&quot;</span>, <span class="st">&quot;RelatedFactor&quot;</span>, <span class="st">&quot;RelatedFactor&quot;</span>, <span class="st">&quot;RelatedFactor&quot;</span>, <span class="st">&quot;RelatedFactor&quot;</span>, <span class="st">&quot;RelatedFactor&quot;</span>),<span class="dt">warn_missing=</span>F)
<span class="kw">describe</span>(df<span class="op">$</span>factorC)</code></pre></div>
<pre><code>## df$factorC 
##        n  missing distinct 
##    96856     4112        2 
##                                       
## Value               NoAp RelatedFactor
## Frequency          96541           315
## Proportion         0.997         0.003</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>factorC)</code></pre></div>
<pre><code>##           
##             NoAp RelatedFactor
##   Died     37955           264
##   Survived 57461            50</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>factorC)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  df$INJURY_SEVERITY and df$factorC
## X-squared = 254.21, df = 1, p-value &lt; 2.2e-16</code></pre>
<p>En principiola presencia de factores relacionados con el accidente no es representativa para la variable.</p>
<hr />
</div>
<div id="analisis-race" class="section level3">
<h3><span class="header-section-number">2.3.29</span> Análisis <code>RACE</code></h3>
<p>Esta variable recoge la raza de la persona a partir de su certificado de defunción. Esta variable puede tomar los siguientes valores.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores existentes</span>
<span class="kw">describe</span>(df<span class="op">$</span>RACE)</code></pre></div>
<pre><code>## df$RACE 
##        n  missing distinct 
##    82533    18435       16 
## 
## AmI (436, 0.005), AsianInd (37, 0.000), AsianPac (35, 0.000), B (3392,
## 0.041), Chi (42, 0.001), Fil (103, 0.001), Haw (36, 0.000), Jap (24,
## 0.000), Kor (27, 0.000), MRace (7, 0.000), NoAp (58686, 0.711), OAsian
## (65, 0.001), OInd (16, 0.000), Samoa (5, 0.000), Viet (40, 0.000), W
## (19582, 0.237)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(df<span class="op">$</span>RACE)</code></pre></div>
<pre><code>##      AmI AsianInd AsianPac        B      Chi      Fil      Haw      Jap 
##      436       37       35     3392       42      103       36       24 
##      Kor    MRace     NoAp   OAsian     OInd    Samoa     Viet        W 
##       27        7    58686       65       16        5       40    19582 
##     NA&#39;s 
##    18435</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>RACE =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>RACE, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>,<span class="st">&quot;W&quot;</span>, <span class="st">&quot;B&quot;</span>,<span class="st">&quot;AmI&quot;</span>, <span class="st">&quot;Fil&quot;</span>, <span class="st">&quot;OAsian&quot;</span>,<span class="st">&quot;Chi&quot;</span>,<span class="st">&quot;Viet&quot;</span>,<span class="st">&quot;AsianInd&quot;</span>,<span class="st">&quot;Haw&quot;</span>, <span class="st">&quot;AsianPac&quot;</span>,    <span class="st">&quot;Kor&quot;</span>, <span class="st">&quot;Jap&quot;</span>, <span class="st">&quot;OInd&quot;</span>, <span class="st">&quot;MRace&quot;</span>,   <span class="st">&quot;Samoa&quot;</span>)))

mylogit29 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>RACE , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit29)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ RACE, family = &quot;binomial&quot;, data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.1869   0.0000   0.0177   0.0177   0.0177  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)      8.7648     0.3334  26.292   &lt;2e-16 ***
## RACEW          -33.3309   936.2208  -0.036    0.972    
## RACEB          -33.3309  2249.4629  -0.015    0.988    
## RACEAmI        -33.3309  6274.2745  -0.005    0.996    
## RACEFil        -33.3309 12908.8676  -0.003    0.998    
## RACEOAsian     -33.3309 16249.8771  -0.002    0.998    
## RACEChi        -33.3309 20215.3896  -0.002    0.999    
## RACEViet       -33.3309 20714.6102  -0.002    0.999    
## RACEAsianInd   -33.3309 21538.0261  -0.002    0.999    
## RACEHaw        -33.3309 21835.1163  -0.002    0.999    
## RACEAsianPac   -33.3309 22144.8497  -0.002    0.999    
## RACEKor        -33.3309 25213.0206  -0.001    0.999    
## RACEJap        -33.3309 26742.4467  -0.001    0.999    
## RACEOInd       -33.3309 32752.6744  -0.001    0.999    
## RACEMRace      -33.3309 49517.3894  -0.001    0.999    
## RACESamoa      -33.3309 58589.7652  -0.001    1.000    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 98542.19  on 81497  degrees of freedom
## Residual deviance:   175.77  on 81482  degrees of freedom
##   (19470 observations deleted due to missingness)
## AIC: 207.77
## 
## Number of Fisher Scoring iterations: 23</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>RACE)</code></pre></div>
<pre><code>##           
##             NoAp     W     B   AmI   Fil OAsian   Chi  Viet AsianInd   Haw
##   Died         9 19582  3392   436   103     65    42    40       37    36
##   Survived 57642     0     0     0     0      0     0     0        0     0
##           
##            AsianPac   Kor   Jap  OInd MRace Samoa
##   Died           35    27    24    16     7     5
##   Survived        0     0     0     0     0     0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#unificación de factores</span>
df<span class="op">$</span>RACE =<span class="st"> </span><span class="kw">mapvalues</span>(df<span class="op">$</span>RACE, <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>,<span class="st">&quot;W&quot;</span>, <span class="st">&quot;B&quot;</span>,<span class="st">&quot;AmI&quot;</span>, <span class="st">&quot;Fil&quot;</span>, <span class="st">&quot;OAsian&quot;</span>,<span class="st">&quot;Chi&quot;</span>,<span class="st">&quot;Viet&quot;</span>,<span class="st">&quot;AsianInd&quot;</span>,<span class="st">&quot;Haw&quot;</span>, <span class="st">&quot;AsianPac&quot;</span>, <span class="st">&quot;Kor&quot;</span>, <span class="st">&quot;Jap&quot;</span>, <span class="st">&quot;OInd&quot;</span>, <span class="st">&quot;MRace&quot;</span>,  <span class="st">&quot;Samoa&quot;</span>), 
                                  <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>,<span class="st">&quot;W&quot;</span>, <span class="st">&quot;B&quot;</span>,<span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Other&quot;</span>,  <span class="st">&quot;Other&quot;</span>),<span class="dt">warn_missing=</span>F)

<span class="kw">table</span>(df<span class="op">$</span>INJURY_SEVERITY,df<span class="op">$</span>RACE)</code></pre></div>
<pre><code>##           
##             NoAp     W     B Other
##   Died         9 19582  3392   873
##   Survived 57642     0     0     0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reordenación de variables</span>
df<span class="op">$</span>RACE =<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>RACE, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;NoAp&quot;</span>,<span class="st">&quot;W&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;Other&quot;</span>)))

mylogit292 =<span class="st"> </span><span class="kw">glm</span>(INJURY_SEVERITY<span class="op">~</span>RACE , <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(mylogit292)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = INJURY_SEVERITY ~ RACE, family = &quot;binomial&quot;, data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.1869   0.0000   0.0177   0.0177   0.0177  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    8.7648     0.3334  26.292   &lt;2e-16 ***
## RACEW        -33.3309   936.2208  -0.036    0.972    
## RACEB        -33.3309  2249.4629  -0.015    0.988    
## RACEOther    -33.3309  4434.0403  -0.008    0.994    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 98542.19  on 81497  degrees of freedom
## Residual deviance:   175.77  on 81494  degrees of freedom
##   (19470 observations deleted due to missingness)
## AIC: 183.77
## 
## Number of Fisher Scoring iterations: 23</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estudio de la correlación</span>
<span class="kw">chisq.test</span>(df<span class="op">$</span>INJURY_SEVERITY, df<span class="op">$</span>RACE)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df$INJURY_SEVERITY and df$RACE
## X-squared = 81455, df = 3, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(df[<span class="kw">which</span>(df<span class="op">$</span>RACE <span class="op">==</span><span class="st">&#39;NoAp&#39;</span>),])</code></pre></div>
<pre><code>##           CASE_STATE         AGE            SEX        PERSON_TYPE   
##  California    : 6195   Min.   : 0.00   Male  :36862   Driver:31544  
##  Texas         : 5507   1st Qu.:19.00   Female:20404   Other :27140  
##  Florida       : 4727   Median :29.00   NA&#39;s  : 1420   NA&#39;s  :    2  
##  Georgia       : 2415   Mean   :32.26                                
##  New_York      : 2217   3rd Qu.:44.00                                
##  North_Carolina: 2077   Max.   :97.00                                
##  (Other)       :35548   NA&#39;s   :2185                                 
##  SEATING_POSITION RESTRAINT_SYSTEM.USE AIR_BAG_AVAILABILITY.DEPLOYMENT
##  FL     :31527    No   :16235          NAv    :36309                  
##  FR     :12404    Yes  :32340          D_F    : 8472                  
##  S_T    :10145    Other: 4270          Av_nD  : 6177                  
##  CA     : 1815    NA&#39;s : 5841          A_U    : 4874                  
##  FM     :  728                         NM     :  711                  
##  (Other):  940                         (Other):  199                  
##  NA&#39;s   : 1127                         NA&#39;s   : 1944                  
##               EJECTION     EJECTION_PATH           EXTRICATION   
##  Not_Ejected      :55073   NoAp   :55074   Not_Extricated:55440  
##  Totally_Ejected  : 2861   SideW  :  216   Extricated    : 2775  
##  Partially_Ejected:  272   Other  :  183   NA&#39;s          :  471  
##  NA&#39;s             :  480   SideD  :  108                         
##                            BackW  :   80                         
##                            (Other):  119                         
##                            NA&#39;s   : 2906                         
##  NON_MOTORIST_LOCATION POLICE_REPORTED_ALCOHOL_INVOLVEMENT
##  NoAp:57975            NO  :22191                         
##  NI  :  589            YES : 3760                         
##  I   :  117            NA&#39;s:32735                         
##  NA&#39;s:    5                                               
##                                                           
##                                                           
##                                                           
##  METHOD_ALCOHOL_DETERMINATION ALCOHOL_TEST_TYPE ALCOHOL_TEST_RESULT
##  OBS    : 4612                NoT :44193        Length:58686       
##  ET     : 2770                WB  : 7987        Class :character   
##  PBT    :  711                BB  : 1416        Mode  :character   
##  OTHER  :  416                U   :  116                           
##  BV     :  315                V   :    2                           
##  (Other):   22                BPS :   16                           
##  NA&#39;s   :49840                NA&#39;s: 4956                           
##  POLICE.REPORTED_DRUG_INVOLVEMENT METHOD_OF_DRUG_DETERMINATION
##  NoRep:45657                      NoRep:55722                 
##  No   :10579                      Other: 1561                 
##  Yes  :  557                      ET   :  763                 
##  NA&#39;s : 1893                      B    :  534                 
##                                   DRT  :  106                 
##                                                               
##                                                               
##  DRUG_TEST_TYPE DRUG_TEST_RESULTS_.1_of_3. DRUG_TEST_TYPE_.2_of_3.
##  notest:    0   Length:58686               notest:    0           
##  Btest : 2647   Class :character           Btest :  305           
##  Utest :  663   Mode  :character           Utest :   76           
##  Xtest :  445                              BUtest:   26           
##  BUtest:  226                              Xtest :    9           
##  NA&#39;s  :54705                              NA&#39;s  :58270           
##                                                                   
##  DRUG_TEST_RESULTS_.2_of_3. DRUG_TEST_TYPE_.3_of_3.
##  Min.   :  0.00             notest:    0           
##  1st Qu.:  0.00             Btest :  211           
##  Median :  0.00             Utest :   31           
##  Mean   : 87.21             BUtest:   15           
##  3rd Qu.:  0.00             Xtest :    3           
##  Max.   :999.00             NA&#39;s  :58426           
##                                                    
##  DRUG_TEST_RESULTS_.3_of_3.     HISPANIC_ORIGIN  TAKEN_TO_HOSPITAL
##  Min.   :  0.00             Non-Hispanic:    0   Yes :33882       
##  1st Qu.:  0.00             Hisp        :    0   No  :23694       
##  Median :  0.00             NA&#39;s        :58686   NA&#39;s: 1110       
##  Mean   : 85.88                                                   
##  3rd Qu.:  0.00                                                   
##  Max.   :999.00                                                   
##                                                                   
##  RELATED_FACTOR_.1. RELATED_FACTOR_.2. RELATED_FACTOR_.3.    RACE      
##  NoAp   :58497      NoAp2  :58629      NoAp3  :58656      NoAp :58686  
##  Factor1:   82      Factor2:   10      Factor3:    1      W    :    0  
##  NA&#39;s   :  107      NA&#39;s   :   47      NA&#39;s   :   29      B    :    0  
##                                                           Other:    0  
##                                                                        
##                                                                        
##                                                                        
##  INJURY_SEVERITY        ALCOHOL_TEST_RESULT1 DRUG_TEST_RESULTS
##  Died    :    9   Negative_alcohol: 5585     Negd:47033       
##  Survived:57642   Positive_alcohol: 2453     Posd: 8934       
##  NA&#39;s    : 1035   NA&#39;s            :50648     NA&#39;s: 2719       
##                                                               
##                                                               
##                                                               
##                                                               
##           factorC     
##  NoAp         :58497  
##  RelatedFactor:   52  
##  NA&#39;s         :  137  
##                       
##                       
##                       
## </code></pre>
<p>La raza de los implicados en el accidente no es representativa para la supervivencia o no del sujeto.</p>
<hr />
</div>
<div id="analisis-injury_severity-variable-respuesta" class="section level3">
<h3><span class="header-section-number">2.3.30</span> Análisis <code>INJURY_SEVERITY</code>: variable respuesta</h3>
<p>Siguiendo la informacion contenida en la documentacion asociada al dataset que estamos estudiando, la variable <em>injury_Severity</em> indica la severidad del daño sufrido por cada persona involucrada en el accidente (ocupante, peatón y ciclista) según el policía que redacto el informe. Los valores de esta variable se basan en la escala KABCO:</p>
<table>
<colgroup>
<col width="13%" />
<col width="86%" />
</colgroup>
<thead>
<tr class="header">
<th>Código</th>
<th>Significado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“K”</td>
<td>Fatal injuries include deaths which occur within thirty days following injury in a motor vehicle crash.</td>
</tr>
<tr class="even">
<td>“A”</td>
<td>Severe injuries include skull fractures, internal injuries, broken or distorted limbs, unconsciousness, severe lacerations, severe burns, and unable to leave the scene without assistance.</td>
</tr>
<tr class="odd">
<td>“B”</td>
<td>Moderate injuries include visible injuries such as a “lump” on the head, abrasions, and minor lacerations.</td>
</tr>
<tr class="even">
<td>“C”</td>
<td>Minor injuries include hysteria, nausea, momentary unconsciousness, and complaint of pain without visible signs of injury.</td>
</tr>
<tr class="odd">
<td>“O”</td>
<td>No fatality or injury; property damage only</td>
</tr>
<tr class="even">
<td>“Unk Severity”</td>
<td>Severity of injury unknown</td>
</tr>
</tbody>
</table>
<p>No obstante, desde el principio se ha tomado la decisión de convertir esta variable en una binomial.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(df<span class="op">$</span>INJURY_SEVERITY)</code></pre></div>
<pre><code>## df$INJURY_SEVERITY 
##        n  missing distinct 
##    99768     1200        2 
##                             
## Value          Died Survived
## Frequency     42125    57643
## Proportion    0.422    0.578</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(INJURY_SEVERITY) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="FARS18052_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduccion.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="estudio-de-valores-faltantes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

</body>

</html>
